---
layout: post
title:  "[ì˜í•™í†µê³„ë°©ë²•ë¡ ] Ch11. Multiple Comparisons"
category: Study
tag: [R, SAS, blog, jekyll, Jupyter, Data, Python]
toc: true
---
* this unordered seed list will be replaced by the toc
{:toc}

- ë’¤ë¡œê°€ê¸°ë¥¼ ëˆ„ë¥´ì‹œë©´ ëª©ì°¨ë¡œ ë˜ëŒì•„ì˜µë‹ˆë‹¤. ğŸ˜‰

# Multiple Comparisons

> [ì˜ˆì œ ë°ì´í„°íŒŒì¼ ë‹¤ìš´ë¡œë“œ](https://github.com/James1verse27/James1verse27.github.io/blob/main/study/data/ch11/data_chap11.xls?raw=true)

# R í”„ë¡œê·¸ë¨ ê²°ê³¼

<details>
<summary>
R ì ‘ê¸°/í¼ì¹˜ê¸° ë²„íŠ¼
</summary>
<div markdown="1">

**íŒ¨í‚¤ì§€**
<details>
<summary>
ì„¤ì¹˜ëœ íŒ¨í‚¤ì§€ ì ‘ê¸°/í¼ì¹˜ê¸° ë²„íŠ¼
</summary>

<div markdown="1">

``` r
getwd()
```

    ## [1] "C:/Biostat"

``` r
library(readxl)
library(dplyr)
library(kableExtra)
library(MBESS)
library(DescTools)
library(PMCMRplus)
```

</div>
</details>

**ì—‘ì…€íŒŒì¼ë¶ˆëŸ¬ì˜¤ê¸°**

``` r
#ëª¨ë“  ì‹œíŠ¸ë¥¼ í•˜ë‚˜ì˜ ë¦¬ìŠ¤íŠ¸ë¡œ ë¶ˆëŸ¬ì˜¤ëŠ” í•¨ìˆ˜
read_excel_allsheets <- function(file, tibble = FALSE) {
  sheets <- readxl::excel_sheets(file)
  x <- lapply(sheets, function(X) readxl::read_excel(file, sheet = X))
  if(!tibble) x <- lapply(x, as.data.frame)
  names(x) <- sheets
  x
}
```

## 11ì¥

**11ì¥ ì—°ìŠµë¬¸ì œ ë¶ˆëŸ¬ì˜¤ê¸°**

``` r
#data_chap11ì— ì—°ìŠµë¬¸ì œ 7ì¥ ëª¨ë“  ë¬¸ì œ ì €ì¥
data_chap11 <- read_excel_allsheets("data_chap11.xls")

#ì—°ìŠµë¬¸ì œ ê°ê° ë°ì´í„° ìƒì„±
for (x in 1:length(data_chap11)){
  assign(paste0('ex11_',c(1,10))[x],data_chap11[x])
  }

#ì—°ìŠµë¬¸ì œ ë°ì´í„° í˜•ì‹ì„ ë¦¬ìŠ¤íŠ¸ì—ì„œ ë°ì´í„°í”„ë ˆì„ìœ¼ë¡œ ë³€í™˜
for (x in 1:length(data_chap11)){
  assign(paste0('ex11_',c(1,10))[x],data.frame(data_chap11[x]))
  }
```

## EXAMPLE 11.1

![](/study/img/ch11/11-1_1.png)

![](/study/img/ch11/11-1_2.png)

``` r
#ë°ì´í„°ì…‹
ex11_1%>%
  kbl(caption = "Dataset",escape=F) %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
Dataset
</caption>
<thead>
<tr>
<th style="text-align:right;">
exam11_1.pond
</th>
<th style="text-align:right;">
exam11_1.strontium
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
28.2
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
33.2
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
36.4
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
34.6
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
29.1
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
31.0
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
39.6
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
40.8
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
37.9
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
37.1
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
43.6
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
42.4
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
46.3
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
42.1
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
43.5
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
48.8
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
43.7
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
40.1
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
41.0
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
44.1
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
46.4
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
40.2
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
38.6
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
36.3
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
56.3
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
54.1
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
59.4
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
62.7
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
60.0
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
57.3
</td>
</tr>
</tbody>
</table>

- í•´ë‹¹ ë°ì´í„°ëŠ” 5ê°€ì§€ ë‹¤ë¥¸ ìˆ˜ì—­ì˜ strontium ë†ë„(mg/ml) ë°ì´í„°ì´ë‹¤.<br/>
- ë¶„ì‚°ë¶„ì„ì„ ì‹¤ì‹œ í›„ ê·¸ë£¹ê°„ ì°¨ì´ê°€ ìˆë‹¤ëŠ” ê²°ë¡ ì´ ë‚¬ì„ ë•Œ, ì–´ëŠ ê·¸ë£¹ê°„ í‰ê· ì´ ì°¨ì´ê°€ ìˆëŠ”ì§€ ì‚¬í›„ê²€ì •ì„ í†µí•´ ì‚´í´ë³¼ ê²ƒì´ë‹¤.<br/>
- ì´ ë¬¸ì œì—ì„œëŠ” íŠœí‚¤ ê²€ì •ì„ í†µí•´ ì‚¬í›„ê²€ì •ì„ ì‹œí–‰í•´ ë³´ì•˜ë‹¤.

$$
\begin{aligned}
H_0 &: \mu_1=\mu_2=\mu_3=\mu_4=\mu_5 \\
H_1 &: Mean \ strontium \ concentrations \ are \ not \ the \ same \ in \ all \ five \ bodies \ of \ water
\end{aligned}
$$

- ìš°ì„  ë¶„ì‚°ë¶„ì„ì˜ ê°€ì •ì¸ independence, homoscedasticity, normality ì‚´í´ë³´ì.<br/>

> Independence test with residuals

``` r
plot(glm(exam11_1.strontium~factor(exam11_1.pond),data=ex11_1)$residual)
```

![](/study/img/ch11/unnamed-chunk-4-1.png)

- ì”ì°¨ì— ëŒ€í•œ scatter plotì„ ë´¤ì„ ë•Œ ê³¨ê³ ë£¨ ë¶„í¬ ë˜ì–´ ìˆìœ¼ë¯€ë¡œ ë…ë¦½ì„±ì„ ë§Œì¡±í•œë‹¤ í•  ìˆ˜ ìˆë‹¤.

> Normality test with shapiro test

``` r
library(rstatix)
exam11_1.normal<-ex11_1 %>%
  group_by(exam11_1.pond) %>%
  shapiro_test(exam11_1.strontium)

exam11_1.normal %>%
  kbl(caption = "Example11_1 : ì •ê·œì„± ê°€ì •") %>%
  kable_styling()
```

<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
Example11_1 : ì •ê·œì„± ê°€ì •
</caption>
<thead>
<tr>
<th style="text-align:right;">
exam11_1.pond
</th>
<th style="text-align:left;">
variable
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
exam11_1.strontium
</td>
<td style="text-align:right;">
0.9567420
</td>
<td style="text-align:right;">
0.7943129
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
exam11_1.strontium
</td>
<td style="text-align:right;">
0.9616302
</td>
<td style="text-align:right;">
0.8322126
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
exam11_1.strontium
</td>
<td style="text-align:right;">
0.9718105
</td>
<td style="text-align:right;">
0.9043687
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
exam11_1.strontium
</td>
<td style="text-align:right;">
0.9783967
</td>
<td style="text-align:right;">
0.9433162
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
exam11_1.strontium
</td>
<td style="text-align:right;">
0.9893713
</td>
<td style="text-align:right;">
0.9875855
</td>
</tr>
</tbody>
</table>

- ê° ìˆ˜ì—­ì—ì„œ strontium ë†ë„ê°€ 6ë²ˆì”© ì¸¡ì •ì´ ë˜ì–´ ì „ì²´ í‘œë³¸ì˜ ìˆ˜ëŠ” 30ì´ë‹¤.<br/>
- í‘œë³¸ì˜ í¬ê¸°ê°€ í¬ì§€ ì•Šìœ¼ë¯€ë¡œ ì •ê·œì„± ê²€ì •ìœ¼ë¡œ Shapiro-Wilk testë¥¼ ì‹œí–‰í•˜ì˜€ìœ¼ë©°,<br/> p-valueëŠ” ê° ìˆ˜ì—­ë³„ë¡œ 0.7943, 0.8322, 0.9044, 0.9433, 0.9876ìœ¼ë¡œ ëª¨ë‘ ìœ ì˜ìˆ˜ì¤€ 5%í•˜ì— ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•  ìˆ˜ ì—†ë‹¤.<br/>
- ë”°ë¼ì„œ ì •ê·œì„± ê°€ì •ì„ ë§Œì¡±í•œë‹¤ëŠ” ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•  ìˆ˜ ì—†ìœ¼ë¯€ë¡œ ì •ê·œì„± ê°€ì •ì„ ë§Œì¡±í•œë‹¤ê³  ë³¼ ê²ƒì´ë‹¤.

> Homoscedasticity test with bartlett test

``` r
bartlett.test(ex11_1$exam11_1.strontium,ex11_1$exam11_1.pond)
```

    ## 
    ##  Bartlett test of homogeneity of variances
    ## 
    ## data:  ex11_1$exam11_1.strontium and ex11_1$exam11_1.pond
    ## Bartlett's K-squared = 0.63895, df = 4, p-value = 0.9586

- ì •ê·œì„± ê°€ì •ì´ ëª¨ë‘ ë§Œì¡±ë˜ì—ˆìœ¼ë¯€ë¡œ ë“±ë¶„ì‚° ê²€ì •ìœ¼ë¡œ Bartlettâ€™s Testë¥¼ ì‹œí–‰í•˜ì˜€ë‹¤.<br/>
- p-valueëŠ” 0.9586ìœ¼ë¡œ ìœ ì˜ìˆ˜ì¤€ 5%í•˜ì— ëª¨ë¶„ì‚°ì´ ì„œë¡œ ë™ì¼í•˜ë‹¤ëŠ” ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•˜ì§€ ëª»í•œë‹¤.<br/>
- ì¦‰, ìœ ì˜ìˆ˜ì¤€ 5%í•˜ì— ë“±ë¶„ì‚° ê°€ì •ì„ ë§Œì¡±í•œë‹¤ê³  ë³¼ ê²ƒì´ë‹¤.<br/><br/>
- ë¶„ì‚°ë¶„ì„ ê°€ì •ì„ ëª¨ë‘ ë§Œì¡±í•˜ì˜€ìœ¼ë¯€ë¡œ ì¼ì›ë¶„ì‚°ë¶„ì„ì„ ì‹œí–‰í•˜ì—¬ ë³´ê² ë‹¤.

``` r
ex11_1.anova<-aov(ex11_1$exam11_1.strontium ~ as.factor(ex11_1$exam11_1.pond))
summary(ex11_1.anova)
```

    ##                                 Df Sum Sq Mean Sq F value   Pr(>F)    
    ## as.factor(ex11_1$exam11_1.pond)  4 2193.4   548.4   56.16 3.95e-12 ***
    ## Residuals                       25  244.1     9.8                     
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

- ì¼ì›ë¶„ì‚°ë¶„ì„ ê²°ê³¼ p-valueëŠ” <.0001ìœ¼ë¡œ ìœ ì˜ìˆ˜ì¤€ 5%í•˜ì— ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•œë‹¤. <br/>
- ìœ ì˜ìˆ˜ì¤€ 5%í•˜ì— ì ì–´ë„ í•˜ë‚˜ì˜ ìˆ˜ì—­ì—ì„œ strontium ë†ë„ì˜ ëª¨í‰ê· ì´ ë‹¤ë¥´ë‹¤ê³  ë³¼ ìˆ˜ ìˆëŠ” ì¶©ë¶„í•œ ì¦ê±°ê°€ ìˆë‹¤.

> tukey ë‹¤ì¤‘ë¹„êµ

``` r
ex11_1.tukey <- TukeyHSD(ex11_1.anova,ordered=T)
ex11_1.tukey$`as.factor(ex11_1$exam11_1.pond)` %>%
  kbl(caption = "Example11_1 : Tukey ë‹¤ì¤‘ë¹„êµ") %>%
  kable_styling()
```

<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
Example11_1 : Tukey ë‹¤ì¤‘ë¹„êµ
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
diff
</th>
<th style="text-align:right;">
lwr
</th>
<th style="text-align:right;">
upr
</th>
<th style="text-align:right;">
p adj
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
2-1
</td>
<td style="text-align:right;">
8.1500000
</td>
<td style="text-align:right;">
2.851355
</td>
<td style="text-align:right;">
13.448645
</td>
<td style="text-align:right;">
0.0011293
</td>
</tr>
<tr>
<td style="text-align:left;">
4-1
</td>
<td style="text-align:right;">
9.0166667
</td>
<td style="text-align:right;">
3.718021
</td>
<td style="text-align:right;">
14.315312
</td>
<td style="text-align:right;">
0.0003339
</td>
</tr>
<tr>
<td style="text-align:left;">
3-1
</td>
<td style="text-align:right;">
12.0000000
</td>
<td style="text-align:right;">
6.701355
</td>
<td style="text-align:right;">
17.298645
</td>
<td style="text-align:right;">
0.0000053
</td>
</tr>
<tr>
<td style="text-align:left;">
5-1
</td>
<td style="text-align:right;">
26.2166667
</td>
<td style="text-align:right;">
20.918021
</td>
<td style="text-align:right;">
31.515312
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
4-2
</td>
<td style="text-align:right;">
0.8666667
</td>
<td style="text-align:right;">
-4.431979
</td>
<td style="text-align:right;">
6.165312
</td>
<td style="text-align:right;">
0.9884803
</td>
</tr>
<tr>
<td style="text-align:left;">
3-2
</td>
<td style="text-align:right;">
3.8500000
</td>
<td style="text-align:right;">
-1.448645
</td>
<td style="text-align:right;">
9.148645
</td>
<td style="text-align:right;">
0.2376217
</td>
</tr>
<tr>
<td style="text-align:left;">
5-2
</td>
<td style="text-align:right;">
18.0666667
</td>
<td style="text-align:right;">
12.768021
</td>
<td style="text-align:right;">
23.365312
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
3-4
</td>
<td style="text-align:right;">
2.9833333
</td>
<td style="text-align:right;">
-2.315312
</td>
<td style="text-align:right;">
8.281979
</td>
<td style="text-align:right;">
0.4791100
</td>
</tr>
<tr>
<td style="text-align:left;">
5-4
</td>
<td style="text-align:right;">
17.2000000
</td>
<td style="text-align:right;">
11.901355
</td>
<td style="text-align:right;">
22.498645
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
5-3
</td>
<td style="text-align:right;">
14.2166667
</td>
<td style="text-align:right;">
8.918021
</td>
<td style="text-align:right;">
19.515312
</td>
<td style="text-align:right;">
0.0000003
</td>
</tr>
</tbody>
</table>

``` r
plot(ex11_1.tukey, col="forestgreen")
```

![](/study/img/ch11/unnamed-chunk-9-1.png)

- Appletree Lake-Beaver Lake(4-2), Angler's Cove-Beaver Lake(3-2), Angler's Cove-Appletree Lake(3-4) ê°„ì— ëª¨í‰ê· ì˜ ìœ ì˜í•œ ì°¨ì´ê°€ ì—†ì—ˆìœ¼ë©° ë‚˜ë¨¸ì§€ ìˆ˜ì—­ê°„ì— ë¹„êµì‹œ ìœ ì˜ìˆ˜ì¤€ 5% í•˜ì— ëª¨í‰ê· ì˜ ìœ ì˜í•œ ì°¨ì´ê°€ ìˆë‹¤ê³  í•  ìˆ˜ ìˆë‹¤.

## EXAMPLE 11.2

![](/study/img/ch11/11-2.png)

``` r
ex11_2 <- read_excel(path = 'C:/git_blog/study/data/ch10/data_chap10.xls',sheet = 'exam10_1')
ex11_2[15,3]=NA
ex11_2<-na.omit(ex11_2)
```

- ë…ë¦½ì„±, ì •ê·œì„±, ë“±ë¶„ì‚°ì„± ê°€ì •ì„ ë§Œì¡±í•¨ì„ Example 10.1ì—ì„œ ì´ë¯¸ í™•ì¸í•˜ì˜€ìœ¼ë¯€ë¡œ ìƒëµí•˜ê² ë‹¤.

``` r
ex11_2.anova <- aov(ex11_2$weight ~ as.factor(ex11_2$diet))
ex11_2.tukey <- TukeyHSD(ex11_2.anova,ordered=T)
ex11_2.tukey$`as.factor(ex11_2$diet)` %>%
  kbl(caption = "Example11_2 : Tukey ë‹¤ì¤‘ë¹„êµ") %>%
  kable_styling()
```

<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
Example11_2 : Tukey ë‹¤ì¤‘ë¹„êµ
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
diff
</th>
<th style="text-align:right;">
lwr
</th>
<th style="text-align:right;">
upr
</th>
<th style="text-align:right;">
p adj
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1-4
</td>
<td style="text-align:right;">
1.38
</td>
<td style="text-align:right;">
-4.203737
</td>
<td style="text-align:right;">
6.963737
</td>
<td style="text-align:right;">
0.8906642
</td>
</tr>
<tr>
<td style="text-align:left;">
2-4
</td>
<td style="text-align:right;">
8.06
</td>
<td style="text-align:right;">
2.476263
</td>
<td style="text-align:right;">
13.643737
</td>
<td style="text-align:right;">
0.0041505
</td>
</tr>
<tr>
<td style="text-align:left;">
3-4
</td>
<td style="text-align:right;">
10.11
</td>
<td style="text-align:right;">
4.187553
</td>
<td style="text-align:right;">
16.032447
</td>
<td style="text-align:right;">
0.0009497
</td>
</tr>
<tr>
<td style="text-align:left;">
2-1
</td>
<td style="text-align:right;">
6.68
</td>
<td style="text-align:right;">
1.096263
</td>
<td style="text-align:right;">
12.263737
</td>
<td style="text-align:right;">
0.0168421
</td>
</tr>
<tr>
<td style="text-align:left;">
3-1
</td>
<td style="text-align:right;">
8.73
</td>
<td style="text-align:right;">
2.807553
</td>
<td style="text-align:right;">
14.652447
</td>
<td style="text-align:right;">
0.0034914
</td>
</tr>
<tr>
<td style="text-align:left;">
3-2
</td>
<td style="text-align:right;">
2.05
</td>
<td style="text-align:right;">
-3.872447
</td>
<td style="text-align:right;">
7.972447
</td>
<td style="text-align:right;">
0.7530266
</td>
</tr>
</tbody>
</table>

``` r
plot(ex11_2.tukey, col = "forestgreen")
```

![](/study/img/ch11/unnamed-chunk-12-1.png)

- Feed1-Feed4(1-4), Feed3-Feed2(3-2) ê°„ì— ëª¨í‰ê· ì˜ ìœ ì˜í•œ ì°¨ì´ê°€ ì—†ì—ˆìœ¼ë©° ë‚˜ë¨¸ì§€ ì‚¬ë£Œê°„ì˜ ë¹„êµì‹œ ìœ ì˜ìˆ˜ì¤€ 5% í•˜ì— ëª¨í‰ê· ì˜ ìœ ì˜í•œ ì°¨ì´ê°€ ìˆë‹¤ê³  í•  ìˆ˜ ìˆë‹¤.

## EXAMPLE 11.3

![](/study/img/ch11/11-3.png)

- ì´ ì˜ˆì œëŠ” Example 11.1 ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨í‰ê· ì— ëŒ€í•œ ì‹ ë¢°êµ¬ê°„ì„ êµ¬í•´ë³¸ë‹¤.

``` r
library(MBESS)
exam11_1.mean<-aggregate(ex11_1$exam11_1.strontium, by=list(ex11_1$exam11_1.pond), mean)
exam11_1.n <- aggregate(ex11_1$exam11_1.strontium, by=list(ex11_1$exam11_1.pond), length)

ci <- ci.c(means=exam11_1.mean$x, s.anova=sqrt(9.7652),c.weights=c(-3/3,1/3,1/3,1/3,0), n=exam11_1.n$x, N=sum(exam11_1.n$x), conf.level= .95)
data.frame(ci)%>%
  kbl(caption = "CI for the Population Means from ex11_1",escape=F) %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
CI for the Population Means from ex11_1
</caption>
<thead>
<tr>
<th style="text-align:right;">
Lower.Conf.Limit.Contrast
</th>
<th style="text-align:right;">
Contrast
</th>
<th style="text-align:right;">
Upper.Conf.Limit.Contrast
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
6.688301
</td>
<td style="text-align:right;">
9.722222
</td>
<td style="text-align:right;">
12.75614
</td>
</tr>
</tbody>
</table>

- ê·¸ë£¹2,4,3ê³¼ ê·¸ë£¹1ì˜ ëª¨í‰ê·  ì°¨ì´ì˜ 95% ì‹ ë¢°êµ¬ê°„ì€ (6.69, 12.76)ìœ¼ë¡œ ê³„ì‚°ë˜ì—ˆë‹¤.

``` r
ci <- ci.c(means=exam11_1.mean$x, s.anova=sqrt(9.7652),c.weights=c(0,-1/3,-1/3,-1/3,1), n=exam11_1.n$x, N=sum(exam11_1.n$x), conf.level= .95)
data.frame(ci)%>%
  kbl(caption = "CI for the Population Means from ex11_1",escape=F) %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
CI for the Population Means from ex11_1
</caption>
<thead>
<tr>
<th style="text-align:right;">
Lower.Conf.Limit.Contrast
</th>
<th style="text-align:right;">
Contrast
</th>
<th style="text-align:right;">
Upper.Conf.Limit.Contrast
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
13.46052
</td>
<td style="text-align:right;">
16.49444
</td>
<td style="text-align:right;">
19.52837
</td>
</tr>
</tbody>
</table>

- ê·¸ë£¹ 5ì˜ ëª¨í‰ê· ê³¼ ê·¸ë£¹ 2,4,3ì˜ ëª¨í‰ê· ì˜ ì°¨ì˜ 95% ì‹ ë¢°êµ¬ê°„ì€ (13.46, 19.53)ìœ¼ë¡œ ê³„ì‚°ë˜ì—ˆë‹¤.

## EXAMPLE 11.4

![](/study/img/ch11/11-4.png)

- í•´ë‹¹ ë°ì´í„°ëŠ” 5ê°€ì§€ ë¹„ë£Œì— ë”°ë¥¸ ê°ì ìˆ˜í™•ëŸ‰ì„ meanê³¼ sizeë¡œ ê¸°ë¡í•œ ë°ì´í„°ì´ë‹¤.

``` r
mean=c(17.3,21.7,22.1,23.6,27.8)
size= c(14,24,14,14,14)
group=c(1,2,3,4,5)
ex11_4= data.frame(group,mean,size)
ex11_4%>%
  kbl(caption = "Dataset") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
Dataset
</caption>
<thead>
<tr>
<th style="text-align:right;">
group
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
size
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
17.3
</td>
<td style="text-align:right;">
14
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
21.7
</td>
<td style="text-align:right;">
24
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
22.1
</td>
<td style="text-align:right;">
14
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
23.6
</td>
<td style="text-align:right;">
14
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
27.8
</td>
<td style="text-align:right;">
14
</td>
</tr>
</tbody>
</table>

$$
\begin{aligned}
H_0 &: \mu_2 \ge \mu_A \\\\
H_1 &: \mu_2 \< \mu_A
\end{aligned}
$$

- ê¸°ì¡´ 2ë²ˆ ë¹„ë£Œì™€ ë‚˜ë¨¸ì§€ ìƒˆë¡œìš´ ë¹„ë£Œ(1,3,4)ë¥¼ ì´ìš©í–ˆì„ ë•Œ ê°ì ìˆ˜í™•ëŸ‰ì˜ ëª¨í‰ê· ì˜ ì°¨ì´ê°€ ìˆëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•´ Dunnett ê²€ì •ì„ ì‚¬ìš©í•  ê²ƒì´ë‹¤.

> Dunnettâ€™s test

``` r
k=5
group_index = c(1, 2, 3, 4, 5)
group_n = c(14, 24, 14, 14, 14)
group_mean=c(17.3, 21.7, 22.1, 23.6, 27.8)
N = sum(group_n);
s2 = 10.42;
errorDF=N-k;
se_value = round(sqrt(s2*(1/group_n[1]+1/group_n[2])), 1);
SE = rep(se_value, k)
Difference = rep(group_mean[2], k) - group_mean;
q_prime = abs(round(Difference/se_value, 2));
control = rep(2,k);

exam11_4<-cbind("control"=control, "group_index"=group_index, "Difference"=Difference, "SE"=SE, "q_prime"=q_prime)
exam11_4 %>%
  kbl(caption = "Example11_4 : dunnett") %>%
  kable_styling()
```

<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
Example11_4 : dunnett
</caption>
<thead>
<tr>
<th style="text-align:right;">
control
</th>
<th style="text-align:right;">
group_index
</th>
<th style="text-align:right;">
Difference
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
q_prime
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4.4
</td>
<td style="text-align:right;">
1.1
</td>
<td style="text-align:right;">
4.00
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
1.1
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
-0.4
</td>
<td style="text-align:right;">
1.1
</td>
<td style="text-align:right;">
0.36
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
-1.9
</td>
<td style="text-align:right;">
1.1
</td>
<td style="text-align:right;">
1.73
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
-6.1
</td>
<td style="text-align:right;">
1.1
</td>
<td style="text-align:right;">
5.55
</td>
</tr>
</tbody>
</table>

- ë¹„ë£Œ 2ê³¼ 1ë¥¼ ë¹„êµí•œ ê²°ê³¼, í‘œë³¸ í‰ê· ì˜ ì°¨ì´ê°€ ì–‘ìˆ˜ì´ë¯€ë¡œ ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•  ìˆ˜ ì—†ë‹¤. <br/>
- ì´ì™€ ë‹¬ë¦¬ ë¹„ë£Œ 2ì™€ ë¹„ë£Œ 4,5 ê°ê° ë¹„êµí•œ ê²°ê³¼ í‘œë³¸ í‰ê· ì˜ ì°¨ì´ê°€ ìŒìˆ˜ì´ë¯€ë¡œ ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•œë‹¤.<br/>
- ì¦‰, ê¸°ì¡´ 2ë²ˆ ë¹„ë£Œ ë³´ë‹¤ ìƒˆë¡œìš´ 4ë²ˆ 5ë²ˆ ë¹„ë£Œë¥¼ ì‚¬ìš©í•  ë•Œ, ê°ì ìˆ˜í™•ëŸ‰ì˜ ëª¨í‰ê· ì´ ë” í¬ë‹¤ê³  í•  ìˆ˜ ìˆë‹¤.

$\bar{X}_{2}>\bar{X}_{1}$ ì´ë¯€ë¡œ ê·€ë¬´ê°€ì„¤ $H_{0} :  \mu_{2} \geq \mu_{A}$ì„ ê¸°ê°í•  ìˆ˜ ì—†ë‹¤. <br/>
- ê·¸ë£¹2ì™€ ê·¸ë£¹5ë¥¼ ë¹„êµí•˜ë©´ $|q'|=5.55$ê°€ ê¸°ê°ì—­ë³´ë‹¤ í¬ë¯€ë¡œ ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•œë‹¤. <br/>
- ì¦‰, ìœ ì˜ìˆ˜ì¤€ 5%í•˜ì—ì„œ ê·¸ë£¹2ì˜ ëª¨í‰ê· ì´ ê·¸ë£¹5ì˜ ëª¨í‰ê· ë³´ë‹¤ ì‘ë‹¤ê³  ë§í•  ìˆ˜ ìˆë‹¤. <br/><br/>
- ê·¸ë£¹2ì™€ ê·¸ë£¹4ë¥¼ ë¹„êµí•˜ë©´ $|q'|=1.73$ì´ ê¸°ê°ì—­ë³´ë‹¤ í¬ë¯€ë¡œ ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•œë‹¤. <br/>
- ì¦‰, ìœ ì˜ìˆ˜ì¤€ 5%í•˜ì—ì„œ ê·¸ë£¹2ì˜ ëª¨í‰ê· ì´ ê·¸ë£¹5ì˜ ëª¨í‰ê· ë³´ë‹¤ ì‘ë‹¤ê³  ë§í•  ìˆ˜ ìˆë‹¤.

## EXAMPLE 11.5

![](/study/img/ch11/11-5.png)

- Dunneetâ€™s test ëŠ” ì§‘ë‹¨ê³¼ í•˜ë‚˜ì˜ control ì§‘ë‹¨ì„ ì´ìš©í–ˆë‹¤ë©´ Scheffeeâ€™s test ì—ì„œëŠ” ìœ„ ë¬¸ì œì˜ 2ë²ˆ ê·¸ë£¹ì˜ ëŒ€ì¡°êµ°ê³¼ ë‚˜ë¨¸ì§€ë¥¼ ë¹„êµí•˜ì˜€ë‹¤.

``` r
contrast= matrix(c(0, 1/3, 1/3, 1/3, -1, 
                   1, -1/3, -1/3, -1/3, 0, 
                   1/2, -1/3, -1/3, -1/3, 1/2, 
                   1/2, -1/2, -1/2, 1/2, 0), ncol=4)
library(DescTools)
ex11.6<-ScheffeTest(ex11_1.anova, contrasts=contrast)
ex11.6$`as.factor(ex11_1$exam11_1.pond)` %>%
  kbl(caption = "Example 11.5 & 11.6: SCHEFFE") %>%
  kable_styling()
```

<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
Example 11.5 & 11.6: SCHEFFE
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
diff
</th>
<th style="text-align:right;">
lwr.ci
</th>
<th style="text-align:right;">
upr.ci
</th>
<th style="text-align:right;">
pval
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
2,3,4-5
</td>
<td style="text-align:right;">
-16.494444
</td>
<td style="text-align:right;">
-21.3879194
</td>
<td style="text-align:right;">
-11.600969
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
1-2,3,4
</td>
<td style="text-align:right;">
-9.722222
</td>
<td style="text-align:right;">
-14.6156972
</td>
<td style="text-align:right;">
-4.828747
</td>
<td style="text-align:right;">
0.0000299
</td>
</tr>
<tr>
<td style="text-align:left;">
1,5-2,3,4
</td>
<td style="text-align:right;">
3.386111
</td>
<td style="text-align:right;">
-0.4825205
</td>
<td style="text-align:right;">
7.254743
</td>
<td style="text-align:right;">
0.1090539
</td>
</tr>
<tr>
<td style="text-align:left;">
1,4-2,3
</td>
<td style="text-align:right;">
-5.566667
</td>
<td style="text-align:right;">
-9.8045403
</td>
<td style="text-align:right;">
-1.328793
</td>
<td style="text-align:right;">
0.0054032
</td>
</tr>
</tbody>
</table>

- ê²€ì • ê²°ê³¼ ê·¸ë£¹ 1,5ì™€ ê·¸ë£¹ 2,3,4 ì™¸ì— ë‹¤ë¥¸ ê²½ìš°ëŠ” ìœ ì˜ìˆ˜ì¤€ 5%í•˜ì— ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•  ì¶©ë¶„í•œ ê·¼ê±°ë¥¼ ê°€ì§€ê³  ìˆë‹¤. 

## EXAMPLE 11.6

![](/study/img/ch11/11-6.png)

EXAMPLE 11.5 ë¬¸ì œì˜ ì‹ ë¢°êµ¬ê°„ì„ êµ¬í•´ë³¸ë‹¤.

``` r
ex11.6$`as.factor(ex11_1$exam11_1.pond)` %>%
  kbl(caption = "Example 11.5 & 11.6: SCHEFFE") %>%
  kable_styling()
```

- ê·¸ë£¹ (2,3,4)ì™€ ê·¸ë£¹ 5ì— ëŒ€í•œ 95% ì‹ ë¢°êµ¬ê°„ì€ (-21.39, -11.60), ê·¸ë£¹ 1ê³¼ ê·¸ë£¹ (2,3,4)ì— ëŒ€í•œ 95% ì‹ ë¢°êµ¬ê°„ì€ (-14.62,-4.83)ì´ë‹¤.

<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
Example 11.5 & 11.6: SCHEFFE
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
diff
</th>
<th style="text-align:right;">
lwr.ci
</th>
<th style="text-align:right;">
upr.ci
</th>
<th style="text-align:right;">
pval
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
2,3,4-5
</td>
<td style="text-align:right;">
-16.494444
</td>
<td style="text-align:right;">
-21.3879194
</td>
<td style="text-align:right;">
-11.600969
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
1-2,3,4
</td>
<td style="text-align:right;">
-9.722222
</td>
<td style="text-align:right;">
-14.6156972
</td>
<td style="text-align:right;">
-4.828747
</td>
<td style="text-align:right;">
0.0000299
</td>
</tr>
<tr>
<td style="text-align:left;">
1,5-2,3,4
</td>
<td style="text-align:right;">
3.386111
</td>
<td style="text-align:right;">
-0.4825205
</td>
<td style="text-align:right;">
7.254743
</td>
<td style="text-align:right;">
0.1090539
</td>
</tr>
<tr>
<td style="text-align:left;">
1,4-2,3
</td>
<td style="text-align:right;">
-5.566667
</td>
<td style="text-align:right;">
-9.8045403
</td>
<td style="text-align:right;">
-1.328793
</td>
<td style="text-align:right;">
0.0054032
</td>
</tr>
</tbody>
</table>

- ê·¸ë£¹ (2,3,4)ì™€ ê·¸ë£¹ 5ì— ëŒ€í•œ 95% ì‹ ë¢°êµ¬ê°„ì€ (-21.39, -11.60), <br/> ê·¸ë£¹ 1ê³¼ ê·¸ë£¹ (2,3,4)ì— ëŒ€í•œ 95% ì‹ ë¢°êµ¬ê°„ì€ (-14.62,-4.83)ì´ë‹¤.

## EXAMPLE 11.7

![](/study/img/ch11/11-7.png)

- ì´ ì˜ˆì œëŠ” EXAMPLE 10.10ë¥¼ Nemenyi testë¥¼ ì´ìš©í•˜ì—¬ ë¹„ëª¨ìˆ˜ì  ë‹¤ì¤‘ë¹„êµë¥¼ í•˜ëŠ” ë¬¸ì œì´ë‹¤.

> Nemenyi test

``` r
ex11_7 <- read_excel(path = 'C:/git_blog/study/data/ch10/data_chap10.xls',sheet = 'exam10_10')
library(PMCMRplus)
kwAllPairsNemenyiTest(abundance~factor(layer), data=ex11_7, dist='Tukey')
```

    ##   1     2    
    ## 2 0.043 -    
    ## 3 0.020 0.957

- PMCMRplus íŒ¨í‚¤ì§€ì˜ kwAllPairsNemenyiTest() í•¨ìˆ˜ëŠ” Nemenyi testë¥¼ ì´ìš©í•˜ì—¬ ë¹„ëª¨ìˆ˜ì ì¸ ë‹¤ì¤‘ë¹„êµ í›„ p-valueë¥¼ ë‚˜íƒ€ë‚¸ ê²ƒì´ë‹¤. <br/>
- ê·¸ë£¹ 1ê³¼ 2, ê·¸ë¦¬ê³  ê·¸ë£¹ 1ê³¼ 3ê°„ì˜ ë¹„êµì—ì„œ p-valueëŠ” ê°ê° 0.043, 0.020ìœ¼ë¡œ ìœ ì˜ìˆ˜ì¤€ 5%í•˜ì—ì„œ ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•˜ì˜€ë‹¤.<br/>
- ê·¸ë£¹ 2ì™€ 3ê°„ì˜ ë¹„êµì—ì„œ p-valueëŠ” 0.957ì´ë¯€ë¡œ ìœ ì˜ìˆ˜ì¤€ 5%í•˜ì—ì„œ ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•˜ì§€ ëª»í•œë‹¤. <br/>
- ì¦‰, íŒŒë¦¬ëŠ” 2ë²ˆ ì‹ë¬¼ì˜ layerì™€ 3ë²ˆ ì‹ë¬¼ì˜ layerì—ì„œ ê°™ì§€ë§Œ 1ë²ˆ ì‹ë¬¼ì˜ layerì—ì„œëŠ” ë‹¤ë¥´ë‹¤ê³  í•  ìˆ˜ ìˆë‹¤.

## EXAMPLE 11.8

![](/study/img/ch11/11-8.png)

- ì´ ì˜ˆì œëŠ” EXAMPLE 10.11ë¥¼ Dunn testë¥¼ ì´ìš©í•˜ì—¬ ë¹„ëª¨ìˆ˜ì  ë‹¤ì¤‘ë¹„êµë¥¼ í•˜ëŠ” ë¬¸ì œì´ë‹¤.<br/>
- ìœ„ Nemenyi testì™€ ë¹„ìŠ·í•œ ë°©ë²•ì´ì§€ë§Œ í‘œë³¸í¬ê¸°ê°€ ë‹¤ë¥¸ ë°ì´í„°ì´ë¯€ë¡œ ê·¸ë£¹ê°„ì˜ ì°¨ì´ê°€ ì–´ë–¤ ê·¸ë£¹ê°„ì— ìˆëŠ”ì§€ Dunn testë¥¼ ì‚¬ìš©í•˜ì˜€ë‹¤.

> Dunn test

``` r
ex11_8 <- read_excel(path = 'C:/git_blog/study/data/ch10/data_chap10.xls',sheet = 'exam10_11')
kwAllPairsDunnTest(ex11_8$ph, ex11_8$pond, p.adjust.method = "bonferroni")
```

    ##   1     2     3    
    ## 2 0.196 -     -    
    ## 3 0.019 1.000 -    
    ## 4 0.017 1.000 1.000

- ê²€ì • ê²°ê³¼ ê·¸ë£¹ [1,3], ê·¸ë£¹ [1,4]ì€ ì„œë¡œ ë‹¤ë¥¸ ë¶„í¬ë¥¼ ê°€ì§€ê³  ìˆìŒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

## EXAMPLE 11.9

![](/study/img/ch11/11-9.png)

- ì´ ì˜ˆì œëŠ” EXAMPLE 10.12ë¥¼ Tukey-Type multiple comparisonë¥¼ ì´ìš©í•˜ì—¬ ê·¸ë£¹ê°„ ì¤‘ì•™ê°’ì˜ ì°¨ì´ê°€ ìˆëŠ”ì§€ ë‹¤ì¤‘ë¹„êµí•˜ëŠ” ë¬¸ì œì´ë‹¤.

``` r
ex11_9 <- read_excel(path = 'C:/git_blog/study/data/ch10/data_chap10.xls',sheet = 'exam10_12')
median(ex11_9$height)
```

    ## [1] 7.9

![](/study/img/ch11/10-12_1.png)

- ì¤‘ì•™ê°’ì€ 7.9 ê°’ì´ ë‚˜ì™”ìœ¼ë©°, 7.9ë³´ë‹¤ í° ì²«ë²ˆì§¸ ìˆ˜ì¸ 8.1ë³´ë‹¤ í° ìˆ˜ë¥¼ ë¹ˆë„ë¡œ ì¡ì•„ North:3, East:2, South:9, West:6 ê°’ì´ ë‚˜ì˜¨ë‹¤.

``` r
s.size <- c(11,12,11,12)
N <- 46 ; n <- round(4/sum(1/s.size),2) ; se <- round(sqrt(n*N /(4*(N-1))),3)
freq <- c()
for (i in 1:4) {
  freq[i] = length(which(ex11_9$height[ex11_9$side==i] > 8.1))
}
diff <- c(freq[3]-freq[2],freq[3]-freq[1],freq[4]-freq[2])

table <- data.frame(Comparison=c("3 vs. 2", "3 vs. 1", "4 vs. 2"), Difference=diff, SE=se, q= round(diff/se,3), Critical_Value = 3.633)
table %>%
  kbl(caption = "") %>%
  kable_classic(full_width = F, html_font = "Cambria")
```

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
</caption>
<thead>
<tr>
<th style="text-align:left;">
Comparison
</th>
<th style="text-align:right;">
Difference
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
q
</th>
<th style="text-align:right;">
Critical_Value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
3 vs.Â 2
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
1.713
</td>
<td style="text-align:right;">
4.086
</td>
<td style="text-align:right;">
3.633
</td>
</tr>
<tr>
<td style="text-align:left;">
3 vs.Â 1
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
1.713
</td>
<td style="text-align:right;">
3.503
</td>
<td style="text-align:right;">
3.633
</td>
</tr>
<tr>
<td style="text-align:left;">
4 vs.Â 2
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1.713
</td>
<td style="text-align:right;">
2.335
</td>
<td style="text-align:right;">
3.633
</td>
</tr>
</tbody>
</table>

-4ê°œì˜ ê·¸ë£¹ì„ ë‘ ê·¸ë£¹ ì”© ì¤‘ì•™ê°’ì„ í†µí•´ ì°¨ì´ ê²€ì •ì„ ì‹¤ì‹œí•˜ì˜€ë‹¤. <br/>
- ê·€ë¬´ê°€ì„¤ì€ â€˜ë‘ ëª¨ì§‘ë‹¨ì˜ ì¤‘ì•™ê°’ì€ ë™ì¼í•˜ë‹¤.â€™, ëŒ€ë¦½ê°€ì„¤ì€ â€˜ë‘ ëª¨ì§‘ë‹¨ì˜ ì¤‘ì•™ê°’ì€ ë™ì¼í•˜ì§€ ì•Šë‹¤.â€™ ì´ë©°, <br/> q í†µê³„ëŸ‰ì´ ì„ê³„ê°’ 3.633 ë³´ë‹¤ í´ ê²½ìš° ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•œë‹¤.<br/>
- ê²€ì • ê²°ê³¼ ê·¸ë£¹ 3ê³¼ 2ë¥¼ ë¹„êµí–ˆì„ ë•Œ, q í†µê³„ëŸ‰ì´ ì„ê³„ê°’ë³´ë‹¤ í¬ë¯€ë¡œ ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•˜ì—¬ 3ë²ˆê³¼ 2ë²ˆ ëª¨ì§‘ë‹¨ì˜ ì¤‘ì•™ê°’ì´ ì„œë¡œ ë™ì¼í•˜ì§€ ì•ŠìŒì„ ì•Œ ìˆ˜ ìˆë‹¤.

## EXAMPLE 11.10

![](/study/img/ch11/11-10.png)


-   ì´ ì˜ˆì œëŠ” ë¶„ì‚°ì´ ë™ì¼í•˜ì§€ ì•Šì€ ê²°ê³¼ì— ëŒ€í•œ ë‹¤ì¤‘ë¹„êµë¥¼ í•˜ëŠ” ë¬¸ì œì´ë‹¤.

``` r
var <- c(2.74,2.83,2.20,6.42) ; n<- c(50,48,50,50) ; v <- n-1 ; treat <- c("1","2","3","4")
q_crit <- 3.633 ; Difference = round(log(c(var[4]/var[3], var[4]/var[1],var[4]/var[2], var[2]/var[3])),4)
SE = round(sqrt(c(1/v[4]+1/v[3], 1/v[4]+1/v[1],1/v[4]+1/v[2],1/v[2]+1/v[3])),3)
table <- data.frame(Comparison=c("4 vs. 3","4 vs. 1","4 vs. 2","2 vs. 3"), Difference,SE, q = round(Difference/SE,3), Critical_Value=q_crit)

table %>%
  kbl(caption = "") %>%
  kable_classic(full_width = F, html_font = "Cambria")
```

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
</caption>
<thead>
<tr>
<th style="text-align:left;">
Comparison
</th>
<th style="text-align:right;">
Difference
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
q
</th>
<th style="text-align:right;">
Critical_Value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
4 vs.Â 3
</td>
<td style="text-align:right;">
1.0710
</td>
<td style="text-align:right;">
0.202
</td>
<td style="text-align:right;">
5.302
</td>
<td style="text-align:right;">
3.633
</td>
</tr>
<tr>
<td style="text-align:left;">
4 vs.Â 1
</td>
<td style="text-align:right;">
0.8515
</td>
<td style="text-align:right;">
0.202
</td>
<td style="text-align:right;">
4.215
</td>
<td style="text-align:right;">
3.633
</td>
</tr>
<tr>
<td style="text-align:left;">
4 vs.Â 2
</td>
<td style="text-align:right;">
0.8191
</td>
<td style="text-align:right;">
0.204
</td>
<td style="text-align:right;">
4.015
</td>
<td style="text-align:right;">
3.633
</td>
</tr>
<tr>
<td style="text-align:left;">
2 vs.Â 3
</td>
<td style="text-align:right;">
0.2518
</td>
<td style="text-align:right;">
0.204
</td>
<td style="text-align:right;">
1.234
</td>
<td style="text-align:right;">
3.633
</td>
</tr>
</tbody>
</table>

- 4ê°œì˜ ê·¸ë£¹ì„ ë‘ ê·¸ë£¹ ì”© ë“±ë¶„ì‚° ê²€ì •ì„ ì‹¤ì‹œí•˜ì˜€ë‹¤.<br/>
- ê·€ë¬´ê°€ì„¤ì€ â€˜ë‘ ê·¸ë£¹ì˜ ëª¨ë¶„ì‚°ì€ ë™ì¼í•˜ë‹¤.â€™, ëŒ€ë¦½ê°€ì„¤ì€ â€˜ë‘ ê·¸ë£¹ì˜ ëª¨ë¶„ì‚°ì€ ë™ì¼í•˜ì§€ ì•Šë‹¤.â€™ ì´ë©°, <br/>ê²€ì • ê²°ê³¼ q í†µê³„ëŸ‰ì´ ì„ê³„ê°’ 3.633 ë³´ë‹¤ í´ ê²½ìš° ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•œë‹¤.<br/>
- ê²€ì • ê²°ê³¼ ê·¸ë£¹ 4ëŠ” ë‚˜ë¨¸ì§€ ê·¸ë£¹ ì „ì²´ì™€ ì„œë¡œ ëª¨ë¶„ì‚°ì´ ë™ì¼í•˜ì§€ ì•Šìœ¼ë©°, ê·¸ ì™¸ ê·¸ë£¹ë“¤ì˜ ëª¨ë¶„ì‚°ë“¤ì€ ì„œë¡œ ë™ì¼í•¨ì„ ì•Œ ìˆ˜ ìˆë‹¤.

</div>
</details>

<br/>

# SAS í”„ë¡œê·¸ë¨ ê²°ê³¼

<details>
<summary>
SAS ì ‘ê¸°/í¼ì¹˜ê¸° ë²„íŠ¼
</summary>
<div markdown="1">

```python
import saspy #SASì¶œë ¥ ì½”ë“œ
```

winlocal ì…ë ¥

## 11ì¥


</div>
</details>

<br/>

<br/>

<font color='#fb8072'>êµì¬: Biostatistical Analysis (5th Edition) by Jerrold H. Zar</font><br/>

<font color='#fb8072'> **ì´ ê¸€ì€ 22í•™ë…„ë„ 1í•™ê¸° ì˜í•™í†µê³„ë°©ë²•ë¡  ê³¼ì œ ìë£Œë“¤ì„ ì •ë¦¬í•œ ê¸€ ì…ë‹ˆë‹¤.** </font>