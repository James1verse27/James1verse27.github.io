---
layout: post
title:  "[ì˜í•™í†µê³„ë°©ë²•ë¡ ] Ch6. The Normal Distribution"
category: Study
tag: [R, SAS, blog, jekyll, Jupyter, Data, Python]
toc: true
---
* this unordered seed list will be replaced by the toc
{:toc}

- ë’¤ë¡œê°€ê¸°ë¥¼ ëˆ„ë¥´ì‹œë©´ ëª©ì°¨ë¡œ ë˜ëŒì•„ì˜µë‹ˆë‹¤. ğŸ˜‰

# The Normal Distribution

<details>
<summary>
ì •ë¦¬ë‚´ìš© ì ‘ê¸°/í¼ì¹˜ê¸° ë²„íŠ¼
</summary>
<div markdown="1">

## 6.1 

## 6.2

## 6.3

## 6.4

## 6.5

## 6.6

## 6.7

## 6.8

</div>
</details>

<br/>

# R í”„ë¡œê·¸ë¨ ê²°ê³¼

<details>
<summary>
R ì ‘ê¸°/í¼ì¹˜ê¸° ë²„íŠ¼
</summary>
<div markdown="1">

**íŒ¨í‚¤ì§€**
<details>
<summary>
ì„¤ì¹˜ëœ íŒ¨í‚¤ì§€ ì ‘ê¸°/í¼ì¹˜ê¸° ë²„íŠ¼
</summary>

``` r
getwd()
```

    ## [1] "C:/git_blog(/study/img/ch6"

``` r
#install.packages("readxl")
#install.packages('ggplot2')
#install.packages("Hmisc")
#install.packages("survey")
#install.packages("vegan")
#install.packages("dplyr")
#install.packages("kableExtra")
#install.packages("psych")
library('Hmisc')
library('readxl')
library('ggplot2')
library('vegan')
library('dplyr')
library('kableExtra')
library('psych')
```

</details>

**ì—‘ì…€íŒŒì¼ë¶ˆëŸ¬ì˜¤ê¸°**

``` r
#ëª¨ë“  ì‹œíŠ¸ë¥¼ í•˜ë‚˜ì˜ ë¦¬ìŠ¤íŠ¸ë¡œ ë¶ˆëŸ¬ì˜¤ëŠ” í•¨ìˆ˜
read_excel_allsheets <- function(file, tibble = FALSE) {
  sheets <- readxl::excel_sheets(file)
  x <- lapply(sheets, function(X) readxl::read_excel(file, sheet = X))
  if(!tibble) x <- lapply(x, as.data.frame)
  names(x) <- sheets
  x
}
```

## 6ì¥

**6ì¥ ì—°ìŠµë¬¸ì œ ë¶ˆëŸ¬ì˜¤ê¸°**

``` r
#data_chap06ì— ì—°ìŠµë¬¸ì œ 6ì¥ ëª¨ë“  ë¬¸ì œ ì €ì¥
data_chap06 <- read_excel_allsheets("data_chap06.xls")

#ì—°ìŠµë¬¸ì œ ê°ê° ë°ì´í„° ìƒì„±
for (x in 1:length(data_chap06)){
  assign(paste0('ex6_',c(3,4,7))[x],data_chap06[x])
  }

#ì—°ìŠµë¬¸ì œ ë°ì´í„° í˜•ì‹ì„ ë¦¬ìŠ¤íŠ¸ì—ì„œ ë°ì´í„°í”„ë ˆì„ìœ¼ë¡œ ë³€í™˜
for (x in 1:length(data_chap06)){
  assign(paste0('ex6_',c(3,4,7))[x],data.frame(data_chap06[x]))
  }
```



### EXAMPLE 6.1a

![](/study/img/ch6//6-1a.png)

``` r
x <- seq(30,90, length=200)
ar_x = seq(66,90,0.001)
x_p = c(ar_x, rev(ar_x))
ar_y=dnorm(ar_x, mean=60, sd=10)
y_p = c(rep(0,length(ar_y)),rev(ar_y))
ar_x2=seq(77.5,90,0.001)
x_p2= c(ar_x2, rev(ar_x2))
ar_y2=dnorm(ar_x2, mean=60, sd=10)
y_p2=c(rep(0,length(ar_y2)), rev(ar_y2))
plot(x, dnorm(x,mean=60, sd=10), type='l',xlab='Xi in millimeters', ylab="Y", yaxt="n",main="Example 6.1a : Calculating Proportions of a Normal Distribution of Bone Lengths")
polygon(x_p,y_p, col='#8dd3c7', density=30)
polygon(x_p2,y_p2, col='#ffffb3', density=50)
arrows(66,dnorm(66,60,10),66,0, angle=0)
text(57,0.006,labels='66',adj=0, cex=2, col='#007266')
arrows(77.5,dnorm(77.5,60,10),77.5,0, angle=0)
text(80,0.017,labels='77.5',adj=0, cex=2, col='#007266')
arrows(60,0.005,66,0,length=0.25, angle=30,code=2)
arrows(80,0.015,77.5,0.009,length=0.25, angle=30,code=2)
```

![](/study/img/ch6//unnamed-chunk-2-1.png)

**$$Q$$.6.1a.1 ) What proportion of the population of bone lengths is larger than 66 $$mm$$?**

``` r
#1
prop <- round((1-pnorm(66,60,10))*100,2)
cat("proportion of the population of bone lengths larer than 66 =",prop,"%")
```

    ## proportion of the population of bone lengths larer than 66 = 27.43 %

$$
\begin{aligned}
Z=\frac{X_i-\mu}{\sigma}=\frac{66\ mm - 60\ mm}{10\ mm} = 0.60\\
\\
P(X_i > 66\ mm) = P(Z>0.60)=0.2743\ or\ 27.43\ \%
\end{aligned}
$$

ì¸¡ì •ëœ ë¼ˆ ê¸¸ì´ëŠ” $$ \mu = 60mm$$ì´ê³ , $$ \sigma=10mm$$ì¸ ì •ê·œë¶„í¬ë¥¼ ë”°ë¥´ê³  ìˆë‹¤.

í•´ë‹¹ ë¶„í¬ì—ì„œ ë¼ˆê¸¸ì´ê°€ 66mm ì´ìƒì¸ ì‚¬ëŒì´ ì¶”ì¶œë  í™•ë¥ ì„ êµ¬í•˜ê¸° ìœ„í•´ pnorm í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì˜€ë‹¤.

ê·¸ ê²°ê³¼, ë¼ˆ ê¸¸ì´ê°€ 66mmì´ìƒì¸ ì‚¬ëŒì´ ì¶”ì¶œë  í™•ë¥ ì€ 0.2473(24.73%)ë¡œ ê³„ì‚°ë˜ì—ˆë‹¤.


**$$Q$$.6.1a.2 ) What is the probability of picking, at random from this population, a bone larger than 66 $$mm$$?**

``` r
#2
prob <- round((1-pnorm(66,60,10)),4)
cat("probability of picking a bone lengths larer than 66 =",prob)
```

    ## probability of picking a bone lengths larer than 66 = 0.2743

$$
\begin{aligned}
Probability\ of\ picking\ a\ bone\ lengths\ larger\ than\ 66\ mm =\ 0.2743
\end{aligned}
$$

**$$Q$$.6.1a.3 ) If there are 2000 bone lengths in population, how many of them are greater than 66 $$mm$$?**

``` r
#3
popu <- round(2000*(1-pnorm(66,60,10)))
cat("population of bone length is greater than 66 mm in 2000 =",popu)
```

    ## population of bone length is greater than 66 mm in 2000 = 549

$$
\begin{aligned}
Population\ of\ bone\ length\ greater\ than\ 66\ mm\ in\ 2000\ =\ (0.2743)*(2000)=549
\end{aligned}
$$

ì¸êµ¬ì§‘ë‹¨ì´ 2000ëª…ì¼ ê²½ìš°, ë¼ˆê¸¸ì´ê°€ 66mmì´ìƒì¸ ì‚¬ëŒì˜ ìˆ˜ë¥¼ êµ¬í•´ë³´ì

**#1**ì—ì„œ ê³„ì‚°ëœ í™•ë¥  0.2473ì„ ì¸êµ¬ìˆ˜ì¸ 2000ì— ê³±í•˜ì˜€ê³ ,

ê·¸ ê²°ê³¼ 2000ëª… ì¤‘ 549ëª…ì˜ ë¼ˆ ê¸¸ì´ê°€ 66mmì´ìƒì„ì„ ì•Œ ìˆ˜ ìˆë‹¤.

**$$Q$$.6.1a.4 ) What proportion of the population is smaller than 66 $$mm$$ ?**

``` r
#4
prob <- round((pnorm(66,60,10)),4)
cat("probability of picking a bone lengths smaller than 66 =",prob)
```

    ## probability of picking a bone lengths smaller than 66 = 0.7257

$$
\begin{aligned}
P(X_i < 66\ mm) = 1-P(X_i > 66\ mm) =1-0.2743=0.7257
\end{aligned}
$$

ë¼ˆ ê¸¸ì´ê°€ 66mmì´í•˜ì¼ í™•ë¥ ì„ ê³„ì‚°í•˜ì˜€ë‹¤.

**#1**ì—ì„œ êµ¬í•œ 66mmì´ìƒì¼ í™•ë¥ ê³¼ ë°˜ëŒ€ë˜ëŠ” ê°’ìœ¼ë¡œ 1ì—ì„œ 66mmì´ìƒì¼ í™•ë¥ ì„ ëºë‹¤.

í•´ë‹¹ ê°’ì€ 0.7257ì„ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

**$$Q$$.6.1a.5 ) What proportion of this population lies between 60 and 66 $$mm$$?**

``` r
#5
p_60 <- 1-pnorm(60,60,10) # larger than 60 mm
p_66 <- 1-pnorm(66,60,10) # larger than 66 mm
p_60_66 <- round(p_60 - p_66,4)
cat("proportion between 60 and 66 = ",p_60,"-",round(p_66,4)," = ",p_60_66," or",round(p_60_66*100,2),"%")
```

    ## proportion between 60 and 66 =  0.5 - 0.2743  =  0.2257  or 22.57 %

$$
\begin{aligned}
P(60\ mm<X_i < 66\ mm) = 0.5-0.2743=0.2257
\end{aligned}
$$       

ë¼ˆ ê¸¸ì´ê°€ 60mmì´ìƒ 66mmì´í•˜ì¼  í™•ë¥ ì„  êµ¬í•˜ì˜€ë‹¤.

(ì´ëŠ” ì •ê·œë¶„í¬ë¡œ ë³€í™˜í•œ $$0<Z<0.6$$ êµ¬ê°„ê³¼ ê°’ì´ ë™ì¼í•˜ë‹¤)

60mmì´í•˜ì¼ í™•ë¥ ì—ì„œ 66mmì´ìƒì¼ í™•ë¥ ì„ ëº€ ê°’ìœ¼ë¡œ p-valueëŠ” 0.2257ì„ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

**$$Q$$.6.1a.6 ) What portion of the area under the normal curve lies to the right of 77.5 $$mm$$?**

``` r
#6
prop <- round((1-pnorm(77.5,60,10))*100,2)
cat("proportion of the population of bone lengths larer than 77.5 =",prop,"%")
```

    ## proportion of the population of bone lengths larer than 77.5 = 4.01 %

$$
\begin{aligned}
Z=\frac{X_i-\mu}{\sigma}=\frac{77.5\ mm - 60\ mm}{10\ mm} = 1.75\\
\\
P(X_i > 77.5\ mm) = P(Z>1.75)=0.0401\ or\ 4.01\ \%
\end{aligned}
$$

ë¼ˆ ê¸¸ì´ê°€ 77.5mm ì´ìƒì¼ í™•ë¥ ì„ êµ¬í•˜ì˜€ë‹¤.

í•´ë‹¹ ê°’ì„ êµ¬í•˜ê¸° ìœ„í•´ í‘œì¤€í™”ë¥¼ ì‹¤ì‹œí•˜ì˜€ê³ ,

í‘œì¤€ì •ê·œë¶„í¬ì˜ í™•ë¥ ì„ êµ¬í•œ ê²°ê³¼ ë¼ˆ ê¸¸ì´ê°€ 77.5mmì´ìƒì¼ í™•ë¥ ì€ 0.0401 (4.01%)ë¡œ ê³„ì‚°ë˜ì—ˆë‹¤.

**$$Q$$.6.1a.7 ) If there are 2000 bone lengths in population, how many of them are greater than 77.5 $$mm$$?**

``` r
#7
popu <- round(2000*(1-pnorm(77.5,60,10)))
cat("population of bone length is greater than 77.5 mm in 2000 =",popu)
```

    ## population of bone length is greater than 77.5 mm in 2000 = 80

$$
\begin{aligned}
Population\ of\ bone\ length\ greater\ than\ 77.5\ mm\ in\ 2000\ =\ (0.0401)*(2000)=80
\end{aligned}
$$

ì¸êµ¬ 2000ëª…ì—ì„œ ë¼ˆ ê¸¸ì´ê°€ 77.5mmì´ìƒì¸ ì‚¬ëŒì˜ ìˆ˜ëŠ” 80ëª…ì´ë‹¤.

**$$Q$$.6.1a.8 ) What is the probability of selecting at random from this population a bone measuring between 66 and 77.5 $$mm$$ in length?**

``` r
#8
p_66 <- 1-pnorm(66,60,10) # larger than 66 mm
p_77_5 <- 1-pnorm(77.5,60,10) # larger than 77.5 mm
p_66_77_5 <- round(p_66 - p_77_5,4)
cat("proportion between 66 and 77.5 = ",round(p_66,4),"-",round(p_77_5,4)," = ",p_66_77_5," or",round(p_66_77_5*100,2),"%")
```

    ## proportion between 66 and 77.5 =  0.2743 - 0.0401  =  0.2342  or 23.42 %

$$
\begin{aligned}
P(66\ mm <X_i < 77.5\ mm) = 0.2743-0.0401=0.2342
\end{aligned}
$$

ë¼ˆ ê¸¸ì´ê°€ 60mmì—ì„œ 77.5mm ì‚¬ì´ì¼ í™•ë¥ ì„ ë‚˜íƒ€ë‚¸ ê°’ìœ¼ë¡œ ì´ëŠ” 60mmì´í•˜ í™•ë¥ ì—ì„œ 77.5mmì´í•˜ì¼ í™•ë¥ ì„ ëº€ ê°’ìœ¼ë¡œ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆë‹¤.

ê·¸ ê²°ê³¼ p-valueëŠ” 0.2342ì´ë‹¤.

Example6.1aë¥¼ í†µí•´ ë¶„í¬ì˜ í‰ê· ìœ¼ë¡œë¶€í„° ê°’ì´ ë©€ì–´ì§ˆìˆ˜ë¡ ë‚˜íƒ€ë‚  í™•ë¥ ì´ ì‘ì•„ì§€ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

### EXAMPLE 6.1b

![](/study/img/ch6//6-1b.png)

``` r
#normal distribution plot 
x <- seq(-25,150, length=300)
#45êµ¬ê°„
ar_x = seq(-25,45,0.001)
x_p = c(ar_x, rev(ar_x))
ar_y=dnorm(ar_x, mean=65, sd=25)
y_p = c(rep(0,length(ar_y)),rev(ar_y))
##85êµ¬ê°„
ar_x2=seq(85,150,0.001)
x_p2= c(ar_x2, rev(ar_x2))
ar_y2=dnorm(ar_x2, mean=65, sd=25)
y_p2=c(rep(0,length(ar_y2)), rev(ar_y2))
#plot
plot(x, dnorm(x,mean=65, sd=25), type='l',xlab='X,in mg/100ml', ylab="Y", yaxt="n",main="Example 6.1b : Calculating Proportions of a Normal Distribution of Sucrose Concentration")
polygon(x_p,y_p, col='#8dd3c7', density=50)
polygon(x_p2,y_p2, col='#8dd3c7', density=50)
arrows(45,dnorm(45,65,25),45,0, angle=0)
text(20,0.012,labels='45',adj=0, cex=2, col='#007266')
arrows(85,dnorm(85,65,25),85,0, angle=0)
text(105,0.012,labels='85',adj=0, cex=2, col='#007266')
arrows(30,0.012,45,0.0115,length=0.25, angle=30,code=2)
arrows(100,0.012,85,0.0115,length=0.25, angle=30,code=2)
```

![](/study/img/ch6//unnamed-chunk-11-1.png)

**$$Q$$ 6.1b.1) What proportion of the population is greater than $$85 mg$$ / $$100ml$$ ?**

``` r
#1
prop <- round(((1-pnorm(85,65,25))*100),2)
cat("proportion of the population of Sucrose Concentration larger than 85mg/100ml =",prop,"%")
```

    ## proportion of the population of Sucrose Concentration larger than 85mg/100ml = 21.19 %

$$
\begin{aligned}
Z = \frac{X_i-\mu}{\sigma}= \frac{85\ mg/100ml - 65\ mg/100ml}{25\ mg/100ml}=0.8\\
P(X_i > 85\ mg/100ml) = P(Z > 0.8)=0.2199\ or\ 21.19\ \%
\end{aligned}
$$

ì¸¡ì •ëœ ë‹¹ ë†ë„(sucrose concentration)ì€  $$\mu = 65mg/100ml$$ì´ê³ , $$\sigma = 25mg/100ml$$ì¸  ì •ê·œë¶„í¬ë¥¼  ë”°ë¥¸ë‹¤.

ë‹¹ë†ë„ê°€ 85mg/100ml ì´ìƒì¼ í™•ë¥ ì„ êµ¬í•œ ê°’ìœ¼ë¡œ 0.2119(21.19%)ë¡œ ê³„ì‚°ë˜ì—ˆë‹¤.

**$$Q$$ 6.1b.2) What proportion of the population is less than $$45mg$$ / $$100ml$$ ?**

``` r
#2
prop <- round(((pnorm(45,65,25))*100),2)
cat("proportion of the population of Sucrose Concentration less than 45mg/100ml =",prop,"%")
```

    ## proportion of the population of Sucrose Concentration less than 45mg/100ml = 21.19 %

$$
\begin{aligned}
Z = \frac{X_i-\mu}{\sigma}= \frac{45\ mg/100ml - 65\ mg/100ml}{25\ mg/100ml}=-\ 0.8\\
P(X_i < 45\ mg/100ml) = P(Z < -\ 0.8)=0.2199\ or\ 21.19\ \%
\end{aligned}
$$  

**#1**ê³¼ ê°™ì€ ê°’ì´ ë‚˜ì˜¤ëŠ” ì´ìœ ëŠ” 45mg/100mlì™€ 85mg/100mlëŠ” í‰ê·  65mg/100ml ê¸°ì¤€ìœ¼ë¡œ ëŒ€ì¹­ì„ ì´ë£¨ê¸° ë•Œë¬¸ì´ë‹¤.

**$$Q$$ 6.1b.3) What proportion of the population lies between $$45$$ and $$85mg$$ / $$100ml$$ ?**

``` r
#3
p_45 <- round(pnorm(45,65,25),4) #less than 45
p_85 <- round(1-pnorm(85,65,25),4)#larger than 85
p_45_85 <- round((1-(p_45+p_85))*100,2) #between 45 and 85
cat("proportion of the population of Sucrose Concentration between 45 and 85mg/100ml =",p_45_85,"%")
```

    ## proportion of the population of Sucrose Concentration between 45 and 85mg/100ml = 57.62 %

$$
\begin{aligned}
P(45\ mg/100ml < X_i < 85\ mg/100ml) &= P(-0.80 < Z < 0.80)\\
&= 1-P(Z < -0.80\ or\ Z>0.80)\\
&= 1-(0.2119+0.2119)\\
&= 1-0.4138\\
&= 0.5767\ or\ 57.62\ \%
\end{aligned}
$$

ë‹¹ë†ë„ê°€ 45mg/100mlì™€ 85mg/100ml ì‚¬ì´ì˜ ê°’ì„ ê°€ì§ˆ í™•ë¥ ì˜ ê°’ìœ¼ë¡œ 0.5762ê°€ ê³„ì‚°ë˜ì—ˆë‹¤.

### EXAMPLE 6.2

![](/study/img/ch6//6-2.png)

**$$Q$$ 6.2.1) A population of one-year-old children's chest circumstances has $$\mu=47.0\ cm$$ and $$\sigma = 12.0\ cm$$, what is the probability of drawing from it a random sample of nine measurements that has a mean larger than 50.0$$cm$$ ?**

``` r
#1
mu <- 47 ; sigma <- 12 ; n <- 9
sigma_xbar <- sigma/sqrt(n)
z <- (50-mu)/sigma_xbar
p <- 1-pnorm(z)
cat("Probability of mean larger than 50.0cm = ",round(p,4))
```

    ## Probability of mean larger than 50.0cm =  0.2266

$$
\begin{aligned}
\sigma_{\bar{X}} = \frac{12.0\ cm}{\sqrt 9} = 4.0\ cm \\
Z = \frac{\bar{X}-\mu}{\sigma_{\bar{X}}} = \frac{50.0\ cm\ -\ 47.0\ cm}{4.0\ cm} = 0.75 \\
P(\bar{X} > 50.0\ cm) &= 1 - P(\bar{X} < 50.0\ cm) \\
&= P(Z>0.75) \\
&= 0.2266
\end{aligned}
$$

1ì„¸ ì•„ë™ì˜ ëª¨ì§‘ë‹¨ì˜ ê°€ìŠ´ë‘˜ë ˆ ë¶„í¬ëŠ” $$\mu=47cm$$ì´ê³ , $$\sigma=12cm$$ì¸ ì •ê·œë¶„í¬ë¥¼ ë”°ë¥¸ë‹¤.

9ëª…ì˜ ì•„ë™ì„ ì¶”ì¶œí–ˆì„ ë•Œì˜ í‘œì¤€ì˜¤ì°¨ëŠ” $$\frac{\sigma}{\sqrt{n}}=\frac{12}{\sqrt{9}}=4cm$$

$$\overline{x}$$
$$\frac{(\overline{X}-\mu)} {\sigma_{\overline{x}}} = \frac{50-47}{4} = 0.75$$

$$P(\overline{X}>50)=P(Z>0.75)=0.2266$$

ë”°ë¼ì„œ 1ì„¸ ì•„ë™ ì§‘ë‹¨ì—ì„œ ê°€ìŠ´ë‘˜ë ˆì˜ í‰ê· ì´ 50cmë³´ë‹¤ í° 9ëª…ì´ ì¶”ì¶œë  í™•ë¥ ì€ 0.2266ì´ë‹¤.

**$$Q$$ 6.2.2) What is the probability of drawing a sample of 25 measurements from the preceding population and finding that the mean of this sample is less than $$40.0 cm$$?**

``` r
#2
mu <- 47 ; sigma <- 12 ; n <- 25
sigma_xbar <- sigma/sqrt(n)
z <- (40-mu)/sigma_xbar
p <- pnorm(z)
cat("Probability of mean less than 47.0cm = ",round(p,4))
```

    ## Probability of mean less than 47.0cm =  0.0018

$$
\begin{aligned}
\sigma_{\bar{X}} = \frac{12.0\ cm}{\sqrt 25} = 2.4\ cm \\
Z = \frac{\bar{X}-\mu}{\sigma_{\bar{X}}} = \frac{40.0\ cm\ -\ 47.0\ cm}{4.0\ cm} = -2.92 \\
P(\bar{X} < 40.0\ cm) &= 1 - P(\bar{X} < 40.0\ cm) \\
&= P(Z>2.92) \\
&= 0.0018
\end{aligned}
$$

25ëª…ì˜ ì•„ë™ì„ ì¶”ì¶œí–ˆì„ ë•Œì˜ í‘œì¤€ì˜¤ì°¨ëŠ” $$\frac{\sigma}{\sqrt{n}}=\frac{12}{\sqrt{25}}=2.4cm$$ì´ë‹¤.

$$\frac{(\overline{X}-\mu)}{\sigma_{\overline{x}}}=\frac{40-47}{2.4}=-2.92$$

$$P(\overline{X}<40)=P(Z<-2.92)=0.0018$$

ë”°ë¼ì„œ 1ì„¸ ì•„ë™ ì§‘ë‹¨ì—ì„œ ê°€ìŠ´ë‘˜ë ˆì˜ í‰ê· ì´ 40cmë³´ë‹¤ ì‘ì€ 25ëª…ì´ ì¶”ì¶œë  í™•ë¥ ì€ 0.0018ì´ë‹¤.

**$$Q$$ 6.2.3) If 500 random samples of size 25 are taken from the preceding population, how many of then would have means larger than 50.0 $$cm$$?**

``` r
#3
mu <- 47 ; sigma <- 12 ; n <- 25
sigma_xbar <- sigma/sqrt(n)
z <- (50-mu)/sigma_xbar
p <- 1-pnorm(z)
amount <- round(p,4)*500
cat("Amount of mean larger than 50.0cm = ",round(amount))
```

    ## Amount of mean larger than 50.0cm =  53

25ëª…ì˜ ì•„ë™ì„ ì¶”ì¶œí–ˆì„ ë•Œì˜ $$P(\overline{X}>50)$$ëŠ” $$P(Z>1.25)=0.1056$$ì´ë‹¤.

í‘œë³¸ì˜ ìˆ˜ê°€ ì»¤ì§ˆìˆ˜ë¡ ì¶”ì¶œë  í™•ë¥ ì˜ ê°’ì´ ì‘ì•„ì§ì„ ì•Œ ìˆ˜ ìˆë‹¤.

ë˜í•œ í‰ê· ìœ¼ë¡œë¶€í„° ê°’ì´ ë©€ì–´ì§ˆìˆ˜ë¡ zê°’ì´ ì»¤ì ¸ p-valueëŠ” ì‘ì•„ì§„ë‹¤.

### EXAMPLE 6.3

![](/study/img/ch6//6-3.png)

``` r
#ë°ì´í„°ì…‹
ex6_3%>%
  kbl(caption = "EXAMPLE 6.3 dataset") %>%
  kable_minimal() %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```

<table class=" lightable-minimal table table-striped table-hover table-condensed table-responsive" style="font-family: &quot;Trebuchet MS&quot;, verdana, sans-serif; margin-left: auto; margin-right: auto; margin-left: auto; margin-right: auto;">
<caption>
EXAMPLE 6.3 dataset
</caption>
<thead>
<tr>
<th style="text-align:right;">
SBP
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
121
</td>
</tr>
<tr>
<td style="text-align:right;">
125
</td>
</tr>
<tr>
<td style="text-align:right;">
128
</td>
</tr>
<tr>
<td style="text-align:right;">
134
</td>
</tr>
<tr>
<td style="text-align:right;">
136
</td>
</tr>
<tr>
<td style="text-align:right;">
138
</td>
</tr>
<tr>
<td style="text-align:right;">
139
</td>
</tr>
<tr>
<td style="text-align:right;">
141
</td>
</tr>
<tr>
<td style="text-align:right;">
144
</td>
</tr>
<tr>
<td style="text-align:right;">
145
</td>
</tr>
<tr>
<td style="text-align:right;">
149
</td>
</tr>
<tr>
<td style="text-align:right;">
151
</td>
</tr>
</tbody>
</table>

``` r
descriptives6.3  <- function(x) {
  x <- na.omit(x)
  n <- length(x)
  sum_x <- sum(x)
  sum_x2 <- sum(x^2)
  mean <- mean(x)
  ss <- sum_x2-(sum_x^2/12)
  s2 <- ss/(n-1)
  s <- sqrt(s2)
  s_err <- s/sqrt(n)
  out <- data.frame(n=n, Mean=round(mean,1) ,Sum_X=sum_x, Sum_x2 = sum_x2, Sum_of_Square=round(ss,4), variance=round(s2,4), std=round(s,2), std.err=round(s_err,1))
  return(out)
}

descriptives6.3 (ex6_3$SBP)%>%
  kbl(caption = "Descriptives ex6.3") %>%
  kable_minimal() %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```

<table class=" lightable-minimal table table-striped table-hover table-condensed table-responsive" style="font-family: &quot;Trebuchet MS&quot;, verdana, sans-serif; margin-left: auto; margin-right: auto; margin-left: auto; margin-right: auto;">
<caption>
Descriptives ex6.3
</caption>
<thead>
<tr>
<th style="text-align:right;">
n
</th>
<th style="text-align:right;">
Mean
</th>
<th style="text-align:right;">
Sum_X
</th>
<th style="text-align:right;">
Sum_x2
</th>
<th style="text-align:right;">
Sum_of_Square
</th>
<th style="text-align:right;">
variance
</th>
<th style="text-align:right;">
std
</th>
<th style="text-align:right;">
std.err
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
137.6
</td>
<td style="text-align:right;">
1651
</td>
<td style="text-align:right;">
228111
</td>
<td style="text-align:right;">
960.9167
</td>
<td style="text-align:right;">
87.3561
</td>
<td style="text-align:right;">
9.35
</td>
<td style="text-align:right;">
2.7
</td>
</tr>
</tbody>
</table>

$$
\begin{aligned}
n&=12\\
\overline X &= \frac{1651\ mm}{12} = 137.6\ mm \\
SS &= 228,111\ m^2 - \frac{(1651\ mm)^2}{12}\\
&= 960.9167\ mm^2\\
s^2 &= \frac{960.9167\ mm^2}{11} = 87.3651\ mm^2\\
s &= \sqrt{87.3561\ mm^2} = 9.35\ mm\\
s_{\overline X} &= \frac{s}{\sqrt{n}}=\frac{9.35\ mm}{12}=2.7\ mm
\end{aligned}
$$

12ë§ˆë¦¬ ì¹¨íŒ¬ì¹˜ì˜ ìˆ˜ì¶•ê¸° í˜ˆì••ë°ì´í„°ì´ë‹¤. 

$$\overline{X}=137.6mm, \ s=9.35mm, \ s_{\overline{X}}=2.7mm$$

ë¶“ìŠ¤íŠ¸ë©ì„ í†µí•´ í‰ê· ì˜ í‘œì¤€ì˜¤ì°¨ë¥¼ êµ¬í•˜ëŠ” ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

1000ê°œì˜ ë¶“ìŠ¤íŠ¸ë© í‘œë³¸ìœ¼ë¡œ ê³„ì‚°ì„ í•´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.

``` r
boot.mean <- function(data,num){
  resamples <- lapply(1:num, function(i) sample(data,replace=T))
  r.mean <- sapply(resamples,mean)
  std.err <- sqrt(var(r.mean))
  list(std.err = std.err, resamples=resamples,mean=r.mean)
}

boot <- data.frame(std.err=boot.mean(ex6_3$SBP,1000)$std.err, mean=boot.mean(ex6_3$SBP,1000)$mean)
ggplot(boot,(aes(x=mean)))+
  geom_histogram(fill="#8dd3c7",color="#ffffb3",binwidth=0.8)+
  xlab("Means of Bootstrap data6_3") + ylab("Frequency") +
  ggtitle("Histogram of Bootstrap data6_3")+
  theme_bw()+
  theme(legend.position = "right")+
  theme(legend.text = element_text(size=15))+
  theme(legend.title = element_text(size=15))+
  theme(axis.text.x  = element_text(size=10))+
  theme(axis.text.y=element_text(size=10))+
  theme(axis.title = element_text(size=20))+
  theme(plot.title = element_text(size=16,hjust = 0.5))+
  annotate("text", x=130, y=120, label=paste0("Mean = ",round(mean(boot$mean),1)), size=5,hjust=0)+
  annotate("text", x=130, y=110, label=paste0("Std err = ",round(boot$std.err,1)), size=5,hjust=0)
```

![](/study/img/ch6//unnamed-chunk-20-1.png)

|statistics|Original Data|Bootstrap Data|
|:-----|:-----|:-----|
|Mean|137.6 |137.7 |
|Standard Error|2.7 |2.6 |

ex6_3 ë°ì´í„°ì—ì„œ êµ¬í•œ í‰ê· ì˜ í‘œì¤€ì˜¤ì°¨ì™€ ë¶“ìŠ¤íŠ¸ë© ë°ì´í„°ì—ì„œ ì¶”ì¶œí•œ í‰ê· ì˜ í‘œì¤€ì˜¤ì°¨ê°€ í¬ê²Œ ì°¨ì´ê°€ ë‚˜ì§€ ì•ŠìŒì„ ì•Œ ìˆ˜ ìˆìœ¼ë©°,

ì´ëŠ” í‘œë³¸ì˜ ìˆ˜ê°€ ë§ì„ìˆ˜ë¡ í‘œë³¸í‰ê· ì˜ í‰ê· ê³¼ í‘œì¤€ì˜¤ì°¨ëŠ” ëª¨ì§‘ë‹¨ì¸ ë³¸ ë°ì´í„°ì˜ í‰ê· ê³¼ í‘œì¤€ì˜¤ì°¨ì™€ ê·¼ì‚¬í•œë‹¤.

### EXAMPLE 6.4

``` r
#ë°ì´í„°ì…‹
ex6_4%>%
  kbl(caption = "EXAMPLE 6.4 dataset") %>%
  kable_minimal() %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```

<table class=" lightable-minimal table table-striped table-hover table-condensed table-responsive" style="font-family: &quot;Trebuchet MS&quot;, verdana, sans-serif; margin-left: auto; margin-right: auto; margin-left: auto; margin-right: auto;">
<caption>
EXAMPLE 6.4 dataset
</caption>
<thead>
<tr>
<th style="text-align:right;">
X
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
2.0
</td>
</tr>
<tr>
<td style="text-align:right;">
1.1
</td>
</tr>
<tr>
<td style="text-align:right;">
4.4
</td>
</tr>
<tr>
<td style="text-align:right;">
-3.1
</td>
</tr>
<tr>
<td style="text-align:right;">
-1.3
</td>
</tr>
<tr>
<td style="text-align:right;">
3.9
</td>
</tr>
<tr>
<td style="text-align:right;">
3.2
</td>
</tr>
<tr>
<td style="text-align:right;">
-1.6
</td>
</tr>
<tr>
<td style="text-align:right;">
3.5
</td>
</tr>
<tr>
<td style="text-align:right;">
1.2
</td>
</tr>
<tr>
<td style="text-align:right;">
2.5
</td>
</tr>
<tr>
<td style="text-align:right;">
2.3
</td>
</tr>
<tr>
<td style="text-align:right;">
1.9
</td>
</tr>
<tr>
<td style="text-align:right;">
1.8
</td>
</tr>
<tr>
<td style="text-align:right;">
2.9
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.3
</td>
</tr>
<tr>
<td style="text-align:right;">
-2.4
</td>
</tr>
</tbody>
</table>

ex6_4 ë°ì´í„°ëŠ” 17ë§ˆë¦¬ì˜ ë§ì„ ì¡°ì‚¬í•œ ë°ì´í„°ì´ë©° 2ì£¼ê°„ í•­ìƒì œë¥¼ íˆ¬ì—¬í•œ í›„
ëª¸ë¬´ê²Œì˜ ì¦ê°ì„ ë‚˜íƒ€ë‚´ê³  ìˆë‹¤.

ë§ë“¤ì˜ ëª¸ë¬´ê²Œì˜ ë³€í™”ì–‘ì˜ ëª¨í‰ê· ì´ 0ì¸ì§€ ìœ ì˜ìˆ˜ì¤€ 5%ì—ì„œ ê²€ì •í•œë‹¤.

``` r
descriptives6_4 <- function(x){
  n <- length(x)
  mean_x <- mean(x)
  var_x <- 13.4621
  se <- sqrt(var_x/n)
  z_value <- (mean_x-0)/se
  p_value <- 2*(1-pnorm(z_value))
  out <- data.frame(n=n,mean=round(mean_x,2),Variance=var_x,SE=round(se,2),Z=round(z_value,2),P_value = round(p_value,4))
  return(out)
}

descriptives6_4(ex6_4$X)%>%
  kbl(caption = "Descriptives ex6.4") %>%
  kable_minimal() %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```

<table class=" lightable-minimal table table-striped table-hover table-condensed table-responsive" style="font-family: &quot;Trebuchet MS&quot;, verdana, sans-serif; margin-left: auto; margin-right: auto; margin-left: auto; margin-right: auto;">
<caption>
Descriptives ex6.4
</caption>
<thead>
<tr>
<th style="text-align:right;">
n
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
Variance
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
Z
</th>
<th style="text-align:right;">
P_value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
1.29
</td>
<td style="text-align:right;">
13.4621
</td>
<td style="text-align:right;">
0.89
</td>
<td style="text-align:right;">
1.45
</td>
<td style="text-align:right;">
0.1459
</td>
</tr>
</tbody>
</table>

í‘œë³¸í‰ê·  $$\overline{X}$$ëŠ” $$1.29kg$$ ì´ê³  ëª¨ë¶„ì‚°ì€ ëª¨ë¥´ì§€ë§Œ $$13.4621kg^2$$ ë¡œ ê°€ì •í•˜ì. ê·¸ëŸ¬ë©´ í‘œì¤€ ì˜¤ì°¨ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ê³„ì‚°ëœë‹¤.

$$
\begin{aligned}
\sigma_{\overline{X}} = \sqrt{\frac{\sigma^2}{n}} = \sqrt{\frac{13.4621\ kg^2}{17}}=\sqrt{0.7919\ kg^2}=0.89\ kg
\end{aligned}
$$
  
í‘œì¤€í™”í•œ Z ê°’ì„ êµ¬í•˜ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.
  
$$
\begin{aligned}
Z = \frac{\overline{X} - \mu}{\sigma_{\overline{X}}} = \frac{1.29\ kg - 0}{0.89\ kg}= 1.45
\end{aligned}
$$  
  
ì´ë¥¼ í†µí•´ ìœ ì˜í™•ë¥ ì„ êµ¬í•´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.

$$
\begin{aligned}
P(\overline X \geq 1.29\ kg)= P(Z\geq 1.45)=0.0735
\end{aligned}
$$  
  
ê·¸ë¦¬ê³  Zë¶„í¬ëŠ” 0ì— ëŒ€í•˜ì—¬ ëŒ€ì¹­ì´ê¸° ë•Œë¬¸ì— ë‹¤ìŒë„ ì„±ë¦½í•œë‹¤.
  
$$
\begin{aligned}
P(\overline X \leq -1.29\ kg)= P(Z\leq -1.45)=0.0735
\end{aligned}
$$   
  
ìµœì¢…ì ì¸ ìœ ì˜í™•ë¥ ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.
  
$$
\begin{aligned}
P(\overline X \geq 1.29\ kg\ or\ \overline X \leq -1.29\ kg) &= P(Z\geq 1.45\ or\ Z\leq -1.45)\\
&=0.0735+0.0735=0.1470
\end{aligned}
$$

êµ¬í•´ì§„ $$p\ value$$ ëŠ” 0.1470 ìœ¼ë¡œ ìœ ì˜í™•ë¥  0.05 ë³´ë‹¤ í¬ë¯€ë¡œ ê·€ë¬´ê°€ì„¤ $$H_0$$ ë¥¼ ê¸°ê°ì‹œí‚¤ì§€ ëª»í•œë‹¤. 

ê·¸ëŸ¬ë¯€ë¡œ ë§ë“¤ì˜ ëª¨í‰ê· ì˜ ëª¸ë¬´ê²Œ ë³€í™”ê°€ ìˆë‹¤ê³  í•  ì¶©ë¶„í•œ ê·¼ê±°ê°€ ì—†ë‹¤.

``` r
zz <- descriptives6_4(ex6_4$X)$Z
curve(dt(x,16),-3,3,xlab="z",ylab="Y",yaxt='n',main="Hypothesis in Example 6.4")
polygon(c(zz,seq(zz,3,0.001),zz), 
        c(dt(-3,16),dt(seq(zz,3,0.001),16),dt(-3,16)),col="#007266")
polygon(c(-3,seq(-3,-zz,0.001),-zz), 
        c(dt(-3,16),dt(seq(-3,-zz,0.001),16),dt(-3,16)),col="#007266")
polygon(c(1.96,seq(1.96,3,0.001),1.96),
        c(dt(-3,16),dt(seq(1.96,3,0.001),16),dt(-3,16)),col="#8dd3c7")
polygon(c(-3,seq(-3,-1.96,0.001),-1.96), 
        c(dt(-3,16),dt(seq(-3,-1.96,0.001),16),dt(-3,16)),col="#8dd3c7")
text(x=-2,y=0.1,labels = "-1.96")
text(x=2,y=0.1,labels = "1.96")
text(x=-1.45,y=0.18,labels = "-1.45")
text(x=1.45,y=0.18,labels = "1.45")
```

![](/study/img/ch6//unnamed-chunk-23-1.png) 

### EXAMPLE 6.5

**6.5.1) Hypothetical outcomes of testing the same null hypothesis for 2500 random samples**
  
- **ì œ 1ì¢… ì˜¤ë¥˜ (Type 1 error)** : ê·€ë¬´ê°€ì„¤ì´ ì°¸ì„ì´ì—ë„ ë¶ˆêµ¬í•˜ê³  ì´ë¥¼ ê¸°ê°í•  ì˜¤ë¥˜
  
- **ì œ 2ì¢… ì˜¤ë¥˜ (Type 2 error)** : ê·€ë¬´ê°€ì„¤ì´ ê±°ì§“ì„ì—ë„ ë¶ˆêµ¬í•˜ê³  ì´ë¥¼ ê¸°ê°í•˜ì§€ ëª»í•  ì˜¤ë¥˜  
  
       
|   |If $$H_0$$ is true|If $$H_0$$ is false|Row total|  
|:---|:---|:---|:---|
|**If $$H_0$$ is rejected**|100   |  450 | 550|
|**If $$H_0$$ is not rejected**|1900    |50   |1950|
|**Column total**|2000|500|2500|
    
- Probability that $$H_0$$ is rejected if $$H_0$$ is true $$= 100/2000=0.05$$
  
- Probability that $$H_0$$ is true if $$H_0$$ is rejected $$=100/550=0.18$$
  
  
**6.5.2) Table of the Two types of Errors in Hypothesis Testing**  
  
  
||If $$H_0$$ is true|If $$H_0$$ is false|  
|:---|:---|:---|
|**If $$H_0$$ is rejected**|$$Type\ 1\ Error$$   |  $$No\ Error$$ |
|**If $$H_0$$ is not rejected**|$$No\ Error$$    |$$Type\ 2\ Error$$   |
  
**6.5.3) The Long - Term Probabilities of Outcomes in Hypothesis Testing** 

||If $$H_0$$ is true|If $$H_0$$ is false|  
|:---|:---|:---|
|**If $$H_0$$ is rejected**|$$\alpha$$   |  $$1-\beta\ (Power)$$ |
|**If $$H_0$$ is not rejected**|$$1-\alpha$$    |$$\beta$$   |

### EXAMPLE 6.6

$$\bar{X}=1.29\ kg$$ and $$\sigma_\bar{X}=0.89\ kg$$

$$
\begin{aligned}
(L, U) = (\bar{X} - Z_{\alpha/2} \sigma_{\bar{X}},\ \bar{X} + Z_{\alpha/2} \sigma_{\bar{X}})
\end{aligned}
$$

``` r
descriptives6.6 <- function(x) {
  x.n <- 17
  x.mn <- 1.29
  x.se <- 0.89
  LL <- x.mn-1.96*x.se
  UL <- x.mn+1.96*x.se
  x.total <- c(LL,UL)
  return(x.total)
}

cat("The 95% confidence interval is [",round(descriptives6.6(x)[1],2),",",round(descriptives6.6(x)[2],2),"]")
```

    ## The 95% confidence interval is [ -0.45 , 3.03 ]

Example 6.4 ì—ì„œ $$\mu_0=0$$ ì— ëŒ€í•œ ê²€ì •ì„ í–ˆì—ˆê³  ì´ëŠ” ì‹ ë¢°êµ¬ê°„ì— í¬í•¨ë˜ë¯€ë¡œ $$H_0$$ ë¥¼ ê¸°ê°í•˜ì§€ ëª»í•œë‹¤. 

**ìƒ˜í”Œë§ í•œ ê°’ë“¤ì— ëŒ€í•œ ì‹ ë¢°êµ¬ê°„ ì‹œê°í™”**

ë³¸ ë°ì´í„°ì—ì„œ 100ë²ˆ ìƒ˜í”Œë§í•˜ì—¬ ì´ ê°’ë“¤ì— ëŒ€í•œ ì‹ ë¢°êµ¬ê°„ì„ ì‹œê°í™”í•˜ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.

``` r
ex6.4 <- as.numeric(ex6_4$X)
mean0=mean(ex6.4)
mean0
```

    ## [1] 1.294118

``` r
x1 <- replicate(100,sample(ex6_4$X,17,replace=TRUE))
error.bars(x1, alpha=0.05, xlab="sample", ylab="Mean", col=adjustcolor("#8dd3c7",alpha=0.3), pch=16) # library('psych')
abline(h=mean0)
```

![](/study/img/ch6//unnamed-chunk-25-1.png)

ëŒ€ë¶€ë¶„ì˜ ê°’ë“¤ì´ í‰ê· ì„ í¬ê²Œ ë²—ì–´ë‚˜ì§€ ì•Šì„ ê²ƒì„ ë³´ì´ë©° ì‹ ë¢°êµ¬ê°„ì€ ëŒ€ë¶€ë¶„ í‰ê· ì„ í¬í•¨í•˜ê³ ìˆëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.

### EXAMPLE 6.7

``` r
#ë°ì´í„°ì…‹
ex6_7%>%
  kbl(caption = "EXAMPLE 6.7 dataset") %>%
  kable_minimal() %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```

<table class=" lightable-minimal table table-striped table-hover table-condensed table-responsive" style="font-family: &quot;Trebuchet MS&quot;, verdana, sans-serif; margin-left: auto; margin-right: auto; margin-left: auto; margin-right: auto;">
<caption>
EXAMPLE 6.7 dataset
</caption>
<thead>
<tr>
<th style="text-align:right;">
exam6_7.Height
</th>
<th style="text-align:right;">
exam6_7.Freq
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
63
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
64
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
65
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
66
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:right;">
67
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
68
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:right;">
69
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:right;">
70
</td>
<td style="text-align:right;">
8
</td>
</tr>
<tr>
<td style="text-align:right;">
71
</td>
<td style="text-align:right;">
7
</td>
</tr>
<tr>
<td style="text-align:right;">
72
</td>
<td style="text-align:right;">
7
</td>
</tr>
<tr>
<td style="text-align:right;">
73
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:right;">
74
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:right;">
75
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
76
</td>
<td style="text-align:right;">
2
</td>
</tr>
</tbody>
</table>

ëˆ„ì ë„ìˆ˜ì™€ $$f_i X_i$$, $$f_i {X_i}^2$$ ë¥¼ êµ¬í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ í…Œì´ë¸”ì´ ë‚˜ì˜¨ë‹¤.

``` r
ex6_7$CumFreq <- cumsum(ex6_7$exam6_7.Freq) # ëˆ„ì ë„ìˆ˜
ex6_7$fixi <- ex6_7$exam6_7.Height*ex6_7$exam6_7.Freq # fixi
ex6_7$fixi2<-ex6_7$exam6_7.Height^2*ex6_7$exam6_7.Freq #fixi^2
ex6_7%>%
  kbl(caption = "EXAMPLE 6.7 dataset") %>%
  kable_minimal() %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```

<table class=" lightable-minimal table table-striped table-hover table-condensed table-responsive" style="font-family: &quot;Trebuchet MS&quot;, verdana, sans-serif; margin-left: auto; margin-right: auto; margin-left: auto; margin-right: auto;">
<caption>
EXAMPLE 6.7 dataset
</caption>
<thead>
<tr>
<th style="text-align:right;">
exam6_7.Height
</th>
<th style="text-align:right;">
exam6_7.Freq
</th>
<th style="text-align:right;">
CumFreq
</th>
<th style="text-align:right;">
fixi
</th>
<th style="text-align:right;">
fixi2
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
63
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
126
</td>
<td style="text-align:right;">
7938
</td>
</tr>
<tr>
<td style="text-align:right;">
64
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
128
</td>
<td style="text-align:right;">
8192
</td>
</tr>
<tr>
<td style="text-align:right;">
65
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
195
</td>
<td style="text-align:right;">
12675
</td>
</tr>
<tr>
<td style="text-align:right;">
66
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
330
</td>
<td style="text-align:right;">
21780
</td>
</tr>
<tr>
<td style="text-align:right;">
67
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
268
</td>
<td style="text-align:right;">
17956
</td>
</tr>
<tr>
<td style="text-align:right;">
68
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
408
</td>
<td style="text-align:right;">
27744
</td>
</tr>
<tr>
<td style="text-align:right;">
69
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:right;">
345
</td>
<td style="text-align:right;">
23805
</td>
</tr>
<tr>
<td style="text-align:right;">
70
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
560
</td>
<td style="text-align:right;">
39200
</td>
</tr>
<tr>
<td style="text-align:right;">
71
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
42
</td>
<td style="text-align:right;">
497
</td>
<td style="text-align:right;">
35287
</td>
</tr>
<tr>
<td style="text-align:right;">
72
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
49
</td>
<td style="text-align:right;">
504
</td>
<td style="text-align:right;">
36288
</td>
</tr>
<tr>
<td style="text-align:right;">
73
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
59
</td>
<td style="text-align:right;">
730
</td>
<td style="text-align:right;">
53290
</td>
</tr>
<tr>
<td style="text-align:right;">
74
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
65
</td>
<td style="text-align:right;">
444
</td>
<td style="text-align:right;">
32856
</td>
</tr>
<tr>
<td style="text-align:right;">
75
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
68
</td>
<td style="text-align:right;">
225
</td>
<td style="text-align:right;">
16875
</td>
</tr>
<tr>
<td style="text-align:right;">
76
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:right;">
152
</td>
<td style="text-align:right;">
11552
</td>
</tr>
</tbody>
</table>

Sum of square($$SS$$) ì™€ $$s^2$$ì„ êµ¬í•˜ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.

``` r
ss <- sum(ex6_7$fixi2)-(sum(ex6_7$fixi)^2/sum(ex6_7$exam6_7.Freq))
s2 <- round(ss/(sum(ex6_7$exam6_7.Freq)-1),4)
cat("SS = ",ss,", s2 = ",s2)
```

    ## SS =  755.9429 , s2 =  10.9557

**ì •ê·œì„±ê²€ì • (Normality Test)**

``` r
hist(rnorm(500,70.17143,sqrt(13.4621)),prob=T,col="white",border='white',axes=F,xlab = "",ylab="",main="The Frequency polygon for the student height data")
lines(density(rnorm(500,70.17143,sqrt(13.4621))), lty=2, lwd=2, col="#8F0185")
par(new=T)
plot(ex6_7$exam6_7.Height,ex6_7$exam6_7.Freq, ylim = c(0,10), xlim=c(62,78), col="#8dd3c7", type="l", lwd=3, xlab = "Height in inches(Xi)",ylab='Frequency', xaxt='n')
axis(1,at=c(62,64,66,68,70,72,74,76,78))
text(x=63.2, y=9, label="Mint", col="#8dd3c7", cex=0.8) ; text(x=63.2, y=8.5, label="puple", col="#8F0185", cex=0.8)
text(x=64.2, y=9, label=": Observed Frequencies", cex=0.8)
text(x=64.2, y=8.5, label=": Expected Frequencies", cex=0.8)
```

![](/study/img/ch6//unnamed-chunk-28-1.png)

ìš°ë¦¬ëŠ” í•´ë‹¹ ë°ì´í„°ê°€ ì •ê·œë¶„í¬ë¥¼ ë”°ë¥´ëŠ”ì§€ ê²€ì •ì„ í•˜ê¸° ìœ„í•´ ë‹¤ìŒì˜ ë°©ë²•ë“¤ì„ ì‚¬ìš©í•´ë³´ë ¤ê³  í•œë‹¤.
    
- **a) Graphical Assessment of Normality**
      
- **a-1) cumulative frequency polygon**  
  
ë‹¤ìŒ ê·¸ë˜í”„ëŠ” ëˆ„ì ë¹ˆë„ë¥¼ ê·¸ë˜í”„ë¡œ ê·¸ë¦° ê²ƒì´ë‹¤.

``` r
cc <- ex6_7$CumFreq # ëˆ„ì ë„ìˆ˜ 
scc <- sum(ex6_7$exam6_7.Freq) ; ccc <-cc/scc ; ccc <- round(ccc,2)
par(mar = c(5, 4, 4, 4)+0.1)
plot.new()
plot(x=ex6_7$exam6_7.Height, y=ccc,type='b', xlab="X in inches",ylab="Cumulative Frequency", yaxt="n", frame=F, ylim=c(0,1.1), cex.axis = 1, cex.lab=1, main="The Cummulative Frequency Polygon of the student height data", col="#8dd3c7")
points(x=ex6_7$exam6_7.Height, ccc, pch=16, col="#007266")
axis(side=4, at=round(ccc,2), las=2, lwd = 1, cex.axis=0.8)
par(new = TRUE)
plot(cc,xlab="", ylab="", main="", xaxt="n", yaxt='n', frame=F, ylim=c(0,70), col=adjustcolor("white",alpha=0), cex.axis = 1, cex.lab=1)
axis(2, cex.axis=1)
mtext("Cumulative Relative Frequency", side=4, line=3, cex = 1)
```

![](/study/img/ch6//unnamed-chunk-29-1.png)

ê·¸ë˜í”„ë¥¼ ì‚´í´ë³´ë©´ S ëª¨ì–‘ í˜•íƒœì˜ sigmoid ëª¨ì–‘ì„ ë„ê³  ìˆëŠ”ë° ì´ í˜•íƒœë§Œ ê°€ì§€ê³  ì •ê·œì„±ì„ ê²€ì •í•˜ê¸°ì—ëŠ” ì–´ë ¤ì›€ì´ ìˆë‹¤. 

``` r
ccc1 <- ccc*100
plot(x=ex6_7$exam6_7.Height,y=ccc1,xlab="X in inches",ylab="Cumulative Frequency in Percent",yaxt='n',frame=F,ylim=c(0,100),cex.axis = 1,cex.lab=1,main="The Cummulative Relative Frequency Distribution of the student height data", col="#8dd3c7")
points(x=ex6_7$exam6_7.Height, ccc1, pch=16, col="#007266")
axis(side=2,at=round(ccc1,2),las=2,lwd = 1,cex.axis=0.8)
lines(x=seq(62,78,length=100),y=seq(0,100,length=100))
```

![](/study/img/ch6//unnamed-chunk-30-1.png)

- **a-2) Q-Q plot** 
  
Q-Q plotì€ ì´ë¡ ì  ë¶„ìœ„ìˆ˜ì™€ ê²½í—˜ì  ë¶„ìœ„ìˆ˜ë¥¼ ì´ìš©í•œ í”Œë¡¯ìœ¼ë¡œ ê·¸ë˜í”„ì˜ ì„ ì´ $$y=x$$ë¥¼ ë”°ë¥´ë©´ ì •ê·œì„±ì„ ë”°ë¥¸ë‹¤ê³  í•œë‹¤.

``` r
qqnorm(ex6_7$exam6_7.Height,col="#8dd3c7", pch=16, lwd = 2) ; qqline(ex6_7$exam6_7.Height,col="#007266", lwd = 2)
```

![](/study/img/ch6//unnamed-chunk-30-2.png)

- **a-3) P-P plot**
  
P-P plotì€ ìˆœì„œí™”ëœ ë°ì´í„°ê°’ê¹Œì§€ì˜ ê²½í—˜ì  ëˆ„ì  í™•ë¥ ê³¼ ì´ë¡ ì  ëˆ„ì í™•ë¥ ì„ ì´ìš©í•œ í”Œë¡¯ì´ë‹¤.
  
x ì¶•ì—ëŠ” ì˜¤ë¦„ì°¨ìˆœìœ¼ë¡œ ì •ë ¬ëœ ë°ì´í„° $$x_{(i)}$$ ì— ëŒ€ì‘ë˜ëŠ” í‘œë³¸ì—ì„œì˜ ëˆ„ì í™•ë¥  $p_i$ ì„ ê³„ì‚°í•œë‹¤. ê³„ì‚°ì‹ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.
  
$$
\begin{aligned}
p_i = \frac{i-0.5}{n}
\end{aligned}
$$
  
y ì¶•ì—ëŠ” $$x-{(i)}$$ì— ëŒ€ì‘ë˜ëŠ” ì´ë¡ ì ì¸ ì •ê·œë¶„í¬ì—ì„œì˜ ëˆ„ì í™•ë¥¼ $$\Phi_{(x_{(i)})}$$ ë¥¼ ê³„ì‚°í•œë‹¤.
  
ì´ë¥¼ ê·¸ë ¤ë³´ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.

``` r
for(i in 1:nrow(ex6_7)){
  ex6_7$cc[i]<- (i-0.5)/length(ex6_7$exam6_7.Height)
}

ex6_7$cc <- round(ex6_7$cc*100,2)
nuj <- pnorm(ex6_7$exam6_7.Height,70.17143,sqrt(13.4621))
plot(x=nuj,y=ex6_7$cc,xlab="X in inches",ylab="Cumulative Frequency in Percent",xaxt='n',yaxt='n',frame=F,ylim=c(0,100),cex.axis = 1,cex.lab=1,main="P-P plot", col="#8dd3c7")
points(x=nuj,ex6_7$cc,pch=16, col="#8dd3c7")
axis(side=1,at=nuj,label=c("63","64","65","66","67","68","69","70","71","72","73","74","75","76"),lwd = 1,cex.axis=0.5)
axis(side=2,at=ex6_7$cc,las=2,lwd = 1,cex.axis=0.8)
lines(x=seq(0,1,length=100),y=seq(0,100,length=100), col="#007266", lwd = 2)
```

![](/study/img/ch6//unnamed-chunk-31-1.png)

ê·¸ëŸ¬ë‚˜ ê·¸ë˜í”„ë¥¼ ì‚¬ìš©í•œ ê²°ê³¼ë§Œìœ¼ë¡œ ì •ê·œì„±ì„ íŒë‹¨í•˜ê¸°ëŠ” ì–´ë µë‹¤.

- **b) Assessing Normality Using Symmetry and Kurtosis Measures**
  
ì™œë„ëŠ” í‰ê· ì— ëŒ€í•œ ë¶„í¬ì˜ ë¹„ëŒ€ì¹­ ì •ë„ë¡œ 0.5ë³´ë‹¤ í¬ë©´ ì˜¤ë¥¸ìª½ìœ¼ë¡œ ê¸´ í˜•íƒœì´ê³  -0.5ë³´ë‹¤ ì‘ìœ¼ë©´ ì™¼ìª½ìœ¼ë¡œ ê¼¬ë¦¬ê°€ ê¸´ í˜•íƒœë¡œ ë¶„í¬ë˜ì–´ìˆë‹¤.
  
-0.5 < ì™œë„ < 0.5 ì‚¬ì´ ê°’ì´ë©´ ëŒ€ì¹­ì ì´ë‹¤.
  
ì²¨ë„ëŠ” ë¶„í¬ì˜ ë¾°ì¡±í•œ ì •ë„ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì§€í‘œë¡œ ì •ê·œë¶„í¬ë¥¼ ë”°ë¥¼ ê²½ìš° ì²¨ë„ëŠ” 3ì´ë‹¤. 3ë³´ë‹¤ í¬ë©´ ë§ì´ ë¾°ì¡±í•˜ë©° 3ë³´ë‹¤ ì‘ìœ¼ë©´ ì™„ë§Œí•œ í˜•íƒœë¥¼ ëˆë‹¤.

``` r
library('moments')
skew <- skewness(ex6_7$exam6_7.Height) # ì™œë„
kur <- kurtosis(ex6_7$exam6_7.Height) # ì²¨ë„
cat("ì™œë„ = ",skew,", ì²¨ë„ = ",kur)
```

    ## ì™œë„ =  0 , ì²¨ë„ =  1.787692

ì™œë„ëŠ” 0 ìœ¼ë¡œ ëŒ€ì¹­ì¸ ë¶„í¬ë¼ í•  ìˆ˜ ìˆìœ¼ë©° ì²¨ë„ëŠ” 1.787692ë¡œ ì •ê·œë¶„í¬ë³´ë‹¤ëŠ” ì™„ë§Œí•œ í˜•íƒœë¥¼ ê°€ì§€ê³  ìˆìŒì„ ì•Œ ìˆ˜ ìˆë‹¤.  

- **c) Goodness-of-Fit Assessment of Normality**  

ì •ê·œì„±ì„ ê²€ì •í•˜ëŠ” ë°©ë²•ìœ¼ë¡œëŠ” ì í•©ë„ ê²€ì‚¬(Goodness-of-fit) ë¥¼ í•  ìˆ˜ ìˆëŠ”ë° ë°©ë²•ì˜ ìˆ˜ëŠ” ì—¬ëŸ¬ê°€ì§€ë¡œ ë§ë‹¤. 

ê·¸ ì¤‘ 6ê°œ ì •ë„ë¥¼ ë³´ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.    
  
- **c-1) Anderson-Darling test**
``` r
library(nortest)
ad.test(ex6_7$exam6_7.Height)
```

    ## 
    ##  Anderson-Darling normality test
    ## 
    ## data:  ex6_7$exam6_7.Height
    ## A = 0.16777, p-value = 0.9185

- **c-2) Cramer-von Mises test**    
``` r
cvm.test(ex6_7$exam6_7.Height)
```

    ## 
    ##  Cramer-von Mises normality test
    ## 
    ## data:  ex6_7$exam6_7.Height
    ## W = 0.021766, p-value = 0.9419

- **c-3) Lilliefors test (Based on Kolmogorov-Smirnov test)**       
``` r
lillie.test(ex6_7$exam6_7.Height)
```

    ## 
    ##  Lilliefors (Kolmogorov-Smirnov) normality test
    ## 
    ## data:  ex6_7$exam6_7.Height
    ## D = 0.084322, p-value = 0.9971

- **c-4) Shapiro-Francia test**
``` r
sf.test(ex6_7$exam6_7.Height)
```

    ## 
    ##  Shapiro-Francia normality test
    ## 
    ## data:  ex6_7$exam6_7.Height
    ## W = 0.98186, p-value = 0.9579

- **c-5) Shapiro-Wilk Normality test**
``` r
shapiro.test(ex6_7$exam6_7.Height)
```

    ## 
    ##  Shapiro-Wilk normality test
    ## 
    ## data:  ex6_7$exam6_7.Height
    ## W = 0.96453, p-value = 0.7964

- **c-6) Jarque-Bera test**
``` r
library('tseries')
jarque.bera.test(ex6_7$exam6_7.Height)
```

    ## 
    ##  Jarque Bera Test
    ## 
    ## data:  ex6_7$exam6_7.Height
    ## X-squared = 0.85732, df = 2, p-value = 0.6514

ìœ„ì˜ ê²€ì •ë°©ë²•ì˜ ê²°ê³¼ë¥¼ ì •ë¦¬í•˜ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.

``` r
cat(" P value of Anderson-Darling test       : ",ad.test(ex6_7$exam6_7.Height)$p,"\n",
    "P value of Cramer-von Mises test       : ",cvm.test(ex6_7$exam6_7.Height)$p,"\n",
    "P value of Lilliefors test             : ",lillie.test(ex6_7$exam6_7.Height)$p,"\n",
    "P value of Shapiro-Francia test        : ",sf.test(ex6_7$exam6_7.Height)$p,"\n",
    "P value of Shapiro-Wilk Normality test : ",shapiro.test(ex6_7$exam6_7.Height)$p,"\n",
    "p value of Jarque-Bera test            : ",jarque.bera.test(ex6_7$exam6_7.Height)$p.value)
```

    ##  P value of Anderson-Darling test       :  0.9185035 
    ##  P value of Cramer-von Mises test       :  0.9418611 
    ##  P value of Lilliefors test             :  0.9970992 
    ##  P value of Shapiro-Francia test        :  0.9579486 
    ##  P value of Shapiro-Wilk Normality test :  0.7964376 
    ##  p value of Jarque-Bera test            :  0.6513816

|Goodness-of-Fit|P value|  
|:-----|:-----|
| Anderson-Darling test | 0.9185  |
| Cramer-von Mises test| 0.9419|
| Lilliefors test | 0.9971|
| Shapiro-Francia test |  0.9579|
| Shapiro-Wilk Normality test | 0.7964 |
| Jarque-Bera test |0.6514  |

    
ì í•©ë„ ê²€ì •ì— ëŒ€í•œ ê°€ì„¤ ì„¤ì •ì€ ë‹¤ìŒê³¼ ê°™ë‹¤. 
  
$$
\begin{aligned}
H_0 &: Follow\ Normal\ Distribution\\
H_1 &: Not\ H_0
\end{aligned}
$$
  
  ì í•©ë„ ê²€ì •ì— ëŒ€í•œ ê²°ê³¼ë¥¼ ë³´ë©´ ëª¨ë‘ p valueê°€ ìœ ì˜ìˆ˜ì¤€ 0.05ë³´ë‹¤ í¬ë¯€ë¡œ ê·€ë¬´ê°€ì„¤ $$H_0$$ ë¥¼ ê¸°ê°í•  ìˆ˜ ì—†ë‹¤. 
  
  ê·¸ëŸ¬ë¯€ë¡œ í•´ë‹¹ ë°ì´í„°ëŠ” ì •ê·œë¶„í¬ë¥¼ ë”°ë¥¸ë‹¤ê³  í•  ìˆ˜ ìˆë‹¤.

</div>
</details>

<br/>

# SAS í”„ë¡œê·¸ë¨ ê²°ê³¼

<details>
<summary>
SAS ì ‘ê¸°/í¼ì¹˜ê¸° ë²„íŠ¼
</summary>
<div markdown="1">

```python
import saspy #SASì¶œë ¥ ì½”ë“œ
```

winlocal ì…ë ¥

## 6ì¥

</div>
</details>

<br/>

<br/>

<font color='#fb8072'>êµì¬: Biostatistical Analysis (5th Edition) by Jerrold H. Zar</font><br/>

<font color='#fb8072'> **ì´ ê¸€ì€ 22í•™ë…„ë„ 1í•™ê¸° ì˜í•™í†µê³„ë°©ë²•ë¡  ê³¼ì œ ìë£Œë“¤ì„ ì •ë¦¬í•œ ê¸€ ì…ë‹ˆë‹¤.** </font>