---
layout: post
title:  "[ì˜í•™í†µê³„ë°©ë²•ë¡ ] Ch8. Two-Sample Hypotheses"
category: Study
tag: [R, SAS, blog, jekyll, Jupyter, Data, Python]
toc: true
---
* this unordered seed list will be replaced by the toc
{:toc}

- ë’¤ë¡œê°€ê¸°ë¥¼ ëˆ„ë¥´ì‹œë©´ ëª©ì°¨ë¡œ ë˜ëŒì•„ì˜µë‹ˆë‹¤. ğŸ˜‰

# Two-Sample Hypotheses

# R í”„ë¡œê·¸ë¨ ê²°ê³¼

<details>
<summary>
R ì ‘ê¸°/í¼ì¹˜ê¸° ë²„íŠ¼
</summary>
<div markdown="1">

**íŒ¨í‚¤ì§€**
<details>
<summary>
ì„¤ì¹˜ëœ íŒ¨í‚¤ì§€ ì ‘ê¸°/í¼ì¹˜ê¸° ë²„íŠ¼
</summary>

<div markdown="1">

``` r
getwd()
```

    ## [1] "C:/Biostat"

``` r
library('readxl')
library('ggplot2')
library('dplyr')
library('kableExtra')
```

</div>
</details>

``` r
library(readxl)
library(dplyr)
library(asht)
library(lawstat) 
library(kableExtra)
library(qpcR)   
library(RVAideMemoire)
library(vegan)
```

**ì—‘ì…€íŒŒì¼ë¶ˆëŸ¬ì˜¤ê¸°**

``` r
#ëª¨ë“  ì‹œíŠ¸ë¥¼ í•˜ë‚˜ì˜ ë¦¬ìŠ¤íŠ¸ë¡œ ë¶ˆëŸ¬ì˜¤ëŠ” í•¨ìˆ˜
read_excel_allsheets <- function(file, tibble = FALSE) {
  sheets <- readxl::excel_sheets(file)
  x <- lapply(sheets, function(X) readxl::read_excel(file, sheet = X))
  if(!tibble) x <- lapply(x, as.data.frame)
  names(x) <- sheets
  x
}
```

## 8ì¥

**8ì¥ ì—°ìŠµë¬¸ì œ ë¶ˆëŸ¬ì˜¤ê¸°**

``` r
#data_chap08ì— ì—°ìŠµë¬¸ì œ 8ì¥ ëª¨ë“  ë¬¸ì œ ì €ì¥
data_chap08 <- read_excel_allsheets("data_chap08.xls")

#ì—°ìŠµë¬¸ì œ ê°ê° ë°ì´í„° ìƒì„±
for (x in 1:length(data_chap08)){
  assign(paste0('ex8_',c(1:2,'2a',7:8,10:11))[x],data_chap08[x])
  }

#ì—°ìŠµë¬¸ì œ ë°ì´í„° í˜•ì‹ì„ ë¦¬ìŠ¤íŠ¸ì—ì„œ ë°ì´í„°í”„ë ˆì„ìœ¼ë¡œ ë³€í™˜
for (x in 1:length(data_chap08)){
  assign(paste0('ex8_',c(1:2,'2a',7:8,10:11))[x],data.frame(data_chap08[x]))
  }
```

## EXAMPLE 8.1

![](/study/img/ch8/8-1.png)

``` r
#ë°ì´í„°ì…‹
ex8_1%>%
  kbl(caption = "Dataset",escape=F) %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
Dataset
</caption>
<thead>
<tr>
<th style="text-align:left;">
exam8_1.drug
</th>
<th style="text-align:right;">
exam8_1.time
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
8.8
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
8.4
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
7.9
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
8.7
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
9.1
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
9.6
</td>
</tr>
<tr>
<td style="text-align:left;">
C
</td>
<td style="text-align:right;">
9.9
</td>
</tr>
<tr>
<td style="text-align:left;">
C
</td>
<td style="text-align:right;">
9.0
</td>
</tr>
<tr>
<td style="text-align:left;">
C
</td>
<td style="text-align:right;">
11.1
</td>
</tr>
<tr>
<td style="text-align:left;">
C
</td>
<td style="text-align:right;">
9.6
</td>
</tr>
<tr>
<td style="text-align:left;">
C
</td>
<td style="text-align:right;">
8.7
</td>
</tr>
<tr>
<td style="text-align:left;">
C
</td>
<td style="text-align:right;">
10.4
</td>
</tr>
<tr>
<td style="text-align:left;">
C
</td>
<td style="text-align:right;">
9.5
</td>
</tr>
</tbody>
</table>

- ì•½ë¬¼ Bë¥¼ íˆ¬ì—¬í–ˆì„ ë•Œ ëª¨ë“  ì„±ì²´ ìˆ˜ì»· í† ë¼ì˜ í˜ˆì•¡ ì‘ê³  ì‹œê°„ í‰ê· ì´ ì•½ë¬¼ Gë¥¼ íˆ¬ì—¬í–ˆì„ ë•Œ ëª¨ë“  ì„±ì²´ ìˆ˜ì»· í† ë¼ì˜ í˜ˆì•¡ ì‘ê³  ì‹œê°„ í‰ê· ì´ ë‹¤ë¥¸ì§€ ê²€ì •í•˜ê³ ì í•œë‹¤.

$$
\begin{aligned}
H_0 &: \mu_1 = \mu_2 \\
H_1 &: \mu_1 \not=\ \mu_2
\end{aligned}
$$

- ì„±ì²´ ìˆ˜ì»· í† ë¼6ë§ˆë¦¬ì—ê²Œ ì•½ë¬¼ Bë¥¼ íˆ¬ì—¬í•˜ì˜€ìœ¼ë©°, ë‹¤ë¥¸ ì„±ì²´ ìˆ˜ì»· í† ë¼7ë§ˆë¦¬ì—ê²Œ ì¶”ì¶œí•˜ì—¬ ë‘ê°œì˜ í‘œë³¸ì€ ë…ë¦½ì ì´ê²Œ ì¶”ì¶œí•˜ì˜€ë‹¤.<br/><br/>
- ì´í‘œë³¸ t-ê²€ì •ì„ í•˜ê¸° ì „ì— ë‘ê°œì˜ í‘œë³¸ë¶„í¬ì˜ ì •ê·œì„±ì„ ê°ê° ë³´ì—¬ì•¼í•˜ê³  ë‘ ê·¸ë£¹ ë¶„í¬ê°„ ë¶„ì‚°ì´ ê°™ì€ì§€ ë“±ë¶„ì‚°ì„± ê°€ì •ì„ í™•ì¸í•´ì¤˜ì•¼ í•œë‹¤.<br/>
- ì •ê·œì„± ê²€ì •ì€ P-P plotê³¼ Q-Q plotìœ¼ë¡œë„ ì •ê·œì„±ì„ í™•ì¸ í•  ìˆ˜ ìˆì§€ë§Œ ê·¸ë˜í”„ë¡œ í™•ì¸í•˜ëŠ” ì •ê·œì„± ê²€ì •ì€ ê¸°ì¤€ì´ ëª¨í˜¸í•˜ê¸° ë•Œë¬¸ì— í•œê³„ê°€ ìˆë‹¤.<br/>
- ë”°ë¼ì„œ ì •ê·œì„±ì— ëŒ€í•œ ê¸°íƒ€ í‰ê°€ ë°©ë²•ë“¤ì„ ì‚¬ìš©í•  ê²ƒì¸ë° í‘œë³¸ì˜ í¬ê¸°ê°€ ì‘ìœ¼ë¯€ë¡œ Shapiro-Wilk testë¥¼ ì‚¬ìš©í•  ê²ƒì´ë‹¤.<br/> (í‘œë³¸í¬ê¸°ê°€ ë§¤ìš° ì‘ìœ¼ë¯€ë¡œ ì›¬ë§Œí•´ì„  ì •ê·œì„±ì´ ìˆëŠ” ê²ƒì²˜ëŸ¼ ë‚˜ì˜¬ ê²ƒì´ë‹¤.)

``` r
##ì •ê·œì„±,ë“±ë¶„ì‚°ì„± ê²€ì •
test <- function(x,y) {
  norm1 = shapiro.test(x)$p.value
  norm2 = shapiro.test(y)$p.value
  equal.var = var.test(x,y)$p.value 
  summary <- list('ê·¸ë£¹B ìƒ¤í”¼ë¡œìœŒí¬ p-value'=norm1, 'ê·¸ë£¹G ìƒ¤í”¼ë¡œìœŒí¬ p-value'=norm2, 'ê·¸ë£¹B,ê·¸ë£¹G ë“±ë¶„ì‚°ì„±ê²€ì • p-value'=equal.var)
  return(summary)
}

group_B <- ex8_1 %>% filter(exam8_1.drug=='B') 
group_G <- ex8_1 %>% filter(exam8_1.drug=='C')
test(group_B$exam8_1.time,group_G$exam8_1.time)
```

    ## $`ê·¸ë£¹B ìƒ¤í”¼ë¡œìœŒí¬ p-value`
    ## [1] 0.9973428
    ## 
    ## $`ê·¸ë£¹G ìƒ¤í”¼ë¡œìœŒí¬ p-value`
    ## [1] 0.9132339
    ## 
    ## $`ê·¸ë£¹B,ê·¸ë£¹G ë“±ë¶„ì‚°ì„±ê²€ì • p-value`
    ## [1] 0.4721646

- ì •ê·œì„± ê²€ì •ì€ shapiro.testë¥¼ í†µí•˜ì—¬ êµ¬í•  ìˆ˜ ìˆë‹¤.<br/>
- p-valueê°€ ì •í•´ë‘” ìœ ì˜ìˆ˜ì¤€ 0.05ë³´ë‹¤ í¬ë‹¤ë©´ ìœ ì˜ìˆ˜ì¤€ 5%í•˜ì— â€œë¶„í¬ê°€ ì •ê·œì„±ì„ ë”°ë¥¸ë‹¤â€ëŠ” ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•  ìˆ˜ ì—†ë‹¤.<br/>
- ì¦‰, p-valueê°€ ê°ê° 0.997, 0.913 ì´ë¯€ë¡œ ìœ ì˜ìˆ˜ì¤€ 0.05ë³´ë‹¤ í¬ë¯€ë¡œ ìœ ì˜ìˆ˜ì¤€ 5%í•˜ì— ë‘ ì§‘ë‹¨ ëª¨ë‘ ì •ê·œì„±ì„ ë”°ë¥´ì§€ ì•ŠëŠ”ë‹¤ê³  í•  ì¶©ë¶„í•œ ì¦ê±°ê°€ ì—†ë‹¤.<br/><br/>
- ë“±ë¶„ì‚°ì„± ê²€ì •ì€ var.test (F Test to Compare Two Variances Performs an F test to compare the variances of two samples from normal populations.) ë¡œ í™•ì¸í•  ìˆ˜ ìˆìœ¼ë©° p-valueê°€ ì •í•´ë‘” ìœ ì˜ìˆ˜ì¤€ 0.05ë³´ë‹¤ í¬ë‹¤ë©´ ìœ ì˜ìˆ˜ì¤€ 5%í•˜ì— â€œë‘ ì§‘ë‹¨ì˜ ë¶„ì‚°ì€ ë“±ë¶„ì‚°ì´ë‹¤â€ë¼ëŠ” ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•  ìˆ˜ ì—†ë‹¤.<br/>
- ë”°ë¼ì„œ p-valueê°€ 0.472ë¡œ ìœ ì˜ìˆ˜ì¤€ 0.05ë³´ë‹¤ í¬ë¯€ë¡œ ìœ ì˜ìˆ˜ì¤€ 5%í•˜ì— â€œë‘ ì§‘ë‹¨ì˜ ëª¨ë¶„ì‚°ì€ ë“±ë¶„ì‚°ì´ ì•„ë‹ˆë‹¤â€ë¼ê³  í•  ì¶©ë¶„í•œ ê·¼ê±°ê°€ ì—†ë‹¤.

> ë‹¤ìŒì€ R ë‚´ì¥ í•¨ìˆ˜ë¡œ êµ¬í•œ t-valueì´ë‹¤.

``` r
t.test(group_B$exam8_1.time,group_G$exam8_1.time,var.equal = T)
```

    ## 
    ##  Two Sample t-test
    ## 
    ## data:  group_B$exam8_1.time and group_G$exam8_1.time
    ## t = -2.4765, df = 11, p-value = 0.03076
    ## alternative hypothesis: true difference in means is not equal to 0
    ## 95 percent confidence interval:
    ##  -1.8752609 -0.1104534
    ## sample estimates:
    ## mean of x mean of y 
    ##  8.750000  9.742857

> ì§ì ‘ í•¨ìˆ˜ë¥¼ ì‘ì„±í•´ì„œ êµ¬í•˜ì—¬ ë³´ì.

``` r
two_tailed_t_test <- function(x,y){
  n1 <- length(na.omit(x))
  n2 <- length(na.omit(y))
  v1 <- n1-1
  v2 <- n2-1
  xbar1 <- mean(x)
  xbar2 <- mean(y)
  ss1 <- var(x)*v1
  ss2 <- var(y)*v2
  sp2 <- (ss1+ss2)/(v1+v2)
  s_xbar1_xbar2 <- sqrt((sp2/n1)+(sp2/n2))
  t <- (xbar1-xbar2)/s_xbar1_xbar2
  pvalue <- 2*pt(t,v1+v2)
  out <- data.frame(n1,n2,v1,v2,xbar1,xbar2=round(xbar2,2),ss1,ss2=round(ss2,4),sp2=round(sp2,4),s_xbar1_xbar2=round(s_xbar1_xbar2,2),t=round(t,3),pvalue=round(pvalue,3))
  return(out)
}

two_tailed_t_test(group_B$exam8_1.time,group_G$exam8_1.time)
```

    ##   n1 n2 v1 v2 xbar1 xbar2   ss1    ss2    sp2 s_xbar1_xbar2      t pvalue
    ## 1  6  7  5  6  8.75  9.74 1.695 4.0171 0.5193           0.4 -2.476  0.031

- ì„±ì²´ ìˆ˜ì»· í† ë¼ì—ê²Œ ì„œë¡œ ë‹¤ë¥¸ ì•½ë¬¼ì„ íˆ¬ì—¬í•˜ì˜€ì„ ë•Œ, ë‘ ì•½ë¬¼ì˜ í˜ˆì•¡ ì‘ê³  ì‹œê°„ì— ëŒ€í•œ í‰ê· ì˜ ì°¨ì´ë¥¼ ë…ë¦½ ì´í‘œë³¸ t-ê²€ì ì„ í†µí•´ í™•ì¸í•´ ë³´ì.<br/>
- ì¶”ì¶œëœ í‘œë³¸ìœ¼ë¡œ ê³„ì‚°í•œ í†µê³„ëŸ‰ $$ \bar{X}_B=8.75 \min \,\ \bar{X}_G=9.74 \min$$<br/>
- ë‘ í‘œë³¸ì˜ ë“±ë¶„ì‚°ì„±ì„ ê°€ì •í•˜ì˜€ìœ¼ë¯€ë¡œ í•©ë™ë¶„ì‚° $$S^2_p=0.5193$$<br/>
- t-ê°’ì€ -2.475ì´ê³  ì–‘ì¸¡ ì„ê³„ê°’ì€ 2.201ìœ¼ë¡œ ì¢Œì¸¡ ì„ê³„ê°’ì¸ -2.201ë³´ë‹¤ t-ê°’ì´ ì‘ìœ¼ë¯€ë¡œ ê¸°ê°ì—­ì— í¬í•¨ë˜ì–´ ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•  ìˆ˜ ìˆë‹¤.<br/>
- ë”°ë¼ì„œ ìœ ì˜ìˆ˜ì¤€ 5%í•˜ì— ë‘ ì•½ë¬¼ì²˜ë¦¬(Bì™€G)ì— ë”°ë¥¸ ëª¨ë“  ì„±ì²´ ìˆ˜ì»·í† ë¼ì˜ í˜ˆì•¡ ì‘ê³  ì‹œê°„ì€ ë‹¤ë¥´ë‹¤ê³  í•  ìˆ˜ ìˆë‹¤. 

## EXAMPLE 8.2

![](/study/img/ch8/8-2.png)
![](/study/img/ch8/8-2-1.png)

``` r
#ë°ì´í„°ì…‹
ex8_2%>%
  kbl(caption = "Dataset",escape=F) %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
Dataset
</caption>
<thead>
<tr>
<th style="text-align:left;">
exam8_2.fertilizer
</th>
<th style="text-align:right;">
exam8_2.height
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
present
</td>
<td style="text-align:right;">
48.2
</td>
</tr>
<tr>
<td style="text-align:left;">
present
</td>
<td style="text-align:right;">
54.6
</td>
</tr>
<tr>
<td style="text-align:left;">
present
</td>
<td style="text-align:right;">
58.3
</td>
</tr>
<tr>
<td style="text-align:left;">
present
</td>
<td style="text-align:right;">
47.8
</td>
</tr>
<tr>
<td style="text-align:left;">
present
</td>
<td style="text-align:right;">
51.4
</td>
</tr>
<tr>
<td style="text-align:left;">
present
</td>
<td style="text-align:right;">
52.0
</td>
</tr>
<tr>
<td style="text-align:left;">
present
</td>
<td style="text-align:right;">
55.2
</td>
</tr>
<tr>
<td style="text-align:left;">
present
</td>
<td style="text-align:right;">
49.1
</td>
</tr>
<tr>
<td style="text-align:left;">
present
</td>
<td style="text-align:right;">
49.9
</td>
</tr>
<tr>
<td style="text-align:left;">
present
</td>
<td style="text-align:right;">
52.6
</td>
</tr>
<tr>
<td style="text-align:left;">
newer
</td>
<td style="text-align:right;">
52.3
</td>
</tr>
<tr>
<td style="text-align:left;">
newer
</td>
<td style="text-align:right;">
57.4
</td>
</tr>
<tr>
<td style="text-align:left;">
newer
</td>
<td style="text-align:right;">
55.6
</td>
</tr>
<tr>
<td style="text-align:left;">
newer
</td>
<td style="text-align:right;">
53.2
</td>
</tr>
<tr>
<td style="text-align:left;">
newer
</td>
<td style="text-align:right;">
61.3
</td>
</tr>
<tr>
<td style="text-align:left;">
newer
</td>
<td style="text-align:right;">
58.0
</td>
</tr>
<tr>
<td style="text-align:left;">
newer
</td>
<td style="text-align:right;">
59.8
</td>
</tr>
<tr>
<td style="text-align:left;">
newer
</td>
<td style="text-align:right;">
54.8
</td>
</tr>
</tbody>
</table>

- ì‹ë¬¼ì˜ ê¸¸ì´ê°€ ìƒˆë¡œìš´ ë¹„ë£Œë¥¼ ì¤¬ì„ ë•Œ ê¸°ì¡´ ë¹„ë£Œë¥¼ ì¤¬ì„ ë•Œë³´ë‹¤ í‰ê· ì´ í°ì§€ ê²€ì •í•˜ê³ ì í•œë‹¤.

$$
\begin{aligned}
H_0 &: \mu_1 \geq \mu_2 \\
H_1 &: \mu_1 < \ \mu_2
\end{aligned}
$$

- ê¸°ì¡´ ë¹„ë£Œë¥¼ 10ê°œ ì‹ë¬¼ì—ê²Œ ìƒˆë¡œìš´ ë¹„ë£Œë¥¼ 8ê°œ ì‹ë¬¼ì—ê²Œ ì¤¬ìœ¼ë©° ê¸°ì¡´ ë¹„ë£Œ ê·¸ë£¹ê³¼ ìƒˆë¡œìš´ ë¹„ë£Œ ê·¸ë£¹ ë‘ê°œì˜ í‘œë³¸ì€ ë…ë¦½ì ì´ê²Œ ì¶”ì¶œí•˜ì˜€ë‹¤.

``` r
##ì •ê·œì„±,ë“±ë¶„ì‚°ì„± ê²€ì •
test <- function(x,y) {
  norm1 = shapiro.test(x)$p.value
  norm2 = shapiro.test(y)$p.value
  equal.var = var.test(x,y)$p.value 
  summary <- list('Present Shapiro-Wilk p-value'=norm1, 'Newer Shapiro-Wilk p-value'=norm2, 'Present,Newer ë“±ë¶„ì‚°ì„±ê²€ì • p-value'=equal.var)
  return(summary)
}
group_pre <- ex8_2 %>% filter(exam8_2.fertilizer=='present')
group_new <- ex8_2 %>% filter(exam8_2.fertilizer=='newer')
test(group_pre$exam8_2.height,group_new$exam8_2.height)
```

    ## $`Present Shapiro-Wilk p-value`
    ## [1] 0.6832982
    ## 
    ## $`Newer Shapiro-Wilk p-value`
    ## [1] 0.9021483
    ## 
    ## $`Present,Newer ë“±ë¶„ì‚°ì„±ê²€ì • p-value`
    ## [1] 0.8743753

- shapiro.testë¥¼ í†µí•˜ì—¬ ê¸°ì¡´ ë¹„ë£Œë¥¼ ì¤€ ê·¸ë£¹ì— ëŒ€í•œ ì •ê·œì„±ê²€ì • p-value=0.6832ì´ê³ , <br/>ìƒˆë¡œìš´ ë¹„ë£Œë¥¼ ì¤€ ê·¸ë£¹ì— ëŒ€í•œ p-valueëŠ” 0.9021ë¡œ ë‘˜ë‹¤ ìœ ì˜ìˆ˜ì¤€ 5%í•˜ì— ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•  ìˆ˜ ì—†ë‹¤.<br/>
- ì¦‰, ìœ ì˜ìˆ˜ì¤€ 5%í•˜ì— ë‘ ì§‘ë‹¨ ëª¨ë‘ ì •ê·œì„±ì„ ë”°ë¥´ì§€ ì•ŠëŠ”ë‹¤ê³  í•  ì¶©ë¶„í•œ ì¦ê±°ê°€ ì—†ë‹¤.<br/><br/>
- ë“±ë¶„ì‚°ì„± ê²€ì •ì€ var.testì„ í†µí•˜ì—¬ p-value=0.8744ë¡œ ì •í•´ë‘” ìœ ì˜ìˆ˜ì¤€ 0.05ë³´ë‹¤ í¬ë¯€ë¡œ ìœ ì˜ìˆ˜ì¤€ 5%í•˜ì— â€œë‘ ì§‘ë‹¨ì˜ ë¶„ì‚°ì€ ë“±ë¶„ì‚°ì´ë‹¤â€ë¼ëŠ” ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•  ìˆ˜ ì—†ë‹¤.<br/>
- ë”°ë¼ì„œ ìœ ì˜ìˆ˜ì¤€ 5%í•˜ì— â€œë‘ ì§‘ë‹¨ì˜ ëª¨ë¶„ì‚°ì€ ë“±ë¶„ì‚°ì´ ì•„ë‹ˆë‹¤â€ë¼ê³  í•  ì¶©ë¶„í•œ ê·¼ê±°ê°€ ì—†ë‹¤.

> ë‹¤ìŒì€ R ë‚´ì¥ í•¨ìˆ˜ë¡œ êµ¬í•œ t-valueì´ë‹¤.

``` r
t.test(group_pre$exam8_2.height,group_new$exam8_2.height,var.equal = T, alternative = "less")
```

    ## 
    ##  Two Sample t-test
    ## 
    ## data:  group_pre$exam8_2.height and group_new$exam8_2.height
    ## t = -2.9884, df = 16, p-value = 0.004343
    ## alternative hypothesis: true difference in means is less than 0
    ## 95 percent confidence interval:
    ##       -Inf -1.929255
    ## sample estimates:
    ## mean of x mean of y 
    ##     51.91     56.55

> ì§ì ‘ í•¨ìˆ˜ë¥¼ ì‘ì„±í•´ì„œ êµ¬í•˜ì—¬ ë³´ì.

``` r
one_tailed_t_test <- function(x,y){
  n1 <- length(na.omit(x))
  n2 <- length(na.omit(y))
  v1 <- n1-1
  v2 <- n2-1
  xbar1 <- mean(x)
  xbar2 <- mean(y)
  ss1 <- var(x)*v1
  ss2 <- var(y)*v2
  sp2 <- (ss1+ss2)/(v1+v2)
  s_xbar1_xbar2 <- sqrt((sp2/n1)+(sp2/n2))
  t <- (xbar1-xbar2)/s_xbar1_xbar2
  pvalue <- pt(t,v1+v2)
  out <- data.frame(n1,n2,v1,v2,xbar1,xbar2=round(xbar2,2),ss1=round(ss1,3),ss2=round(ss2,4), s_xbar1_xbar2=round(s_xbar1_xbar2,2),t=round(t,3),pvalue=round(pvalue,4))
  return(out)
}
one_tailed_t_test(group_pre$exam8_2.height,group_new$exam8_2.height)
```

    ##   n1 n2 v1 v2 xbar1 xbar2     ss1  ss2 s_xbar1_xbar2      t pvalue
    ## 1 10  8  9  7 51.91 56.55 102.229 69.2          1.55 -2.988 0.0043

- ê¸°ì¡´ì˜ ë¹„ë£Œë³´ë‹¤ ìƒˆë¡œìš´ ë¹„ë£Œë¥¼ ì‚¬ìš©í•˜ì˜€ì„ ë•Œ ì‹ë¬¼ì˜ í‰ê·  ê¸¸ì´ê°€ ë” ê¸¸ë‹¤ëŠ” ê²ƒì„ ê²€ì •í•˜ê³ ì í•˜ë¯€ë¡œ ë‹¨ì¸¡ê²€ì •ì„ ì‹œí–‰í•œë‹¤.<br/>
- ê¸°ì¢… ë¹„ë£Œë¥¼ ì‚¬ìš©í•˜ì˜€ì„ ë•Œ ì‹ë¬¼ ê¸¸ì´ì˜ í‘œë³¸ í‰ê· ì€ 51.91cmì´ê³ , ìƒˆë¡œìš´ ë¹„ë£Œë¥¼ ì‚¬ìš©í•œ ì‹ë¬¼ì˜ ê¸¸ì´ì˜ í‘œë³¸ í‰ê· ì€ 56.55cmì´ë‹¤.<br/>
í•©ë™ë¶„ì‚° $$S^2_p=10.71cm^2$$<br/>
- t-ê°’ì€ -2.9935ì´ê³  ë‹¨ì¸¡ ì„ê³„ê°’ì€ 1.746ìœ¼ë¡œ ì¢Œì¸¡ ì„ê³„ê°’ì¸ -1.746ë³´ë‹¤ t-ê°’ì´ ì‘ìœ¼ë¯€ë¡œ ê¸°ê°ì—­ì— í¬í•¨ë˜ì–´ ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•  ìˆ˜ ìˆë‹¤.<br/>
- ë”°ë¼ì„œ ìœ ì˜ìˆ˜ì¤€ 5%í•˜ì— ê¸°ì¡´ ë¹„ë£Œë³´ë‹¤ ìƒˆë¡œìš´ ë¹„ë£Œë¥¼ ì‚¬ìš©í•˜ì˜€ì„ ë•Œ ì‹ë¬¼ ê¸¸ì´ì˜ ëª¨í‰ê· ì´ í¬ë‹¤ê³  í•  ìˆ˜ ìˆë‹¤.

## EXAMPLE 8.2

![](/study/img/ch8/8-2a.png)

``` r
#ë°ì´í„°ì…‹
ex8_2a%>%
  kbl(caption = "Dataset",escape=F) %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
Dataset
</caption>
<thead>
<tr>
<th style="text-align:right;">
exam8_2a.temp
</th>
<th style="text-align:right;">
exam8_2a.days
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
40
</td>
</tr>
<tr>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
38
</td>
</tr>
<tr>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
32
</td>
</tr>
<tr>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
37
</td>
</tr>
<tr>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
39
</td>
</tr>
<tr>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
41
</td>
</tr>
<tr>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
35
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
36
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
45
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
32
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
52
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
59
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
41
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
48
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
55
</td>
</tr>
</tbody>
</table>

- ì„œë¡œ ë‹¤ë¥¸ ì‹¤í—˜ì‹¤ ì˜¨ë„ì—ì„œ ë°”í€´ë²Œë ˆ ì•Œì´ ë¶€í™”í•˜ëŠ” í‰ê·  ì‹œê°„ì´ ë‹¤ë¥¸ì§€ ê²€ì •í•˜ê³ ì í•œë‹¤.<br/>
- ì‹¤í—˜ì‹¤ ì˜¨ë„ì— ë”°ë¥¸ ë°”í€´ë²Œë ˆ ì•Œì˜ ë¶€í™” ì¼ìˆ˜ í‰ê· ì— ëŒ€í•œ ê°€ì„¤

$$
\begin{aligned}
H_0 &: \mu_{30} = \mu_{10} \\
H_1 &: \mu_{30} \not=\ \mu_{10}
\end{aligned}
$$
- 30ë„ì—ì„œ 7ê°œì˜ ì•Œì„, 10ë„ì—ì„œ 8ê°œì˜ ì•Œì´ ë¶€í™”í•˜ëŠ” ì‹œê°„ì„ ê´€ì°°í•˜ì—¬ ê¸°ë¡í•˜ì˜€ê³  ë‘ê°œì˜ í‘œë³¸ì€ ë…ë¦½ì ì´ê²Œ ì¶”ì¶œí•˜ì˜€ë‹¤.

``` r
##ì •ê·œì„±,ë“±ë¶„ì‚°ì„± ê²€ì •
test <- function(x,y) {
  norm1 = shapiro.test(x)$p.value
  norm2 = shapiro.test(y)$p.value
  equal.var = var.test(x,y)$p.value 
  summary <- list('30ë„ ì‹¤í—˜ì‹¤ p-value'=norm1, '10ë„ ì‹¤í—˜ì‹¤ p-value'=norm2, '30,10 ë“±ë¶„ì‚°ì„±ê²€ì • p-value'=equal.var)
  return(summary)
}
group_30 <- ex8_2a %>% filter(exam8_2a.temp==30)
group_10 <- ex8_2a %>% filter(exam8_2a.temp==10)

test(group_30$exam8_2a.days,group_10$exam8_2a.days)
```

    ## $`30ë„ ì‹¤í—˜ì‹¤ p-value`
    ## [1] 0.7312982
    ## 
    ## $`10ë„ ì‹¤í—˜ì‹¤ p-value`
    ## [1] 0.9415191
    ## 
    ## $`30,10 ë“±ë¶„ì‚°ì„±ê²€ì • p-value`
    ## [1] 0.01564653

- shapiro.testë¥¼ í†µí•˜ì—¬ 30ë„ ì‹¤í—˜ì‹¤ ê·¸ë£¹ì— ëŒ€í•œ ì •ê·œì„±ê²€ì • p-value=0.7312ì´ê³ ,<br/> 10ë„ ì‹¤í—˜ì‹¤ ê·¸ë£¹ì— ëŒ€í•œ p-valueëŠ” 0.9415ë¡œ ë‘˜ë‹¤ ìœ ì˜ìˆ˜ì¤€ 5%í•˜ì— ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•  ìˆ˜ ì—†ë‹¤.<br/>
- ì¦‰, ìœ ì˜ìˆ˜ì¤€ 5%í•˜ì— ë‘ ì§‘ë‹¨ ëª¨ë‘ ì •ê·œì„±ì„ ë”°ë¥´ì§€ ì•ŠëŠ”ë‹¤ê³  í•  ì¶©ë¶„í•œ ì¦ê±°ê°€ ì—†ë‹¤.<br/><br/>
- ë“±ë¶„ì‚°ì„± ê²€ì •ì€ var.testì„ í†µí•˜ì—¬ p-value=0.0156ìœ¼ë¡œ ì •í•´ë‘” ìœ ì˜ìˆ˜ì¤€ 0.05ë³´ë‹¤ ì‘ìœ¼ë¯€ë¡œ ìœ ì˜ìˆ˜ì¤€ 5%í•˜ì— "ë‘ ì§‘ë‹¨ì˜ ë¶„ì‚°ì€ ë“±ë¶„ì‚°ì´ë‹¤"ë¼ëŠ” ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•  ìˆ˜ ìˆë‹¤.<br/>
- ë”°ë¼ì„œ ìœ ì˜ìˆ˜ì¤€ 5%í•˜ì— "ë‘ ì§‘ë‹¨ì˜ ëª¨ë¶„ì‚°ì€ ë“±ë¶„ì‚°ì´ ì•„ë‹ˆë‹¤"ë¼ê³  í•  ìˆ˜ ìˆë‹¤.

> ë‘ ëª¨ì§‘ë‹¨ì´ ì •ê·œë¶„í¬ë¥¼ ë”°ë¥´ì§€ë§Œ ë¶„ì‚°ì´ ë‹¤ë¥¸ ê²½ìš°ëŠ” Behrens-Fisher ê²€ì •ì„ ì´ìš©í•œë‹¤.

``` r
library(asht) #Behrens-Fisherê²€ì •ì„ í•˜ê¸° ìœ„í•œ íŒ¨í‚¤ì§€
#sample size for t-tests with different variances and non-equal n per arm, Behrens-Fisher test, nonparametric ABC intervals, Wilcoxon-Mann-Whitney test ë“±ë“± êµ¬í•  ìˆ˜ ìˆë‹¤.
bfTest(group_30$exam8_2a.days,group_10$exam8_2a.days,altenative=c("two.sided"),mu=0,conf.level=0.95)
```

    ## 
    ##  Behrens-Fisher test
    ## 
    ## data:  x=group_30$exam8_2a.daysand y=group_10$exam8_2a.days
    ## t = -2.4437, R = 0.34076, p-value = 0.04436
    ## alternative hypothesis: true difference in means is not equal to 0
    ## 95 percent confidence interval:
    ##  -16.8684039  -0.2744532
    ## sample estimates:
    ## mean of x mean of y 
    ##  37.42857  46.00000

- 30ë„ ì‹¤í—˜ì‹¤ì˜ ë°”í€´ë²Œë ˆ ì•Œì˜ ë¶€í™” ì¼ìˆ˜ í‰ê· ì€ 37.4daysì´ê³  10ë„ ì‹¤í—˜ì‹¤ì˜ ë°”í€´ë²Œë ˆ ì•Œì˜ ë¶€í™” ì¼ìˆ˜ í‰ê· ì€ 46daysì´ë‹¤.

$$ \sqrt{S^2_\bar{X_{30}}+S^2_\bar{X_{10}}}=3.51 \ days$$

- t-ê°’ì€ -2.44ì´ê³  ì–‘ì¸¡ ì„ê³„ê°’ì€ 2.274ì´ë‹¤. ì¢Œì¸¡ ì„ê³„ê°’ì¸ -2.274ë³´ë‹¤ t-ê°’ì´ ì‘ìœ¼ë¯€ë¡œ ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•  ìˆ˜ ìˆë‹¤.<br/>
- ë”°ë¼ì„œ ì˜¨ë„ê°€ 30ë„ì¸ ì‹¤í—˜ì‹¤ê³¼ 10ë„ì¸ ì‹¤í—˜ì‹¤ì—ì„œ ë°”í€´ë²Œë ˆ ì•Œì˜ ë¶€í™” ì¼ìˆ˜ì˜ ëª¨í‰ê· ì—ëŠ” ì°¨ì´ê°€ ìˆë‹¤ê³  í•  ìˆ˜ ìˆë‹¤.<br/>
(95% ì‹ ë¢°êµ¬ê°„ì„ í™•ì¸í•´ ë³´ë©´ (-16.87,-0.27)ë¡œ 0ì„ í¬í•¨í•˜ê³  ìˆì§€ ì•Šìœ¼ë¯€ë¡œ ë‘ ì§‘ë‹¨ê°„ ëª¨í‰ê· ì—ëŠ” ì°¨ì´ê°€ ìˆë‹¤ê³  ë³¼ ìˆ˜ ìˆë‹¤.)

## EXAMPLE 8.3

![](/study/img/ch8/8-3.png)

- ì •ë°€ë„ë¥¼ ì´ìš©í•œ ëª¨í‰ê· ì°¨ì— ëŒ€í•œ í‘œë³¸í¬ê¸°ê³„ì‚°

- ì •ë°€ë„ dê°€ ì£¼ì–´ì¡Œì„ ë•Œ $$1-\alpha%$$ ì‹ ë¢°êµ¬ê°„ì— ë“¤ì–´ê°ˆ ìˆ˜ ìˆëŠ” ìµœì†Œ í‘œë³¸ í¬ê¸°


$$n=\frac {2*s^2_p*t^2_{(\alpha/2,n_1+n_2-2)}}{d^2}  \ _{(ì–‘ì¸¡)}$$

$$n=\frac {2*s^2_p*t^2_{(\alpha,n_1+n_2-2)}}{d^2} \ _{(ë‹¨ì¸¡)} $$

> ì§ì ‘ í•¨ìˆ˜ë¥¼ ì‘ì„±í•´ì„œ êµ¬í•˜ì—¬ ë³´ì.

``` r
d.sample <- function(x,y, d,alpha,en,side) {
  if(sum(is.na(x)) >= 1) {
  x=na.omit(x) 
  }
  else if (sum(is.na(y)) >= 1){
    y=na.omit(y)
  } 
  else     
    {
    x=x 
    y=y
  }
  n1= length(x) 
  n2= length(y) 
  df1=n1-1
  df2= n2-1
  new_df= en-1
  x.bar1= round(mean(x),2)
  x.bar2= round(mean(y),2)
  ss1=round(sum(x^2) - ((sum(x))^2/n1), 4)
  ss2=round(sum(y^2) - ((sum(y))^2/n2),4) 
  
  sp= round((ss1 + ss2)/(df1+df2),4)
  if (side == "two"){
    ct = round(abs(qt(alpha/2,2*new_df)),3) 
  }
  else{
    ct = round(abs(qt(alpha,2*new_df)),3) 
  }
  size1= ceiling(2*sp*(ct^2) / (d^2))
  s=round((2*sp*(ct^2))/(0.5)^2,1)
  result <- list(spsquare=sp, 'ì„ê³„ê°’'=ct, n=s ,sample_size=size1) 
  return(result)
}
```

``` r
d.sample(group_B$exam8_1.time,group_G$exam8_1.time, 0.5, 0.05, 50,'two')
```

    ## $spsquare
    ## [1] 0.5193
    ## 
    ## $ì„ê³„ê°’
    ## [1] 1.984
    ## 
    ## $n
    ## [1] 16.4
    ## 
    ## $sample_size
    ## [1] 17

> ì •ë°€ë„ d=0.5ì´ê³  $$s^2_p=0.5193$$ í‘œë³¸í¬ê¸°ë¥¼ 50ìœ¼ë¡œ ì¶”ì •í•˜ì˜€ì„ ë•Œ $$t_{0.05(2),98}=1.984$$ì´ê³  í‘œë³¸í¬ê¸°ëŠ” 16.4ê°€ ë‚˜ì˜¨ë‹¤.

<br/> 
<br/>

``` r
d.sample(group_B$exam8_1.time,group_G$exam8_1.time, 0.5, 0.05, 17,'two')
```

    ## $spsquare
    ## [1] 0.5193
    ## 
    ## $ì„ê³„ê°’
    ## [1] 2.037
    ## 
    ## $n
    ## [1] 17.2
    ## 
    ## $sample_size
    ## [1] 18

> ì •ë°€ë„ d=0.5ì´ê³  $$s^2_p=0.5193$$ í‘œë³¸í¬ê¸°ë¥¼ 17ë¡œ ì¶”ì •í•˜ì˜€ì„ ë•Œ $$t_{0.05(2),32}=2.037$$ì´ê³  í‘œë³¸í¬ê¸°ëŠ” 17.2ê°€ ë‚˜ì˜¨ë‹¤.

<br/> 
<br/>

``` r
d.sample(group_B$exam8_1.time,group_G$exam8_1.time, 0.5, 0.05, 18,'two')
```

    ## $spsquare
    ## [1] 0.5193
    ## 
    ## $ì„ê³„ê°’
    ## [1] 2.032
    ## 
    ## $n
    ## [1] 17.2
    ## 
    ## $sample_size
    ## [1] 18

> ì •ë°€ë„ d=0.5ì´ê³  $s^2_p$=0.5193 í‘œë³¸í¬ê¸°ë¥¼ 18ë¡œ ì¶”ì •í•˜ì˜€ì„ ë•Œ $t_{0.05(2),98}$=2.032ì´ê³  í‘œë³¸í¬ê¸°ëŠ” 17.2ê°€ ë‚˜ì˜¨ë‹¤.

- í‘œë³¸í¬ê¸°ë¥¼ 18ë¡œ ì¶”ì •í•˜ì˜€ì„ ë•Œê°€ ì£¼ì–´ì§„ ì •ë°€ë„ì— ê°€ì¥ ë°€ì ‘í•˜ë‹¤. ì—¬ê¸°ì„œ nì€ ìš”êµ¬ë˜ëŠ” ê·¸ë£¹ë³„ í‘œë³¸í¬ê¸°ì´ë‹¤.<br/>ë”°ë¼ì„œ ê·¸ë£¹B, ê·¸ë£¹G ê°ê° 18ê°œì˜ í‘œë³¸í¬ê¸°ë¥¼ ê°€ì ¸ì•¼ í•œë‹¤.

<br/>
<br/>

- ë‘ ê·¸ë£¹ì— ëŒ€í•œ í‘œë³¸ í• ë‹¹ë¹„ê°€ ë‹¤ë¥¸ ê²½ìš° í‘œë³¸í¬ê¸° ê³„ì‚°ë²•

$$n=\frac{k}{\frac{1}{n_1}\ldots\frac{1}{n_k}} \    ,\ _{këŠ”} \ _{ê·¸ë£¹ìˆ˜}$$ 

- ì¡°í™” í‰ê· ì„ ì´ìš©í•´ì„œ ê³„ì‚°í•œë‹¤.

- ê·¸ë£¹1ì˜ í‘œë³¸í¬ê¸°$$n_1$$ë¥¼ ê³ ì •ì‹œí‚¤ê³  ê·¸ë£¹ 2ì˜ í‘œë³¸í¬ê¸°$$n_2$$ë¥¼ êµ¬í•˜ëŠ” ê²½ìš° (ìœ„ ì‹ê³¼ ë™ì¼)

$$ n_2 = \frac{nn_1}{2n_1-n}$$

- ì˜ˆë¥¼ ë“¤ì–´ $$n(ê·¸ë£¹ë³„ í‘œë³¸í¬ê¸°)=18, \ n_1=14$$ì¸ ê²½ìš°

``` r
n=18
n1=14
n2=n*n1 / (2*n1-n)
n2
```

    ## [1] 25.2

- $$n_2$$=25.2 , ì•½ 26ì´ë‹¤.

**ìµœì†Œ ìš”êµ¬ë˜ëŠ” ì´ í‘œë³¸í¬ê¸°ëŠ” 14+26=40**

## EXAMPLE 8.4

![](/study/img/ch8/8-4.png)

$$
\begin{aligned}
n &\ge \frac{2s_p^2}{\delta^2}(t_{(\frac{\alpha}{2},n_1+n_2-2)}+t_{(\beta,n_1+n_2-2)})^2   \ _{(ì–‘ì¸¡)}
\end{aligned}
$$

$$
\begin{aligned}
n &\ge \frac{2s_p^2}{\delta^2}(t_{(\alpha,n_1+n_2-2)}+t_{(\beta,n_1+n_2-2)})^2   \ _{(ë‹¨ì¸¡)}
\end{aligned}
$$

- í‘œë³¸ í¬ê¸°ê°€ 100ì¼ ë•Œ,ììœ ë„=100+100-2=198ì´ê³  ì´ì— ëŒ€ì‘ë˜ëŠ” ì„ê³„ê°’ 

``` r
t_alpha <- round(qt(0.025, 198,lower.tail = F),3) 
t_beta <- round(qt(0.10,198,lower.tail = F), 3)
```

``` r
t_alpha
```

    ## [1] 1.972

> $$t_{0.05(2),198}=1.972$$

``` r
t_beta
```

    ## [1] 1.286

> $$t_{0.10(1),198}=1.286$$

``` r
bound <- round(2*0.52 / 0.5^2 *(t_alpha+t_beta)^2, 1)
bound
```

    ## [1] 44.2

> $$ n \ge 44.2 $$

<br/> 
<br/>

-   í‘œë³¸ í¬ê¸°ê°€ 45ì¼ ë•Œ,ììœ ë„=45+45-2=88ì´ê³  ì´ì— ëŒ€ì‘ë˜ëŠ” ì„ê³„ê°’

``` r
t_alpha <- round(qt(0.025, 88,lower.tail = F),3)
t_beta <- round(qt(0.10,88,lower.tail = F), 3)
```

``` r
t_alpha
```

    ## [1] 1.987

> $$t_{0.05(2),88}=1.987$$

``` r
t_beta
```

    ## [1] 1.291

> $$t_{0.10(1),88}=1.291$$

``` r
bound <- round(2*0.52 / 0.5^2 *(t_alpha+t_beta)^2, 1)
bound
```

    ## [1] 44.7

> $$n \ge 44.7$$

- ë”°ë¼ì„œ ë‘ í‘œë³¸ì˜ í¬ê¸°ëŠ” ê°ê° ìµœì†Œí•œ 45 ì´ìƒì´ì—¬ì•¼ í•œë‹¤.<br/>
- ê·¸ë£¹1ì˜ í‘œë³¸í¬ê¸°$$n_1$$=30ìœ¼ë¡œ ê³ ì •ì‹œí‚¤ê³  ê·¸ë£¹ 2ì˜ í‘œë³¸í¬ê¸°$$n_2$$ë¥¼ êµ¬í•˜ëŠ” ê²½ìš°

``` r
n=44.7
n1=30
n2=n*n1 / (2*n1-n)
n2
```

    ## [1] 87.64706

> n(ê·¸ë£¹ë³„ í‘œë³¸ í¬ê¸°)ì€ ìœ„ì—ì„œ êµ¬í•œ 44.7ë¡œ ë‘ê³  $$n_1$$=30ìœ¼ë¡œ ê³ ì •ë˜ì–´ ìˆì„ ë•Œ $$n_2$$ëŠ” 88ì´ë‹¤.

## EXAMPLE 8.5

![](/study/img/ch8/8-5.png)

- ìµœì†Œ ê²€ì¶œì°¨ (minimum detectable difference:MDD)

$$
\delta \ge \sqrt{\frac{2s_p^2}{n}}t_{(\frac{\alpha}{2},n_1+n_2-2)}+t_{(\beta,n_1+n_2-2)}  \ _{(ì–‘ì¸¡)}
$$

$$
\delta \ge \sqrt{\frac{2s_p^2}{n}}t_{(\alpha,n_1+n_2-2)}+t_{(\beta,n_1+n_2-2)} \ _{(ë‹¨ì¸¡)}
$$

``` r
delta <- sqrt(2*0.5193 / 20)*(qt(0.025,38,lower.tail = F) + qt(0.1,38,lower.tail = F))
round(delta, 2)
```

    ## [1] 0.76

- $$n$$(í‘œë³¸ í¬ê¸°)=20, $$\alpha$$=0.05, $$\beta$$=1-0.9=0.1ë¡œ ì£¼ì–´ì¡Œì„ ë•Œ ê²€ì¶œ ê°€ëŠ¥í•œ ìµœì†Œ ì°¨ì´ëŠ” 0.76minì´ë‹¤.

## EXAMPLE 8.6

![](/study/img/ch8/8-6.png)

- Example 8.1ì— ëŒ€í•˜ì—¬ $$n_1=n_2=15$$, and $$\alpha(2)=0.05$$í•˜ì— ë‘ ì•½ë¬¼ì„ ì‚¬ìš©í•˜ì—¬ ì‚¬ëŒì˜ í‰ê·  í˜ˆì•¡ ì‘ê³  ì‹œê°„ ê°„ì— 1ë¶„ì˜ ì°¨ì´ë¥¼ ê²€ì¶œí•  í™•ë¥ <br/>
- ê²€ì •ë ¥ ê³µì‹

$$
\ t_{(\beta,n_1+n_2-2)} \leq \frac{\delta}{\sqrt{\frac{2s^2_p}{n}}} \ -t_{(\frac{\alpha}{2},n_1+n_2-2)}  \ _{(ì–‘ì¸¡)}
$$

$$
\ t_{(\beta,n_1+n_2-2)} \leq \frac{\delta}{\sqrt{\frac{2s^2_p}{n}}} \ -t_{(\alpha,n_1+n_2-2)}  \ _{(ë‹¨ì¸¡)}
$$

``` r
delta <- 1
n <- 15
sp <- 0.5193
t_alpha<- 2.048
t_beta <- delta/(sqrt((2*sp)/15))-t_alpha
round(t_beta,3)
```

    ## [1] 1.752

$$
\ t_{(\beta(1),28)} \leq 1.752
$$

![](/study/img/ch8/table1.jpg)

- $$P(t\geq1.752)$$ (ë‹¨ì¸¡) ììœ ë„=28ì¸ í™•ë¥ ì€ (0.025,0.05)êµ¬ê°„ì— ìˆë‹¤. ë”°ë¼ì„œ $$0.025<\beta<0.05$$

$$Power=1-\beta, \ so \ 0.95<power<0.975$$

- í‘œì¤€ì •ê·œë¶„í¬ ê·¼ì‚¬ ê°’ìœ¼ë¡œ êµ¬í•œ ì •ê·œë¶„í¬ í™•ë¥ ì€ $$\beta \ by \ P(Z\geq1.752)=0.04$$ì´ë‹¤. ë”°ë¼ì„œ power=0.96ì´ë‹¤.

$$
\phi=\sqrt{(\frac{n\delta^2}{4s^2_p})}=\sqrt{(\frac{15(1.0)^2}{4(0.5193)})}=2.69
$$

![](/study/img/ch8/table2.jpg)

- í‘œë¥¼ ì°¸ê³ í•˜ì—¬ ë³´ë©´ $$\phi=2.69 \ and \ \nu(=\nu_2)=28$$ì€ ì•½ 0.96ì˜ ê²€ì •ë ¥ê³¼ ê´€ë ¨ì´ ìˆê²Œ ë‚˜ì˜¨ë‹¤.

## EXAMPLE 8-7

![](/study/img/ch8/8-7.png)

- type1,type2ì¸ trapì— ë”°ë¼ ì¡íˆëŠ” ë‚˜ë°©ì˜ ìˆ˜ì˜ í‘œë³¸ì„ êµ¬í–ˆë‹¤.<br/>
- trap ì¢…ë¥˜ì— ë”°ë¼ ì¡íŒ ë‚˜ë°©ì˜ ìˆ˜ì— ëŒ€í•œ ë¶„ì‚°ì˜ ë¹„ê°€ ë‹¤ë¥¸ê°€ì— ëŒ€í•œ ê²€ì •ìœ¼ë¡œ ëª¨ì§‘ë‹¨ì˜ ë¶„ì‚° ì°¨ì´ê°€ ìˆëŠ”ì§€ ì•Œì•„ë³´ê³ ì í•œë‹¤.

$$
\ H_0:\sigma^2_1 = \sigma^2_2 \ vs \ H_1: \sigma^2_1 \not= \sigma^2_2
$$

``` r
##ì •ê·œì„±,ë“±ë¶„ì‚°ì„± ê²€ì •
test <- function(x,y) {
  norm1 = shapiro.test(x)$p.value
  norm2 = shapiro.test(y)$p.value
  summary <- list('type1 ìƒ¤í”¼ë¡œìœŒí¬ p-value'=norm1, 'type2 ìƒ¤í”¼ë¡œìœŒí¬ p-value'=norm2)
  return(summary)
}
group_1 <- ex8_7 %>% filter(exam8_7.trap==1)
group_2 <- ex8_7 %>%  filter(exam8_7.trap==2)

test(group_1$exam8_7.number,group_2$exam8_7.number)
```

    ## $`type1 ìƒ¤í”¼ë¡œìœŒí¬ p-value`
    ## [1] 0.8921986
    ## 
    ## $`type2 ìƒ¤í”¼ë¡œìœŒí¬ p-value`
    ## [1] 0.9156178

- ë¶„ì‚°ë¹„ë¥¼ ê²€ì •í•˜ê¸° ì „ì— ê° ëª¨ì§‘ë‹¨ì˜ í‘œë³¸ì´ ì •ê·œì„±ì„ ë”°ë¥´ëŠ”ì§€ shapiro-wilk testë¡œ ê²€ì •í•˜ì˜€ë‹¤.<br/>
- shapiro-wilk p-valueê°€ ê°ê° 0.892, 0.916 ì´ë¯€ë¡œ ìœ ì˜ìˆ˜ì¤€ 0.05ë³´ë‹¤ í¬ë¯€ë¡œ ìœ ì˜ìˆ˜ì¤€ 5%í•˜ì— ë‘ ì§‘ë‹¨ ëª¨ë‘ ì •ê·œì„±ì„ ë”°ë¥´ì§€ ì•ŠëŠ”ë‹¤ê³  í•  ì¶©ë¶„í•œ ì¦ê±°ê°€ ì—†ë‹¤.

``` r
n1 <- length(group_1$exam8_7.number) 
n2 <- length(group_2$exam8_7.number)
var1 <- round(var(group_1$exam8_7.number), 2)
var2 <- round(var(group_2$exam8_7.number), 2)
F_stat <- round(var1 / var2, 2)
list(n1=n1, n2=n2, var1=var1, var2=var2,"F"=F_stat)
```

    ## $n1
    ## [1] 11
    ## 
    ## $n2
    ## [1] 10
    ## 
    ## $var1
    ## [1] 21.87
    ## 
    ## $var2
    ## [1] 12.9
    ## 
    ## $F
    ## [1] 1.7

> ê° í‘œë³¸ì˜ í¬ê¸°ì™€ ë¶„ì‚°ì´ êµ¬í•´ì¡Œê³  ë¶„ì‚°ë¹„ F=1.70ìœ¼ë¡œ ë‚˜ì™”ë‹¤.

- $$F_{0.05(2),10,9}$$=3.96 ì´ë‹¤. F-ê°’=1.7ì´ ì„ê³„ê°’(3.96)ë³´ë‹¤ ì‘ìœ¼ë¯€ë¡œ ê¸°ê°ì—­ì— í¬í•¨ë˜ì§€ ì•Šê³  ë”°ë¼ì„œ ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•  ë§Œí•œ ì¶©ë¶„í•œ ê·¼ê±°ê°€ ì—†ë‹¤. <br/> ë˜í•œ p-valueë¥¼ í™•ì¸ í•˜ì—¬ë„ ìœ ì˜ìˆ˜ì¤€ 5%ë³´ë‹¤ í¬ë¯€ë¡œ ìœ ì˜ìˆ˜ì¤€ 5%í•˜ì— ìœ ì˜í•˜ë‹¤ê³  ë³¼ ìˆ˜ ì—†ë‹¤.<br/>
- ì¦‰, trapì˜ ì¢…ë¥˜ì— ë”°ë¼ ì¡íŒ ë‚˜ë°©ì˜ ìˆ˜ì˜ ëª¨ë¶„ì‚°ì´ ê°™ì§€ ì•Šë‹¤ê³  í•  ìˆ˜ ì—†ë‹¤.

## EXAMPLE 8-8

![](/study/img/ch8/8-8.png)

``` r
#ë°ì´í„°ì…‹
ex8_8%>%
  kbl(caption = "Dataset",escape=F) %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
Dataset
</caption>
<thead>
<tr>
<th style="text-align:right;">
exam8_8.site
</th>
<th style="text-align:right;">
exam8_8.time
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
69.3
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
75.5
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
81.0
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
74.7
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
72.3
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
78.7
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
76.4
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
69.5
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
64.6
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
74.0
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
84.8
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
76.0
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
93.9
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
81.2
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
73.4
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
88.0
</td>
</tr>
</tbody>
</table>

- Greenhouse,Outsideì—ì„œ ì†Œë‚˜ë¬´ ì¢…ì ë°œì•„ ì‹œê°„ì„ ê°ê° ì¸¡ì •í•˜ì˜€ë‹¤. <br/>
- ë‘ ìƒí™©ì—ì„œ ì¶”ì¶œí•œ ë‘ ë°ì´í„°ë¡œ Outsideì—ì„œì˜ ì†Œë‚˜ë¬´ ì¢…ì ë°œì•„ ì‹œê°„ì˜ ëª¨ë¶„ì‚°ì´ Greenhouseì—ì„œ ë³´ë‹¤ ëª¨ë¶„ì‚°ì´ ë” í°ì§€ ê²€ì •í•˜ê³ ì í•œë‹¤.

$$
\ H_0:\sigma^2_1 \geq \sigma^2_2 \ vs \ H_1: \sigma^2_1 < \sigma^2_2
$$

``` r
##ì •ê·œì„±,ë“±ë¶„ì‚°ì„± ê²€ì •
test <- function(x,y) {
  norm1 = shapiro.test(x)$p.value
  norm2 = shapiro.test(y)$p.value
  summary <- list('Greenhouse ìƒ¤í”¼ë¡œìœŒí¬ p-value'=norm1, 'Outside ìƒ¤í”¼ë¡œìœŒí¬ p-value'=norm2)
  return(summary)
}
group_G <- ex8_8 %>% filter(exam8_8.site==1)
group_O <- ex8_8 %>% filter(exam8_8.site==2)

test(group_G$exam8_8.time,group_O$exam8_8.time)
```

    ## $`Greenhouse ìƒ¤í”¼ë¡œìœŒí¬ p-value`
    ## [1] 0.993425
    ## 
    ## $`Outside ìƒ¤í”¼ë¡œìœŒí¬ p-value`
    ## [1] 0.9566238

- ë¶„ì‚°ë¹„ë¥¼ ê²€ì •í•˜ê¸° ì „ì— ê° ëª¨ì§‘ë‹¨ì˜ í‘œë³¸ì´ ì •ê·œì„±ì„ ë”°ë¥´ëŠ”ì§€ shapiro-wilk testë¡œ ê²€ì •í•˜ì˜€ë‹¤.<br/>
- shapiro-wilk p-valueê°€ ê°ê° 0.993, 0.956 ì´ë¯€ë¡œ ìœ ì˜ìˆ˜ì¤€ 0.05ë³´ë‹¤ í¬ë¯€ë¡œ ìœ ì˜ìˆ˜ì¤€ 5%í•˜ì— ë‘ ì§‘ë‹¨ ëª¨ë‘ ì •ê·œì„±ì„ ë”°ë¥´ì§€ ì•ŠëŠ”ë‹¤ê³  í•  ì¶©ë¶„í•œ ì¦ê±°ê°€ ì—†ë‹¤.

``` r
n1 <- length(group_G$exam8_8.time) 
n2 <- length(group_O$exam8_8.time)
var1 <- round(var(group_G$exam8_8.time), 2)
var2 <- round(var(group_O$exam8_8.time), 2)
F_stat <- round(var2 / var1, 2)
list(n1=n1, n2=n2, var1=var1, var2=var2,"F"=F_stat)
```

    ## $n1
    ## [1] 7
    ## 
    ## $n2
    ## [1] 9
    ## 
    ## $var1
    ## [1] 15.09
    ## 
    ## $var2
    ## [1] 87.62
    ## 
    ## $F
    ## [1] 5.81

- ê°ê°ì˜ ë¶„ì‚°ì€ $$s^2_1=15.10$$, $$s^2_2=87.62$$ì´ê³ , $$F=\frac{s^2_1}{s^2_2} \ or \ F=\frac{s^2_2}{s^2_1}$$ ë‘˜ ì¤‘ í° ê°’ì„ ì‚¬ìš©í•œë‹¤.<br/> ë”°ë¼ì„œ $$F=\frac{s^2_2}{s^2_1}= \frac{87.62}{15.10}=5.80$$ì´ë‹¤.

- F-ê°’ì´ ì„ê³„ê°’ $$F_{0.05(1),8,6}=4.15$$ ë³´ë‹¤ í¬ë¯€ë¡œ ê¸°ê°ì—­ì— í¬í•¨ë˜ê³  ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•  ìˆ˜ ìˆë‹¤.<br/>
- ë”°ë¼ì„œ Greenhouseì—ì„œ ì†Œë‚˜ë¬´ ì¢…ì ë°œì•„ ì‹œê°„ ëª¨ë¶„ì‚°ì€ Outsideì—ì„œ ì†Œë‚˜ë¬´ ì¢…ì ë°œì•„ ì‹œê°„ ëª¨ë¶„ì‚° ë³´ë‹¤ ì‘ë‹¤ê³  í•  ìˆ˜ ìˆë‹¤.

## EXAMPLE 8-9

![](/study/img/ch8/8-9.png)
![](/study/img/ch8/8-9-1.png)

``` r
library(lawstat) #levene testë¥¼ ìœ„í•œ íŒ¨í‚¤ì§€
levene.test(ex8_7$exam8_7.number,ex8_7$exam8_7.trap,location='mean')
```

    ## 
    ##  Classical Levene's test based on the absolute deviations from the mean
    ##  ( none not applied because the location is not set to median )
    ## 
    ## data:  ex8_7$exam8_7.number
    ## Test Statistic = 0.49267, p-value = 0.4913

- Levene testë¥¼ í†µí•˜ì—¬ ë¶„ì‚°ì˜ ë™ì¼ì„± ê²€ì •ì„ í•  ìˆ˜ ìˆë‹¤. <br/>
- Levene testëŠ” ëª¨ì§‘ë‹¨ì´ ì •ê·œë¶„í¬ë¥¼ ë”°ë¥´ì§€ ì•ŠëŠ” ê²½ìš°ì— ëª¨ë¶„ì‚°ì˜ ë™ì§ˆì„±ì„ ê²€ì •í•˜ê¸° ìœ„í•˜ì—¬ ì‚¬ìš©í•œë‹¤.<br/>
- p-value = 0.4913ìœ¼ë¡œ ì¶œë ¥ëœ ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤. ê·¸ëŸ¬ë¯€ë¡œ ìœ ì˜ìˆ˜ì¤€ 5%í•˜ì—ì„œ ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•  ì¶©ë¶„í•œ ê·¼ê±°ê°€ ì—†ë‹¤.

> ë‘ ì¢…ë¥˜ì˜ trapì— ë”°ë¼ ì¡íˆëŠ” ë‚˜ë°©ì˜ ìˆ˜ì˜ ëª¨ë¶„ì‚°ì´ ê°™ì§€ ì•Šë‹¤ëŠ” ì¦ê±°ê°€ ì¶©ë¶„í•˜ì§€ ì•Šë‹¤ê³  í•  ìˆ˜ ìˆë‹¤.

## EXAMPLE 8-10

![](/study/img/ch8/8-10.png)
![](/study/img/ch8/8-10-1.png)
![](/study/img/ch8/8-10-2.png)

``` r
#ë°ì´í„°ì…‹
ex8_10%>%
  kbl(caption = "Dataset",escape=F) %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
Dataset
</caption>
<thead>
<tr>
<th style="text-align:left;">
exam8_10.weight
</th>
<th style="text-align:right;">
exam8_10.height
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
72.5
</td>
<td style="text-align:right;">
183.0
</td>
</tr>
<tr>
<td style="text-align:left;">
71.700000000000003
</td>
<td style="text-align:right;">
172.3
</td>
</tr>
<tr>
<td style="text-align:left;">
60.799999999999997
</td>
<td style="text-align:right;">
180.1
</td>
</tr>
<tr>
<td style="text-align:left;">
63.200000000000003
</td>
<td style="text-align:right;">
190.2
</td>
</tr>
<tr>
<td style="text-align:left;">
71.400000000000006
</td>
<td style="text-align:right;">
191.4
</td>
</tr>
<tr>
<td style="text-align:left;">
73.099999999999994
</td>
<td style="text-align:right;">
169.6
</td>
</tr>
<tr>
<td style="text-align:left;">
77.900000000000006
</td>
<td style="text-align:right;">
166.4
</td>
</tr>
<tr>
<td style="text-align:left;">
75.700000000000003
</td>
<td style="text-align:right;">
177.6
</td>
</tr>
<tr>
<td style="text-align:left;">
72
</td>
<td style="text-align:right;">
184.7
</td>
</tr>
<tr>
<td style="text-align:left;">
69
</td>
<td style="text-align:right;">
187.5
</td>
</tr>
<tr>
<td style="text-align:left;">
.
</td>
<td style="text-align:right;">
179.8
</td>
</tr>
</tbody>
</table>

- ê°™ì€ ëª¨ì§‘ë‹¨ì—ì„œ ì¶”ì¶œëœ ë‚¨ì„±ì˜ í‚¤ì™€ ëª¸ë¬´ê²Œì˜ ë³€ë™ì´ ë‹¤ë¥¸ì§€ë¥¼ ê²€ì •í•˜ê³ ì í•œë‹¤.<br/>
- í‚¤ì˜ ì¸¡ì • ë‹¨ìœ„ëŠ” cmì´ê³ , ëª¸ë¬´ê²Œì˜ ì¸¡ì •ë‹¨ìœ„ëŠ” kgì´ë‹¤.<br/>
- ë‹¨ìœ„ê°€ ë‹¤ë¥¸ ë‘ ë°ì´í„°ì˜ ë¹„êµë¥¼ ìœ„í•´ ë³€ë™ê³„ìˆ˜ (coefficients of variantion)ì„ ì‚°ì¶œí•˜ì—¬ ë¹„êµí•˜ì˜€ë‹¤.<br/>
- ë”°ë¼ì„œ ê°€ì„¤ì€ ë‹¤ìŒê³¼ ê°™ì´ ì„¤ì •í•  ìˆ˜ ìˆë‹¤.

$$
\begin{aligned}
H_0 &:\frac{\sigma_1}{\mu_1}=\frac{\sigma_2}{\mu_2}, \\
H_1 &:\frac{\sigma_1}{\mu_1} \neq \frac{\sigma_2}{\mu_2}
\end{aligned}
$$

``` r
##ì •ê·œì„±,ë“±ë¶„ì‚°ì„± ê²€ì •
test <- function(x,y) {
  norm1 = shapiro.test(x)$p.value
  norm2 = shapiro.test(y)$p.value
  summary <- list('weight ìƒ¤í”¼ë¡œìœŒí¬ p-value'=norm1, 'height ìƒ¤í”¼ë¡œìœŒí¬ p-value'=norm2)
  return(summary)
}

test(as.numeric(ex8_10$exam8_10.weight),as.numeric(ex8_10$exam8_10.height))
```

    ## $`weight ìƒ¤í”¼ë¡œìœŒí¬ p-value`
    ## [1] 0.2660832
    ## 
    ## $`height ìƒ¤í”¼ë¡œìœŒí¬ p-value`
    ## [1] 0.7483809

- p-valueê°€ ê°ê° $$p\ value=0.2661,\ 0.7484$$ ìœ¼ë¡œ ìœ ì˜ìˆ˜ì¤€ 0.05ë³´ë‹¤ í¬ê¸°ì— ê·€ë¬´ê°€ì„¤ $$H_0$$ ë¥¼ ê¸°ê°í• ë§Œí•œ ì¶©ë¶„í•œ ê·¼ê±°ê°€ ì—†ë‹¤. ë°ì´í„°ì…‹ì´ ì •ê·œì„±ì„ ë”°ë¥´ì§€ ì•ŠëŠ”ë‹¤ëŠ” ì¶©ë¶„í•œ ê·¼ê±°ê°€ ì—†ê¸°ì— ë¶„ì‚° ë¹„ì˜ ê²€ì •ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤.

> ë¶„ì‚°ë¹„ ê²€ì •ì„ í•˜ê¸° ìœ„í•˜ì—¬ í†µê³„ëŸ‰ êµ¬í•˜ëŠ” í•¨ìˆ˜ë¥¼ ì‘ì„±í•˜ì—¬ ë³´ì.

``` r
library(kableExtra)
f8_10 <- function(x,y){
  x <- na.omit(x)
  y <- na.omit(y)
  n1 <- length(x)
  n2 <- length(y)
  v1 <- n1-1
  v2 <- n2-1
  xbar1 <- mean(x)
  xbar2 <- mean(y)
  s1 <-var(x)
  s2 <- var(y)
  ss1 <- var(x)*v1
  ss2 <- var(y)*v2
  sd1 <- sd(x)
  sd2 <- sd(y)
  cv1 <- sd1/xbar1
  cv2 <- sd2/xbar2
  sslog1 <- var(log10(x))*v1
  sslog2 <- var(log10(y))*v2
  slog1 <- var(log10(x))
  slog2 <- var(log10(y))
  if(slog1 > slog2){
    f <- slog1/slog2
  }
  else{
    f <- slog2/slog1
  }
  pvalue <- 2*(1-pf(f,max(v1,v2),min(v1,v2)))
  if(pvalue < 0.05){
    Reject_H0 <- "yes"
    sp2 <- NA
  }
  else{
    Reject_H0 <- "No"
  }
  out1 <- c(n=n1,v=v1,xbar=round(xbar1,2), s_2=round(s1,4),s=round(ss1,4),CV =round(cv1,4),SSlog=round(sslog1,8),s_2log=round(slog1,8),F=round(f,2),
                    pvalue=round(pvalue,2),Reject_H0)
  out2 <- c(n=n2,v=v2,xbar=round(xbar2,2), s_2=round(s2,4),s=round(ss2,4),CV =round(cv2,4),SSlog=round(sslog2,8),s_2log=round(slog2,8),F=round(f,2),
                    pvalue=round(pvalue,2),Reject_H0)
  out <-as.data.frame(cbind(out1,out2))
  names(out) <- c("Weight","Height")
  rownames(out)[11] <- "Reject_H0"
  return(out)
}

f8_10(as.numeric(ex8_10$exam8_10.weight),as.numeric(ex8_10$exam8_10.height)) %>%
  kbl(caption = "Result of Variance ratio test") %>%
   kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
Result of Variance ratio test
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
Weight
</th>
<th style="text-align:left;">
Height
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
n
</td>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
11
</td>
</tr>
<tr>
<td style="text-align:left;">
v
</td>
<td style="text-align:left;">
9
</td>
<td style="text-align:left;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
xbar
</td>
<td style="text-align:left;">
70.73
</td>
<td style="text-align:left;">
180.24
</td>
</tr>
<tr>
<td style="text-align:left;">
s_2
</td>
<td style="text-align:left;">
27.3512
</td>
<td style="text-align:left;">
67.8945
</td>
</tr>
<tr>
<td style="text-align:left;">
s
</td>
<td style="text-align:left;">
246.161
</td>
<td style="text-align:left;">
678.9455
</td>
</tr>
<tr>
<td style="text-align:left;">
CV
</td>
<td style="text-align:left;">
0.0739
</td>
<td style="text-align:left;">
0.0457
</td>
</tr>
<tr>
<td style="text-align:left;">
SSlog
</td>
<td style="text-align:left;">
0.00986951
</td>
<td style="text-align:left;">
0.00400214
</td>
</tr>
<tr>
<td style="text-align:left;">
s_2log
</td>
<td style="text-align:left;">
0.00109661
</td>
<td style="text-align:left;">
0.00040021
</td>
</tr>
<tr>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
2.74
</td>
<td style="text-align:left;">
2.74
</td>
</tr>
<tr>
<td style="text-align:left;">
pvalue
</td>
<td style="text-align:left;">
0.14
</td>
<td style="text-align:left;">
0.14
</td>
</tr>
<tr>
<td style="text-align:left;">
Reject_H0
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
No
</td>
</tr>
</tbody>
</table>

- ëª¸ë¬´ê²Œì˜ CV=0.0739, í‚¤ì˜ CV=0.0457<br/>
- Lewontinì€ dataë¥¼ logarithmic transformationí•˜ì—¬ ë³€ë™ê³„ìˆ˜ ê²€ì •ì„ ìˆ˜í–‰í•˜ëŠ” ë°©ë²•ì„ ì¦ëª…í•˜ì˜€ë‹¤.<br/>
ê° í‘œë³¸ì˜ dataë“¤ì— log10 ë³€í™˜ì„ í•˜ì—¬ ì‚°ì¶œí•œ ë¶„ì‚°ì€ ëª¸ë¬´ê²Œ=0.0010967, í‚¤=0.00040019ì´ê³ ,<br/>
ì´ë¥¼ í™œìš©í•œ F-valueëŠ” $$F=\frac{0.0010967}{0.00040019}=2.74$$ì´ë‹¤.<br/>
ì„ê³„ê°’ë³´ë‹¤ F-valueê°€ ì‘ìœ¼ë¯€ë¡œ ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•  ìˆ˜ ì—†ë‹¤.

> ì¦‰, ê°™ì€ ëª¨ì§‘ë‹¨ìœ¼ë¡œë¶€í„° ì¶”ì¶œëœ ë‚¨ì„±ì˜ í‚¤ì™€ ëª¸ë¬´ê²Œì˜ ë³€ë™ì€ ë‹¤ë¥´ë‹¤ê³  í•  ì¦ê±°ê°€ ì¶©ë¶„í•˜ì§€ ëª»í•˜ë‹¤.

``` r
cv1 <- as.numeric(f8_10(as.numeric(ex8_10$exam8_10.weight),as.numeric(ex8_10$exam8_10.height))$Weight[6])
cv2 <- as.numeric(f8_10(as.numeric(ex8_10$exam8_10.weight),as.numeric(ex8_10$exam8_10.height))$Height[6])
v1 <- as.numeric(f8_10(as.numeric(ex8_10$exam8_10.weight),as.numeric(ex8_10$exam8_10.height))$Weight[2])
v2 <- as.numeric(f8_10(as.numeric(ex8_10$exam8_10.weight),as.numeric(ex8_10$exam8_10.height))$Height[2])
vp <- (v1*cv1+v2*cv2)/(v1+v2)
vp2 <- round(vp,4)^2
Z <- (cv1-cv2)/sqrt(((vp2/v1)+(vp2/v2))*(0.5+vp2))
pvalue <- 2*(1-pt(Z,v1+v2))

if(pvalue < 0.05){
  Reject_H0 <- "yes"
}else{
  Reject_H0 <- "No"
}

ztest <- data.frame(vp=round(vp,4),vp2=round(vp2,6),Z=round(Z,2),pvalue=round(pvalue,2),Reject_H0)
ztest%>%
  kbl(caption = "Result of Z test") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
Result of Z test
</caption>
<thead>
<tr>
<th style="text-align:right;">
vp
</th>
<th style="text-align:right;">
vp2
</th>
<th style="text-align:right;">
Z
</th>
<th style="text-align:right;">
pvalue
</th>
<th style="text-align:left;">
Reject_H0
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.0591
</td>
<td style="text-align:right;">
0.003493
</td>
<td style="text-align:right;">
1.46
</td>
<td style="text-align:right;">
0.16
</td>
<td style="text-align:left;">
No
</td>
</tr>
</tbody>
</table>

- MillerëŠ” ê³µí†µ ë³€ë™ê³„ìˆ˜ë¥¼ ì‚°ì¶œí•˜ì—¬ Zë¶„í¬ë¥¼ í™œìš©í•´ ë³€ë™ê³„ìˆ˜ ì°¨ì— ëŒ€í•œ ê°€ì„¤ ê²€ì •ì„ ìˆ˜í–‰í•˜ì˜€ë‹¤.<br/>
ê³µí†µ ë³€ë™ê³„ìˆ˜ëŠ” $$V_p=\frac{\nu_1V1+\nu_2V2}{\nu_1+\nu_2}=\frac{9(0.0739)+10(0.0457)}{9+10}=0.0591$$ì´ë‹¤.<br/>
ê³µí†µ ë³€ë™ê³„ìˆ˜ë¥¼ í™œìš©í•œ Z-value=1.46ì´ê³ , ìœ ì˜ìˆ˜ì¤€ 5%í•˜ì—ì„œ ì„ê³„ê°’ z=1.96ì´ë‹¤.<br/>
z-valueê°€ ì„ê³„ê°’ ë³´ë‹¤ ì‘ìœ¼ë¯€ë¡œ, ê¸°ê°ì—­ì— í¬í•¨ë˜ì§€ ì•Šì•„ ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•  ìˆ˜ ì—†ë‹¤.

> ì¦‰, ê°™ì€ ëª¨ì§‘ë‹¨ìœ¼ë¡œë¶€í„° ì¶”ì¶œëœ ë‚¨ì„± í‚¤ì™€ ëª¸ë¬´ê²Œì˜ ë³€ë™ì€ ë‹¤ë¥´ë‹¤ê³  í•˜ê¸° ì–´ë µë‹¤.

## EXAMPLE 8-11

![](/study/img/ch8/8-11.png)

``` r
#ë°ì´í„°ì…‹
ex8_11%>%
  kbl(caption = "Dataset",escape=F) %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
Dataset
</caption>
<thead>
<tr>
<th style="text-align:right;">
exam8_11.sex
</th>
<th style="text-align:right;">
exam8_11.height
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
193
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
188
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
185
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
183
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
180
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
175
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
170
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
178
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
173
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
168
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
165
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
163
</td>
</tr>
</tbody>
</table>

- ë³¸ ë°ì´í„°ëŠ” ì„±ì¸ ë‚¨ì„±ê³¼ ì—¬ì„±ì˜ í‚¤ë¥¼ ê¸°ë¡í•œ ë°ì´í„°ì´ë‹¤.<br/>
- ë°ì´í„°ë¥¼ ê·¸ë£¹ë³„ë¡œ ë‚˜ëˆ„ì–´ ë³´ì.

``` r
hm <- ex8_11 %>% filter(exam8_11.sex=='1') 
hf <- ex8_11 %>% filter(exam8_11.sex=='2')

library(qpcR) # ê²°ì¸¡ì¹˜ ìˆëŠ” ë°ì´í„° cbind   
ex8_11_cbind<- data.frame(qpcR:::cbind.na(hm[,2], hf[,2]))
names(ex8_11_cbind) <- c("Heights of males","Heights of females")
```

> malesì™€ females ë°ì´í„° ìˆ˜ê°€ ì°¨ì´ë‚˜ê¸° ë•Œë¬¸ì— cbindê°€ ë˜ì§€ ì•Šìœ¼ë¯€ë¡œ qpcRíŒ¨í‚¤ì§€ë¥¼ ì‚¬ìš©í•˜ì—¬ ê²°í•©ì‹œì¼œì¤€ë‹¤.

``` r
ex8_11_cbind%>%
  kbl(caption = "Dataset",escape=F) %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
Dataset
</caption>
<thead>
<tr>
<th style="text-align:right;">
Heights of males
</th>
<th style="text-align:right;">
Heights of females
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
193
</td>
<td style="text-align:right;">
178
</td>
</tr>
<tr>
<td style="text-align:right;">
188
</td>
<td style="text-align:right;">
173
</td>
</tr>
<tr>
<td style="text-align:right;">
185
</td>
<td style="text-align:right;">
168
</td>
</tr>
<tr>
<td style="text-align:right;">
183
</td>
<td style="text-align:right;">
165
</td>
</tr>
<tr>
<td style="text-align:right;">
180
</td>
<td style="text-align:right;">
163
</td>
</tr>
<tr>
<td style="text-align:right;">
175
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
170
</td>
<td style="text-align:right;">
NA
</td>
</tr>
</tbody>
</table>

- ë‚¨í•™ìƒê³¼ ì—¬í•™ìƒ í‚¤ì˜ ì°¨ì´ì— ëŒ€í•œ ê²€ì •ì„ í•˜ê³ ì í•œë‹¤.<br/>
- ì¼ë°˜ì ì¸ t-ê²€ì •ì„ ìˆ˜í–‰í•˜ê¸°ì—” í‘œë³¸ì˜ ìˆ˜ê°€ ì ì–´ ë¹„ëª¨ìˆ˜ ê²€ì • ë°©ë²•ì¸ Mann-Whitneyê²€ì •ì„ ì‹¤ì‹œí•œë‹¤.

$$
\begin{aligned}
H_0 &: \ Male \ and \ female \ students\ are\ the\ same\ height.\\ 
H_A &:\  Male\ and\ female\ students\ are\ not\ the\ same\ height. 
\end{aligned}
$$

- Mann-Whitney ê²€ì •ì„ í•˜ê¸° ìœ„í•´ì„œëŠ” ê° ë³€ìˆ˜ì˜ ë­í¬(ìˆœìœ„)ë¥¼ ë§¤ê²¨ì•¼í•˜ê¸° ë•Œë¬¸ì— ì´ë¥¼ êµ¬í•˜ë„ë¡ í•œë‹¤.<br/>
(ì´ ì˜ˆì œì˜ ê²½ìš° ë‚´ë¦¼ì°¨ìˆœìœ¼ë¡œ ìˆœìœ„ë¥¼ êµ¬í–ˆë‹¤. ì–‘ì¸¡ì¼ ê²½ìš° ë¬¸ì œ ì—†ì§€ë§Œ ë‹¨ì¸¡ì¼ ê²½ìš° í†µê³„ëŸ‰ ê°’ì´ ë°”ë€ë‹¤.)

``` r
rank8_11 <- function(data){
  x <- data[,1]
  y <- data[,2]
  h <- as.numeric(rbind(c(x,y)))
  rank <- rank(-h, na.last = "keep")
  gender <- c(rep("m",length(x)),rep("f",length(y)))
  out <- data.frame(h,rank,gender)
  data$rank_m <- subset(out$rank, gender=="m")
  data$rank_f <- subset(out$rank, gender=="f")
  return(data)
}

dat8_11 <- rank8_11(data=ex8_11_cbind)

dat8_11%>%
  kbl(caption = "Result of Rank") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
Result of Rank
</caption>
<thead>
<tr>
<th style="text-align:right;">
Heights of males
</th>
<th style="text-align:right;">
Heights of females
</th>
<th style="text-align:right;">
rank_m
</th>
<th style="text-align:right;">
rank_f
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
193
</td>
<td style="text-align:right;">
178
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:right;">
188
</td>
<td style="text-align:right;">
173
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
8
</td>
</tr>
<tr>
<td style="text-align:right;">
185
</td>
<td style="text-align:right;">
168
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:right;">
183
</td>
<td style="text-align:right;">
165
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
11
</td>
</tr>
<tr>
<td style="text-align:right;">
180
</td>
<td style="text-align:right;">
163
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
12
</td>
</tr>
<tr>
<td style="text-align:right;">
175
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
170
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
NA
</td>
</tr>
</tbody>
</table>

- Mann-Whitney ê²€ì •í†µê³„ëŸ‰ì„ êµ¬í•˜ëŠ” ê³µì‹ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

$$
U=n_1n_2 + \frac{n_1(n_1+1)}{2}-R_1
$$

$$
U'=n_2n_1 + \frac{n_2(n_2+1)}{2}-R_2
$$
- $$U'$$ì„ ì‰½ê²Œ êµ¬í•˜ëŠ” ë°©ë²•ì´ ìˆë‹¤.

$$
U'=n_1n_2-U
$$

- ë³¸ ê²€ì •ì—ì„œ ì„ê³„ê°’ì„ í…Œì´ë¸”ì„ í†µí•´í™•ì¸í•˜ì—¬ ë³´ì.

![](/study/img/ch8/table3.jpg)

- ì–‘ì¸¡ 0.05 n=5,7ì˜ ì„ê³„ê°’ì€ 30ì¸ ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.

``` r
M_W_test <- function(x,y,a,b){
  x <- na.omit(x)
  y <- na.omit(y)
  a <- na.omit(a)
  b <- na.omit(b)
  n1 <- length(x)
  n2 <- length(y)
  r1 <- sum(a) 
  r2 <- sum(b) 
  u <- n1*n2+(n1*(n1+1)/2)-r1
  u_prime <- n1*n2-u
  out <- data.frame(n1,n2,R1=r1,R2=r2,U=u,U_prime=u_prime)
  return(out)
}
```

``` r
M_W_test(dat8_11$`Heights of males`,dat8_11$`Heights of females`,dat8_11$rank_m,dat8_11$rank_f) %>%
  kbl(caption = "Result of Mann-Whitney test") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
Result of Mann-Whitney test
</caption>
<thead>
<tr>
<th style="text-align:right;">
n1
</th>
<th style="text-align:right;">
n2
</th>
<th style="text-align:right;">
R1
</th>
<th style="text-align:right;">
R2
</th>
<th style="text-align:right;">
U
</th>
<th style="text-align:right;">
U_prime
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
3
</td>
</tr>
</tbody>
</table>

$$
U=7*5+\frac{7(7+1)}{2}-31=32
$$

$$
U'=7*5-32=3
$$

- ì´ ê²€ì •ì€ ì–‘ì¸¡ê²€ì •ì´ê¸° ë•Œë¬¸ì— $$U, \ U'$$ ì¤‘ í•˜ë‚˜ê°€ ì„ê³„ê°’ë³´ë‹¤ í¬ê±°ë‚˜ ê°™ìœ¼ë©´ ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•œë‹¤.<br/>
- ì„ê³„ê°’ UëŠ” 30ìœ¼ë¡œ ë‚˜ì™”ê³ , ì„ê³„ê°’ë³´ë‹¤ ì‚°ì¶œëœ $$U$$ í†µê³„ëŸ‰ 32ê°€ ë” í¬ë¯€ë¡œ ìœ ì˜ìˆ˜ì¤€ 5%í•˜ì— ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•  ìˆ˜ ìˆë‹¤.

> ì¦‰, ë‚¨í•™ìƒê³¼ ì—¬í•™ìƒì˜ í‚¤ëŠ” ìœ ì˜ìˆ˜ì¤€ 5%í•˜ì—ì„œ ë‹¤ë¥´ë‹¤ê³  í•  ìˆ˜ ìˆë‹¤.

> ë‹¤ìŒì€ Rì— ë‚´ì¥ëœ wilcox.text() ë¥¼ ì‚¬ìš©í•œ ê²°ê³¼ë¥¼ í™•ì¸í•˜ì—¬ ë³´ì.

``` r
wilcox.test(dat8_11$`Heights of males`, dat8_11$`Heights of females`)
```

    ## 
    ##  Wilcoxon rank sum exact test
    ## 
    ## data:  dat8_11$`Heights of males` and dat8_11$`Heights of females`
    ## W = 32, p-value = 0.01768
    ## alternative hypothesis: true location shift is not equal to 0

- wilcoxon rank sum exact testì˜ p-value=0.018ë¡œ ìœ ì˜ìˆ˜ì¤€ 5%í•˜ì—ì„œ ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•  ìˆ˜ ìˆë‹¤. <br/>
ê·¸ëŸ¬ë¯€ë¡œ ë‚¨í•™ìƒê³¼ ì—¬í•™ìƒì˜ í‚¤ëŠ” ë‹¤ë¥´ë‹¤ê³  í•  ìˆ˜ ìˆë‹¤.

## EXAMPLE 8-12

![](/study/img/ch8/8-12.png)

``` r
#ë°ì´í„°ì…‹
wt <- c(44,48,36,32,51,45,54,56)
wot <- c(32,40,44,44,34,30,26,NA)
ex8_12 <- data.frame(wt,wot)
ex8_12%>%
  kbl(caption = "Dataset",escape=F) %>%
   kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
Dataset
</caption>
<thead>
<tr>
<th style="text-align:right;">
wt
</th>
<th style="text-align:right;">
wot
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
32
</td>
</tr>
<tr>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
40
</td>
</tr>
<tr>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
44
</td>
</tr>
<tr>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
44
</td>
</tr>
<tr>
<td style="text-align:right;">
51
</td>
<td style="text-align:right;">
34
</td>
</tr>
<tr>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
30
</td>
</tr>
<tr>
<td style="text-align:right;">
54
</td>
<td style="text-align:right;">
26
</td>
</tr>
<tr>
<td style="text-align:right;">
56
</td>
<td style="text-align:right;">
NA
</td>
</tr>
</tbody>
</table>

- ê³ ë“±í•™êµì—ì„œ typing í›ˆë ¨ì„ ë°›ì€ ëŒ€í•™ìƒì´ í›ˆë ¨ì„ ë°›ì§€ ì•Šì€ ì‚¬ëŒë³´ë‹¤ í‰ê· ì†ë„ê°€ ì¢‹ì€ì§€ ê²€ì •í•˜ê³ ì í•œë‹¤.<br/>

$$
\begin{aligned}
H_0 &:  Typing\ speed\ is\ not\ greater\ in\ college\ students\ having\ had\ high\ school\ typing\ training. \\
H_A &:  Typing\ speed\ is\ greater\ in\ college\ students\ having\ had\ high\ school\ typing\ training. 
\end{aligned}
$$

- Mann-Whitney ê²€ì •ì„ í•˜ê¸° ìœ„í•´ì„œëŠ” ê° ë³€ìˆ˜ì˜ ë­í¬(ìˆœìœ„)ë¥¼ ë§¤ê²¨ì•¼í•˜ê¸° ë•Œë¬¸ì— ì´ë¥¼ êµ¬í•˜ë„ë¡ í•œë‹¤.<br/>
(ì´ ì˜ˆì œì˜ ê²½ìš° ì˜¤ë¦„ì°¨ìˆœìœ¼ë¡œ ìˆœìœ„ë¥¼ êµ¬í–ˆë‹¤.)<br/>
- ë™ë¥  ìˆœìœ„ ìë£Œê°€ ìˆëŠ” ê²½ìš° ë™ë¥  ìˆœìœ„ì˜ í‰ê·  ìˆœìœ„ë¥¼ ì´ìš©í•œë‹¤.

``` r
rank8_12 <- function(data){
  x <- data[,1]
  y <- data[,2]
  h <- as.numeric(rbind(c(x,y)))
  rank <- rank(h, na.last = "keep")
  gender <- c(rep("m",length(x)),rep("f",length(y)))
  out <- data.frame(h,rank,gender)
  data$rank_m <- subset(out$rank, gender=="m")
  data$rank_f <- subset(out$rank, gender=="f")
  return(data)
}
dat8_12 <- rank8_12(data=ex8_12)

dat8_12%>%
  kbl(caption = "Result of Rank") %>%
   kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
Result of Rank
</caption>
<thead>
<tr>
<th style="text-align:right;">
wt
</th>
<th style="text-align:right;">
wot
</th>
<th style="text-align:right;">
rank_m
</th>
<th style="text-align:right;">
rank_f
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
9.0
</td>
<td style="text-align:right;">
3.5
</td>
</tr>
<tr>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
12.0
</td>
<td style="text-align:right;">
7.0
</td>
</tr>
<tr>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
6.0
</td>
<td style="text-align:right;">
9.0
</td>
</tr>
<tr>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
3.5
</td>
<td style="text-align:right;">
9.0
</td>
</tr>
<tr>
<td style="text-align:right;">
51
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
13.0
</td>
<td style="text-align:right;">
5.0
</td>
</tr>
<tr>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
11.0
</td>
<td style="text-align:right;">
2.0
</td>
</tr>
<tr>
<td style="text-align:right;">
54
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
14.0
</td>
<td style="text-align:right;">
1.0
</td>
</tr>
<tr>
<td style="text-align:right;">
56
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
15.0
</td>
<td style="text-align:right;">
NA
</td>
</tr>
</tbody>
</table>

> ì´ì œ Mann-Whitney ê²€ì •í†µê³„ëŸ‰ì„ êµ¬í•´ ê²€ì •ì„ ì‹¤ì‹œí•˜ë„ë¡ í•œë‹¤.

``` r
M_W_test(dat8_12$wt,dat8_12$wot,dat8_12$rank_m,dat8_12$rank_f) %>%
  kbl(caption = "Result of Mann-Whitney test") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
Result of Mann-Whitney test
</caption>
<thead>
<tr>
<th style="text-align:right;">
n1
</th>
<th style="text-align:right;">
n2
</th>
<th style="text-align:right;">
R1
</th>
<th style="text-align:right;">
R2
</th>
<th style="text-align:right;">
U
</th>
<th style="text-align:right;">
U_prime
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
83.5
</td>
<td style="text-align:right;">
36.5
</td>
<td style="text-align:right;">
8.5
</td>
<td style="text-align:right;">
47.5
</td>
</tr>
</tbody>
</table>

$$
U=8*7+\frac{8(8+1)}{2}-83.5=8.5
$$

$$
U'=8*7-8.5=47.5
$$

- ë³¸ ê²€ì •ì—ì„œ ì„ê³„ê°’ì„ í…Œì´ë¸”ì„ í†µí•´í™•ì¸í•˜ì—¬ ë³´ì.

![](/study/img/ch8/table4.jpg)

- ë‹¨ì¸¡ 0.05 n=7,8ì˜ ì„ê³„ê°’ì€ 43ì¸ ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.

- ì´ ê²€ì •ì€ ë‹¨ì¸¡ê²€ì •ì´ê¸° ë•Œë¬¸ì— ë‹¤ìŒì˜ í‘œë¥¼ í™•ì¸í•˜ì—¬ì•¼ í•œë‹¤. 

![](/study/img/ch8/table5.jpg)

- ì´ ì˜ˆì œëŠ” ì˜¤ë¦„ì°¨ìˆœìœ¼ë¡œ ìˆœìœ„ê°€ ë§¤ê²¨ì ¸ ìˆìœ¼ë©°, í›ˆë ¨ë°›ì€ í•™ìƒì˜ í‰ê· ì†ë„ê°€ ë” ì¢‹ì€ì§€ ê²€ì •í•˜ëŠ” ê²ƒì´ê¸° ë•Œë¬¸ì— í†µê³„ëŸ‰ì„ $$U'$$ì„ ì‚¬ìš©í•œë‹¤.<br/>
- ì„ê³„ê°’ì€ 43ìœ¼ë¡œ ë‚˜ì™”ê³ , ì„ê³„ê°’ë³´ë‹¤ ì‚°ì¶œëœ $$U'$$ í†µê³„ëŸ‰ 47.5ê°€ ë” í¬ë¯€ë¡œ ìœ ì˜ìˆ˜ì¤€ 5%í•˜ì— ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•  ìˆ˜ ìˆë‹¤.

> ì¦‰, ê³ ë“±í•™êµì—ì„œ typing í›ˆë ¨ì„ ë°›ì€ í•™ìƒì€ í›ˆë ¨ì„ ë°›ì§€ ì•Šì€ í•™ìƒë³´ë‹¤ typing í‰ê·  ì†ë„ê°€ ë¹ ë¥´ë‹¤ê³  í•  ìˆ˜ ìˆë‹¤.

> ë‹¤ìŒì€ Rì— ë‚´ì¥ëœ wilcox.text() ë¥¼ ì‚¬ìš©í•œ ê²°ê³¼ë¥¼ í™•ì¸í•˜ì—¬ ë³´ì.

``` r
wilcox.test(dat8_12$wt,na.omit(dat8_12$wot),alternative = "greater")
```

    ## 
    ##  Wilcoxon rank sum test with continuity correction
    ## 
    ## data:  dat8_12$wt and na.omit(dat8_12$wot)
    ## W = 47.5, p-value = 0.0136
    ## alternative hypothesis: true location shift is greater than 0

- wilcoxon rank sum exact testì˜ p-value=0.018ë¡œ ìœ ì˜ìˆ˜ì¤€ 5%í•˜ì—ì„œ ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•  ìˆ˜ ìˆë‹¤. <br/>
ê·¸ëŸ¬ë¯€ë¡œ ë‚¨í•™ìƒê³¼ ì—¬í•™ìƒì˜ í‚¤ëŠ” ë‹¤ë¥´ë‹¤ê³  í•  ìˆ˜ ìˆë‹¤.

## EXAMPLE 8-13

![](/study/img/ch8/8-13.png)

- ë³¸ ë°ì´í„°ëŠ” ë³´ì¶©ì œë¥¼ ì„­ì·¨ ìœ ë¬´ì— ë”°ë¥¸ ë™ë¬¼ë“¤ì˜ ì²´ì¤‘ì„ ê¸°ë¡í•œ ë°ì´í„°ë¡œ ë‹¨ì¸¡ ê²€ì •ì—ì„œì˜ Mann-Whitney ê²€ì •ì„ ì‹¤ì‹œí•  ë•Œì˜ ì •ê·œ ê·¼ì‚¬ë¥¼ ë³´ì—¬ì£¼ëŠ” ì˜ˆì‹œì´ë‹¤. <br/>
- Mann-Whitney ê²€ì •ì—ì„œ ë‘ ê·¸ë£¹ì˜ í‘œë³¸ì´ 20 ì´ìƒì´ê³  ë‘ í‘œë³¸ì˜ í¬ê¸° í•©ì´ 40ì´ìƒì¼ ê²½ìš° ì •ê·œ ê·¼ì‚¬ê°€ ê°€ëŠ¥í•˜ë‹¤. <br/>
- ê° í‘œë³¸ì˜ sample sizwëŠ” 20ì„ ë„˜ì–´ Mann-Whitneyì˜ ì •ê·œê·¼ì‚¬ë¥¼ ì´ìš©í•˜ì—¬ ê²€ì •ì„ ìˆ˜í–‰í•˜ì˜€ë‹¤.<br/>

$$
\begin{aligned}
H_0 &: Body\ weight\ of\ animals\ on\ the\ supplemented\ diet\ are\ not\ greater\ than\ those\ on\ the\ unsupplemented\ diet. \\
H_A &: Body\ weight\ of\ animals\ on\ the\ supplemented\ diet\ are\ greater\ than\ those\ on\ the\ unsupplemented\ diet.
\end{aligned}
$$

> Mann-Whitneyì˜ ì •ê·œê·¼ì‚¬ë¥¼ ìœ„í•œ í†µê³„ëŸ‰ 

$$
\mu_U=\frac{n_1n_2}{2} \ (=\frac{U+U'}{2}), \ \sigma_U=\sqrt{\frac{n_1n_1(N+1)}{12}}
$$

$$
\rightarrow \space Z= \frac{U-\mu_U}{\sigma_U}\ \sim\ N(0,1) 
$$
- $$n_1=22,\ n_2=46,\ N=68,\ U=282$$ ê°€ ì£¼ì–´ì¡Œì„ ë•Œ ê²€ì •ì„ í•´ë³´ë„ë¡ í•œë‹¤. 

``` r
Normal_Approximation_M_W_test<-function(n1,n2,u){
  u_prime<-(n1*n2)-u
  mu<-(n1*n2)/2
  sig<-sqrt(((n1*n2)*(n1+n2+1))/12)
  z<-(u_prime -mu)/sig
  pvalue <- 1-pnorm(z)
  if(pvalue < 0.05){
    Reject_H0 <- "yes"
  }else{
    Reject_H0 <- "No"
  }
  out <- data.frame(u_prime,mu,sig=round(sig,2),z=round(z,2),p_value=round(pvalue,4),Reject_H0)
  return(out)
}
```

``` r
Normal_Approximation_M_W_test(22,46,282) %>%
  kbl(caption = "Result of Mann-Whitney test (Normal approxiation)") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
Result of Mann-Whitney test (Normal approxiation)
</caption>
<thead>
<tr>
<th style="text-align:right;">
u_prime
</th>
<th style="text-align:right;">
mu
</th>
<th style="text-align:right;">
sig
</th>
<th style="text-align:right;">
z
</th>
<th style="text-align:right;">
p_value
</th>
<th style="text-align:left;">
Reject_H0
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
730
</td>
<td style="text-align:right;">
506
</td>
<td style="text-align:right;">
76.28
</td>
<td style="text-align:right;">
2.94
</td>
<td style="text-align:right;">
0.0017
</td>
<td style="text-align:left;">
yes
</td>
</tr>
</tbody>
</table>

- ì´ ì˜ˆì œëŠ” ì˜¤ë¦„ì°¨ìˆœìœ¼ë¡œ ìˆœìœ„ê°€ ë§¤ê²¨ì ¸ ìˆìœ¼ë©°, ìŒì‹ ë³´ì¶©ì œë¥¼ ì„­ì·¨í•œ ë™ë¬¼ì˜ ì²´ì¤‘ì´ ìŒì‹ ë³´ì¶©ì œë¥¼ ì„­ì·¨í•˜ì§€ ì•Šì€ ë™ë¬¼ì˜ ì²´ì¤‘ë³´ë‹¤ í°ì§€ ê²€ì •í•˜ëŠ” ê²ƒì´ê¸° ë•Œë¬¸ì— í†µê³„ëŸ‰ì„ $$U'$$ì„ ì‚¬ìš©í•œë‹¤.<br/>
- ì‚°ì¶œëœ í†µê³„ëŸ‰ì„ ì´ìš©í•˜ì—¬ $$Z=\frac{U'-\mu_U}{\sigma_U}=2.94$$ì´ê³ , í‘œì¤€ì •ê·œë¶„í¬ì—ì„œ ìœ ì˜ìˆ˜ì¤€ 5% ë‹¨ì¸¡ê²€ì • ì„ê³„ê°’ì€ 1.6449ì´ë‹¤.<br/>
ê³„ì‚°ëœ í†µê³„ëŸ‰ ê°’ì´ ì„ê³„ê°’ ë³´ë‹¤ í¬ê³ , ê¸°ê°ì—­ì— í¬í•¨ë˜ë¯€ë¡œ ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•  ìˆ˜ ìˆë‹¤.<br/>
- ë”°ë¼ì„œ ìŒì‹ ë³´ì¶©ì œë¥¼ ì„­ì·¨í•œ ë™ë¬¼ì˜ ì²´ì¤‘ì€ ìŒì‹ ë³´ì¶©ì œë¥¼ ì„­ì·¨í•˜ì§€ ì•Šì€ ë™ë¬¼ì˜ ì²´ì¤‘ë³´ë‹¤ ë§ì´ ë‚˜ê°„ë‹¤ê³  ë§í•  ìˆ˜ ìˆë‹¤.

## EXAMPLE 8-14

![](/study/img/ch8/8-14.png)

- ì—°ì†í˜• ë°ì´í„°ê°€ ì•„ë‹Œ ìˆœì„œ(ìˆœìœ„)ë§Œ ìˆëŠ” ë°ì´í„°ì˜ ê²€ì •ì„ í•´ë³´ë„ë¡ í•œë‹¤. <br/>
- ë³¸ ë°ì´í„°ëŠ” ìˆ˜ì—… ì¡°êµì— ë”°ë¥¸ í•™ìƒë“¤ì˜ ì„±ì  ë“±ê¸‰ì„ ê¸°ë¡í•œ ë°ì´í„°ë¡œ ìˆ˜ì—… ì¡°êµì— ë”°ë¥¸ í•™ìƒë“¤ì˜ ë“±ê¸‰ì´ ê°™ì€ì§€ ë‹¤ë¥¸ì§€ ê²€ì •í•´ë³´ë„ë¡ í•œë‹¤.

``` r
A <- c(3,3,3,6,10,10,13.5,13.5,16.5,16.5,19.5,NA,NA,NA)
B <- c(3,3,7.5,7.5,10,12,16.5,16.5,19.5,22.5,22.5,22.5,22.5,25)
ex8_14 <- data.frame(A,B)
ex8_14%>%
  kbl(caption = "Dataset",escape=F) %>%
   kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
Dataset
</caption>
<thead>
<tr>
<th style="text-align:right;">
A
</th>
<th style="text-align:right;">
B
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
3.0
</td>
<td style="text-align:right;">
3.0
</td>
</tr>
<tr>
<td style="text-align:right;">
3.0
</td>
<td style="text-align:right;">
3.0
</td>
</tr>
<tr>
<td style="text-align:right;">
3.0
</td>
<td style="text-align:right;">
7.5
</td>
</tr>
<tr>
<td style="text-align:right;">
6.0
</td>
<td style="text-align:right;">
7.5
</td>
</tr>
<tr>
<td style="text-align:right;">
10.0
</td>
<td style="text-align:right;">
10.0
</td>
</tr>
<tr>
<td style="text-align:right;">
10.0
</td>
<td style="text-align:right;">
12.0
</td>
</tr>
<tr>
<td style="text-align:right;">
13.5
</td>
<td style="text-align:right;">
16.5
</td>
</tr>
<tr>
<td style="text-align:right;">
13.5
</td>
<td style="text-align:right;">
16.5
</td>
</tr>
<tr>
<td style="text-align:right;">
16.5
</td>
<td style="text-align:right;">
19.5
</td>
</tr>
<tr>
<td style="text-align:right;">
16.5
</td>
<td style="text-align:right;">
22.5
</td>
</tr>
<tr>
<td style="text-align:right;">
19.5
</td>
<td style="text-align:right;">
22.5
</td>
</tr>
<tr>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
22.5
</td>
</tr>
<tr>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
22.5
</td>
</tr>
<tr>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
25.0
</td>
</tr>
</tbody>
</table>

``` r
rank_M_W_test <- function(x,y){
  x <- na.omit(x)
  y <- na.omit(y)
  n1 <- length(x)
  n2 <- length(y)
  r1 <- sum(x) 
  r2 <- sum(y) 
  u <- n1*n2+(n1*(n1+1)/2)-min(r1,r2)
  u_prime <- n1*n2-u
  out <- data.frame(n1,n2,R1=r1,R2=r2,U=u,U_prime=u_prime)
  return(out)
}
```

``` r
rank_M_W_test(ex8_14$A,ex8_14$B)%>%
  kbl(caption = "Result of Mann-Whitney test (Normal approxiation)") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
Result of Mann-Whitney test (Normal approxiation)
</caption>
<thead>
<tr>
<th style="text-align:right;">
n1
</th>
<th style="text-align:right;">
n2
</th>
<th style="text-align:right;">
R1
</th>
<th style="text-align:right;">
R2
</th>
<th style="text-align:right;">
U
</th>
<th style="text-align:right;">
U_prime
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
114.5
</td>
<td style="text-align:right;">
210.5
</td>
<td style="text-align:right;">
105.5
</td>
<td style="text-align:right;">
48.5
</td>
</tr>
</tbody>
</table>

- $$U$$ í†µê³„ëŸ‰ì€ ì£¼ì–´ì§„ ê³µì‹ì— ë”°ë¼ $$U, U'$$ì„ ëª¨ë‘ êµ¬í•˜ê³  ë‘˜ ì¤‘ í° ê°’ì„ $$U$$ í†µê³„ëŸ‰ìœ¼ë¡œ í•œë‹¤.**

- ê³„ì‚° ê²°ê³¼ $$U=105.5, \ U'=48.5$$ë¡œ $$U$$ê°’ì´ ë” í¬ê¸° ë•Œë¬¸ì— í†µê³„ëŸ‰ì€ 105.5ê°€ ëœë‹¤.

![](/study/img/ch8/table6.jpg)

- ì„ê³„ê°’ì€ U_0.05(11,14)=114ì´ë¯€ë¡œ í†µê³„ëŸ‰ì´ ì„ê³„ê°’ë³´ë‹¤ ì‘ì•„ ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•  ìˆ˜ ì—†ê³  ë”°ë¼ì„œ ì–´ì‹œìŠ¤í„´íŠ¸ì— ë”°ë¼ í•™ìƒë“¤ì˜ í•™ì—… ì„±ì·¨ë„ê°€ ë‹¤ë¥´ë‹¤ê³  ë§í•  ìˆ˜ ì—†ë‹¤.**

> ë‹¤ìŒì€ Rì— ë‚´ì¥ëœ wilcox.text() ë¥¼ ì‚¬ìš©í•œ ê²°ê³¼ì´ë‹¤.

``` r
wilcox.test(na.omit(ex8_14$A),ex8_14$B,alternative = "two.sided")
```

    ## 
    ##  Wilcoxon rank sum test with continuity correction
    ## 
    ## data:  na.omit(ex8_14$A) and ex8_14$B
    ## W = 48.5, p-value = 0.1219
    ## alternative hypothesis: true location shift is not equal to 0

- wil.cox testë¥¼ ì´ìš©í•´ ê²€ì •í•  ìˆ˜ë„ ìˆìœ¼ë©° íŒ¨í‚¤ì§€ë¥¼ ì´ìš©í•´ wilcox.testê²€ì •ì„ ì§„í–‰í•œ ê²°ê³¼ p-valueê°€ 0.1219ë¡œ ìœ ì˜ìˆ˜ì¤€ 0.05ë³´ë‹¤ í¬ê¸° ë•Œë¬¸ì— ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•  ìˆ˜ ì—†ë‹¤.

## EXAMPLE 8-15

![](/study/img/ch8/8-15.png)

- Example 8.14 ë°ì´í„°ë¥¼ ì‚¬ìš©í•´ì„œ ì¤‘ìœ„ìˆ˜ ê²€ì •ì„ ì‹¤ì‹œí•´ë³´ë„ë¡ í•œë‹¤.

$$
\begin{aligned}
H_0 &: The\ median\ performance\ is\ the\ same\ under\ the\ two\ teaching\ assistants.\\
H_A &: The\ median\ of\ the\ two\ sampled\ populations\ are\ not\ equal.
\end{aligned}

$$

``` r
data <- c(na.omit(ex8_14$A),ex8_14$B)
ex8_15 <- data.frame(data)
ex8_15$number <- ifelse(ex8_15$data > median(ex8_15$data) ,
                         ex8_15$number <- "Not above Median",ifelse(ex8_15$data == median(ex8_15$data),NA,ex8_15$number <- "Above Median"))
group<-c(rep("Sample 1",11), rep("Sample 2",14))
ex8_15$group <- group
ex8_15 <- na.omit(ex8_15)
table(ex8_15$number,ex8_15$group)%>%
  kbl(caption = "Result of Mann-Whitney test") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive")) 
```

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
Result of Mann-Whitney test
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Sample 1
</th>
<th style="text-align:right;">
Sample 2
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Above Median
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:left;">
Not above Median
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
8
</td>
</tr>
</tbody>
</table>

- êµì°¨í‘œë¥¼ ë³´ë©´ 1ë²ˆ ê·¸ë£¹ì—ì„  ì¤‘ìœ„ìˆ˜ë¥¼ ë„˜ëŠ” í•™ìƒì´ 6ëª…ì´ê³  ë„˜ì§€ ì•ŠëŠ” í•™ìƒì´ 3ëª…ì´ë©°, 2ë²ˆ ê·¸ë£¹ì—ì„œëŠ” 6ëª…ê³¼ 8ëª…ì´ë‹¤.<br/>
- ì¤‘ìœ„ìˆ˜ ê²€ì •ì„ í•˜ê¸° ìœ„í•´ pearson ì¹´ì´ì œê³± ê²€ì •ì„ ì‹¤ì‹œí•œë‹¤. ì¹´ì´ì œê³± ê²€ì •ì„ í•˜ê¸° ìœ„í•œ ê²€ì •í†µê³„ëŸ‰ ê³µì‹ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

$$
\chi_c^2 = \frac{n\ (|f_{11}f_{22}\ -\ f_{12}f_{21}|\ -\ \frac{n}{2})^2}{(C_1)(C_2)(R_1)(R_2)} \ \sim \chi_1^2
$$

``` r
chi_square_test<- function(table){
  tab <- table
  f11 <- tab[1,1]
  f22 <- tab[2,2]
  f12 <- tab[1,2]
  f21 <- tab[2,1]
  C1 <- sum(tab[,1])
  C2 <- sum(tab[,2])
  R1 <- sum(tab[1,])
  R2 <- sum(tab[2,])
  n <- sum(R1,R2)
  chis <- (n*(abs(f11*f22-f12*f21)-(n/2))^2)/(C1*C2*R1*R2)
  pvalue <- min(pchisq(chis,1),1-pchisq(chis,1))
  out <- data.frame(chi=round(chis,3),pvalue=round(pvalue,2))
  return(out)
}

chi_square_test(table(ex8_15$number,ex8_15$group))%>%
  kbl(caption = "Result of Chi-square test") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
Result of Chi-square test
</caption>
<thead>
<tr>
<th style="text-align:right;">
chi
</th>
<th style="text-align:right;">
pvalue
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.473
</td>
<td style="text-align:right;">
0.49
</td>
</tr>
</tbody>
</table>

- ë¹ˆë„í‘œë¥¼ ìƒì„±í•˜ì—¬ ì‚°ì¶œí•œ í†µê³„ëŸ‰ì€ 0.473ì´ê³ , ììœ ë„ê°€ 1ì¸ ì¹´ì´ì œê³± í†µê³„ëŸ‰ì€ 3.841ì„ì„ ì•Œ ìˆ˜ ìˆë‹¤.<br/>
- í†µê³„ëŸ‰ì´ ê¸°ê°ì—­ì— í¬í•¨ë˜ì§€ ì•Šìœ¼ë¯€ë¡œ ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•  ìˆ˜ ì—†ë‹¤.<br/>
- ì¦‰, ê°™ì€  ëª¨ì§‘ë‹¨ìœ¼ë¡œë¶€í„°  ì¶”ì¶œëœ  ë‘  í‘œë³¸ì˜  ì¤‘ìœ„ìˆ˜ëŠ”  ë‹¤ë¥´ë‹¤ê³  í•  ìˆ˜ ì—†ë‹¤.<br/>
- ê·¸ëŸ¬ë¯€ë¡œ ìˆ˜ì—… ì¡°êµì— ë”°ë¥¸ í•™ìƒë“¤ì˜ ì„±ì  ë“±ê¸‰ì˜ ì¤‘ìœ„ìˆ˜ê°€ ë‹¤ë¥´ë‹¤ê³  í•  ìˆ˜ ì—†ë‹¤.

> RVAideMemoire íŒ¨í‚¤ì§€ ë‚´ì— ìˆëŠ” mood.medtest() í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•œ ê²°ê³¼ë¥¼ í™•ì¸í•˜ì—¬ ë³´ì.

``` r
library(RVAideMemoire)
mood.medtest(ex8_15$data~ex8_15$group,exact=F)
```

    ## 
    ##  Mood's median test
    ## 
    ## data:  ex8_15$data by ex8_15$group
    ## X-squared = 0.47329, df = 1, p-value = 0.4915

## EXAMPLE 8-16

![](/study/img/ch8/8-16.png)
![](/study/img/ch8/8-16-1.png)

``` r
Michigan <- c(47,35,7,5,3,2)
Louisiana <- c(48,23,11,13,8,2)
ex8_16 <- data.frame(Michigan,Louisiana)
ex8_16%>%
  kbl(caption = "Dataset",escape=F) %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
Dataset
</caption>
<thead>
<tr>
<th style="text-align:right;">
Michigan
</th>
<th style="text-align:right;">
Louisiana
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
48
</td>
</tr>
<tr>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
23
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
11
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
13
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
8
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
</tr>
</tbody>
</table>

- ì´ ë°ì´í„°ëŠ” ë¯¸ì‹œê°„ ë¸”ë£¨ì œì´ìŠ¤ì˜ ì‹ë‹¨ì—ì„œ ì‹ë¬¼ì„± ì‹í’ˆì˜ ë¹ˆë„ì™€ ë£¨ì´ì§€ì• ë‚˜ ë¸”ë£¨ì œì´ìŠ¤ì˜ ì‹ë‹¨ì—ì„œ ì‹ë¬¼ì„± ì‹í’ˆì˜ ë¹ˆë„ ë°ì´í„°ì´ë‹¤.<br/>
- ë…ë¦½ì ì¸ ë‘ê°œì˜ í‘œë³¸ì— ëŒ€í•˜ì—¬ ë‹¤ì–‘ì„± ì§€ìˆ˜ ì°¨ì´ë¥¼ ê²€ì •í•˜ê¸° ìœ„í•´ì„œëŠ” Shannon index H ë¥¼ êµ¬í•˜ê³  í—ˆì¹˜ìŠ¨ì´ ì œì•ˆí•œ ê²€ì •í†µê³„ëŸ‰ì„ êµ¬í•˜ì—¬ ê²€ì •ì„ ì§„í–‰í•˜ì—¬ì•¼ í•œë‹¤.

$$
\begin{aligned}
H_0 &: H_1 = H_2\\
H_A &: H_1 \ne H_2
\end{aligned}
$$

- í†µê³„ëŸ‰ë“¤ì„ êµ¬í•˜ëŠ” ê³µì‹ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.
  
  
$$
\begin{aligned}
H' &= \frac{n\ \log n\ -\ \sum f_i \log f_i}{n}\\
s_{H'}^2 &=\frac{\sum f_i \log^2 f_i\ -\ (\sum f_i \log^2 f_i)^2/n}{n^2}\\
s_{H_1'-H_2'} &= \sqrt{s_{H_1'}^2+s_{H_2'}^2}\\
t &= \frac{H_1'-H_2'}{s_{H_1'-H_2'}} \sim t(\nu)\\
\nu&=\frac{(s_{H_1'}^2+s_{H_2'}^2)^2}{\frac{(s_{H_1'})^2}{n_1}+\frac{(s_{H_2'})^2}{n_2}}
\end{aligned}
$$

``` r
H_test<- function(x,y){
  n1 <- sum(x)
  filog_1 <- sum(x*log10(x))
  filog2_1 <- sum(x*log10(x)^2)
  h1 <- (n1*log10(n1)-filog_1)/n1
  sh1 <- (filog2_1-(filog_1^2/n1))/n1^2
  n2 <- sum(y)
  filog_2 <- sum(y*log10(y))
  filog2_2 <- sum(y*log10(y)^2)
  h2 <- (n2*log10(n2)-filog_2)/n2
  sh2 <- (filog2_2-(filog_2^2/n2))/n2^2
  s_h1_h2 <- sqrt(sh1+sh2)
  t <- (h1-h2)/s_h1_h2
  v <- (sh1+sh2)^2/( (sh1^2/n1) + (sh2^2/n2) )
  pvalue <- 2*min(pt(t,v),1-pt(t,v))
  if(pvalue < 0.05){
    Reject_H0 <- "yes"
  }else{
    Reject_H0 <- "No"
  }
  out <- data.frame(h1=round(h1,4),h2=round(h2,4),sh1,sh2,s_h1_h2=round(s_h1_h2,4),t=round(t,3),v=round(v),p_value=round(pvalue,3),Reject_H0)
  return(out)
}
```

``` r
H_test(ex8_16$Michigan,ex8_16$Louisiana)%>%
  kbl(caption = "Result of indices of diversity") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive")) 
```

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
Result of indices of diversity
</caption>
<thead>
<tr>
<th style="text-align:right;">
h1
</th>
<th style="text-align:right;">
h2
</th>
<th style="text-align:right;">
sh1
</th>
<th style="text-align:right;">
sh2
</th>
<th style="text-align:right;">
s_h1_h2
</th>
<th style="text-align:right;">
t
</th>
<th style="text-align:right;">
v
</th>
<th style="text-align:right;">
p_value
</th>
<th style="text-align:left;">
Reject_H0
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.5403
</td>
<td style="text-align:right;">
0.6328
</td>
<td style="text-align:right;">
0.001376
</td>
<td style="text-align:right;">
0.0009692
</td>
<td style="text-align:right;">
0.0484
</td>
<td style="text-align:right;">
-1.909
</td>
<td style="text-align:right;">
196
</td>
<td style="text-align:right;">
0.058
</td>
<td style="text-align:left;">
No
</td>
</tr>
</tbody>
</table>

> ë‹¤ì–‘ì„± ì§€ìˆ˜ $$H$$ ëŠ” vegan íŒ¨í‚¤ì§€ì— ìˆëŠ” diversity() í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ì„œë„ ê³„ì‚°ì´ ê°€ëŠ¥í•˜ë‹¤.

``` r
library(vegan)
h1_1<-diversity(ex8_16$Michigan, index="shannon", base=10)
h2_2<-diversity(ex8_16$Louisiana, index="shannon", base=10)
c(round(h1_1,4),round(h2_2,4))==c(H_test(ex8_16$Michigan,ex8_16$Louisiana)$h1,H_test(ex8_16$Michigan,ex8_16$Louisiana)$h2)
```

    ## [1] TRUE TRUE

``` r
cat(" diversity() í•¨ìˆ˜ë¡œ êµ¬í•œ ë‹¤ì–‘ì„± ì§€ìˆ˜ : H1 = ",round(h1_1,4),"  H2 = ",round(h2_2,4),"\n",
    "ì§ì ‘ ì½”ë”©í•œ í•¨ìˆ˜ë¡œ êµ¬í•œ ë‹¤ì–‘ì„± ì§€ìˆ˜ : H1 = ",H_test(ex8_16$Michigan,ex8_16$Louisiana)$h1,"  H2 = ",H_test(ex8_16$Michigan,ex8_16$Louisiana)$h2,"\n",
    "ë‘ ë‹¤ì–‘ì„± ì§€ìˆ˜ê°€ ë™ì¼í•œê°€?  H1 : ",round(h1_1,4)==H_test(ex8_16$Michigan,ex8_16$Louisiana)$h1,"   H2 : ",round(h2_2,4)==H_test(ex8_16$Michigan,ex8_16$Louisiana)$h2)
```

    ##  diversity() í•¨ìˆ˜ë¡œ êµ¬í•œ ë‹¤ì–‘ì„± ì§€ìˆ˜ : H1 =  0.5403   H2 =  0.6328 
    ##  ì§ì ‘ ì½”ë”©í•œ í•¨ìˆ˜ë¡œ êµ¬í•œ ë‹¤ì–‘ì„± ì§€ìˆ˜ : H1 =  0.5403   H2 =  0.6328 
    ##  ë‘ ë‹¤ì–‘ì„± ì§€ìˆ˜ê°€ ë™ì¼í•œê°€?  H1 :  TRUE    H2 :  TRUE

- ë‹¤ì–‘ì„± ì§€ìˆ˜ ê²€ì • ê²°ê³¼ ê²€ì •í†µê³„ëŸ‰ $$t=-1.909$$ ì´ê³  $$p-value=0.058$$ë¡œ ìœ ì˜ìˆ˜ì¤€ 0.05ë³´ë‹¤ í¬ë¯€ë¡œ ê·€ë¬´ê°€ì„¤ $$H_0$$ ë¥¼ ê¸°ê°í•  ì¶©ë¶„í•œ ê·¼ê±°ë¥¼ ê°€ì§€ê³  ìˆì§€ ì•Šë‹¤.<br/>
- ë‘ Shannon indexë¥¼ ë¹„êµí•´ë„ ë¯¸ì‹œê°„ ì£¼ëŠ” 0.5403, ë£¨ì´ì§€ì• ë‚˜ëŠ” 0.6328ë¡œ ë£¨ì´ì§€ì• ë‚˜ì˜ ì‹ë¬¼ì„± ì‹í’ˆì— ëŒ€í•œ ì¢… ë¶€ìœ ë„ì™€ ì¢… ê· ë“±ë„ê°€ í¬ë‹¤ê³  í• ìˆ˜ ìˆê² ì§€ë§Œ ë‹¤ì–‘ì„± ì§€ìˆ˜ ê²€ì • ê²°ê³¼ ë¯¸ì‹œê°„ ì£¼ì™€ ë£¨ì´ì§€ì• ë‚˜ ì£¼ì˜ ë‹¤ì–‘ì„± ì§€ìˆ˜ê°€ ê°™ì§€ ì•Šë‹¤ëŠ” ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•  ì¶©ë¶„í•œ ê·¼ê±°ê°€ ì—†ë‹¤.<br/>
- ê·¸ëŸ¬ë¯€ë¡œ ë¯¸ì‹œê°„ì£¼ì™€ ë£¨ì´ì§€ì• ë‚˜ ì£¼ì˜ ë‹¤ì–‘ì„± ì§€ìˆ˜ëŠ” ê°™ì§€ ì•Šë‹¤ëŠ” ì¶©ë¶„í•œ ê·¼ê±°ê°€ ì—†ë‹¤.

</div>
</details>

<br/>

# SAS í”„ë¡œê·¸ë¨ ê²°ê³¼

<details>
<summary>
SAS ì ‘ê¸°/í¼ì¹˜ê¸° ë²„íŠ¼
</summary>
<div markdown="1">

```python
import saspy #SASì¶œë ¥ ì½”ë“œ
```

winlocal ì…ë ¥

## 8ì¥


</div>
</details>

<br/>

<br/>

<font color='#fb8072'>êµì¬: Biostatistical Analysis (5th Edition) by Jerrold H. Zar</font><br/>

<font color='#fb8072'> **ì´ ê¸€ì€ 22í•™ë…„ë„ 1í•™ê¸° ì˜í•™í†µê³„ë°©ë²•ë¡  ê³¼ì œ ìë£Œë“¤ì„ ì •ë¦¬í•œ ê¸€ ì…ë‹ˆë‹¤.** </font>