---
layout: post
title:  "[ì˜í•™í†µê³„ë°©ë²•ë¡ ] Ch19. Simple Linear Correlation"
category:
    - Study
    - ì˜í•™í†µê³„ë°©ë²•ë¡ 
tag: [R, SAS, blog, jekyll, Jupyter, Data, Python]
toc: true
---
* this unordered seed list will be replaced by the toc
{:toc}

- ë’¤ë¡œê°€ê¸°ë¥¼ ëˆ„ë¥´ì‹œë©´ ëª©ì°¨ë¡œ ë˜ëŒì•„ì˜µë‹ˆë‹¤. ğŸ˜‰

# Simple Linear Correlation

> [ì˜ˆì œ ë°ì´í„° ë§í¬ ë°”ë¡œê°€ê¸°](https://github.com/James1verse27/James1verse27.github.io/tree/main/study/data/ì˜í•™í†µê³„ë°©ë²•ë¡ /ch19)

# R í”„ë¡œê·¸ë¨ ê²°ê³¼

<details>
<summary>
R ì ‘ê¸°/í¼ì¹˜ê¸° ë²„íŠ¼
</summary>
<div markdown="1">

**íŒ¨í‚¤ì§€**
<details>
<summary>
ì„¤ì¹˜ëœ íŒ¨í‚¤ì§€ ì ‘ê¸°/í¼ì¹˜ê¸° ë²„íŠ¼
</summary>

<div markdown="1">

``` r
getwd()
```

    ## [1] "C:/Biostat"

``` r
library("foreign")
library("dplyr")
library("kableExtra")
library("GGally")
library("DescTools")
library("confintr")
library("diffcor")
library("remotes")
library("cower")
library("gtools")
library("psych")
library("ltm")
library("irr")
```

</div>
</details>

## 19ì¥

**19ì¥ ì—°ìŠµë¬¸ì œ ë¶ˆëŸ¬ì˜¤ê¸°**

``` r
ex19_1a <- read.spss('Exam 19.1A.sav', to.data.frame=T)
ex19_12<- read.spss('Exam 19.12.sav', to.data.frame=T)
ex19_13<- read.spss('Exam 19.13.sav', to.data.frame=T)
ex19_14<- read.spss('Exam 19.14.sav', to.data.frame=T)
ex19_15<- read.spss('Exam 19.15.sav', to.data.frame=T)
ex19_16<- read.spss('Exam 19.16.sav', to.data.frame=T)
ex19_17<- read.spss('Exam 19.17.sav', to.data.frame=T)
ex19_18<- read.spss('Exam 19.18.sav', to.data.frame=T)
```

### EXAMPLE 19.1a

![](/study/img/ì˜í•™í†µê³„ë°©ë²•ë¡ /ch19/19-1a.png)

``` r
#ë°ì´í„°ì…‹
ex19_1a %>%
  kbl(caption = "Dataset",escape=F) %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
Dataset
</caption>
<thead>
<tr>
<th style="text-align:right;">
WingLeingth
</th>
<th style="text-align:right;">
TailLength
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
10.4
</td>
<td style="text-align:right;">
7.4
</td>
</tr>
<tr>
<td style="text-align:right;">
10.8
</td>
<td style="text-align:right;">
7.6
</td>
</tr>
<tr>
<td style="text-align:right;">
11.1
</td>
<td style="text-align:right;">
7.9
</td>
</tr>
<tr>
<td style="text-align:right;">
10.2
</td>
<td style="text-align:right;">
7.2
</td>
</tr>
<tr>
<td style="text-align:right;">
10.3
</td>
<td style="text-align:right;">
7.4
</td>
</tr>
<tr>
<td style="text-align:right;">
10.2
</td>
<td style="text-align:right;">
7.1
</td>
</tr>
<tr>
<td style="text-align:right;">
10.7
</td>
<td style="text-align:right;">
7.4
</td>
</tr>
<tr>
<td style="text-align:right;">
10.5
</td>
<td style="text-align:right;">
7.2
</td>
</tr>
<tr>
<td style="text-align:right;">
10.8
</td>
<td style="text-align:right;">
7.8
</td>
</tr>
<tr>
<td style="text-align:right;">
11.2
</td>
<td style="text-align:right;">
7.7
</td>
</tr>
<tr>
<td style="text-align:right;">
10.6
</td>
<td style="text-align:right;">
7.8
</td>
</tr>
<tr>
<td style="text-align:right;">
11.4
</td>
<td style="text-align:right;">
8.3
</td>
</tr>
</tbody>
</table>

- í•´ë‹¹ ë°ì´í„°ëŠ” ìƒˆì˜ ë‚ ê°œì˜ ê¸¸ì´ì™€ ê¼¬ë¦¬ì˜ ê¸¸ì´ë¥¼ ì¸¡ì •í•œ ëŒ€í•œ ë°ì´í„°ì´ë‹¤.<br/>
- ìƒˆì˜ ë‚ ê°œì˜ ê¸¸ì´ì™€ ê¼¬ë¦¬ì˜ ê¸¸ì´ì— ëŒ€í•˜ì—¬ ìƒê´€ê³„ìˆ˜ì™€ ê²°ì •ê³„ìˆ˜ë¥¼ êµ¬í•˜ì—¬ ë³´ê² ë‹¤.

``` r
wing<-ex19_1a$WingLeingth
tail<-ex19_1a$TailLength

n=nrow(ex19_1a) ; 
sum_X=sum(wing) ; #x
sum_X2=sum(wing^2) ; #xx
sum_x2=sum((wing-mean(wing))^2) ; #x2

sum_Y=sum(tail) ; #y
sum_Y2=sum(tail^2)
sum_y2=sum((tail-mean(tail))^2) ; #y2
sum_XY=sum(wing*tail) ; #xxyy
sum_xy=sum((wing-mean(wing))*(tail-mean(tail))) ; #xy
r=sum_xy/sqrt(sum_x2*sum_y2) ; #r
r2=r^2

cbind(n, sum_X, sum_X2, sum_x2, sum_Y, sum_Y2, sum_y2, sum_XY, sum_xy, r, r2) %>%
  kbl(caption = "Dataset",escape=F) %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
Dataset
</caption>
<thead>
<tr>
<th style="text-align:right;">
n
</th>
<th style="text-align:right;">
sum_X
</th>
<th style="text-align:right;">
sum_X2
</th>
<th style="text-align:right;">
sum_x2
</th>
<th style="text-align:right;">
sum_Y
</th>
<th style="text-align:right;">
sum_Y2
</th>
<th style="text-align:right;">
sum_y2
</th>
<th style="text-align:right;">
sum_XY
</th>
<th style="text-align:right;">
sum_xy
</th>
<th style="text-align:right;">
r
</th>
<th style="text-align:right;">
r2
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
128.2
</td>
<td style="text-align:right;">
1371.32
</td>
<td style="text-align:right;">
1.716667
</td>
<td style="text-align:right;">
90.8
</td>
<td style="text-align:right;">
688.4
</td>
<td style="text-align:right;">
1.346667
</td>
<td style="text-align:right;">
971.37
</td>
<td style="text-align:right;">
1.323333
</td>
<td style="text-align:right;">
0.8703546
</td>
<td style="text-align:right;">
0.7575171
</td>
</tr>
</tbody>
</table>

- Pearsonì˜ ìƒê´€ê³„ìˆ˜ëŠ” ì •ê·œì„± ê°€ì •ì—ì„œ ì¶œë°œí•˜ì§€ ì•Šì•˜ìœ¼ë©°, ì •ê·œë¶„í¬ë¥¼ ë”°ë¥´ì§€ ì•Šë”ë¼ë„ 1ì°¨ ì„ í˜•ì ì¸ ì—°ê´€ì„±ì´ ê°•í•˜ë‹¤ë©´ êµ¬í•  ìˆ˜ ìˆë‹¤.<br/>
- ê·¸ë˜í”„ë¥¼ ê·¸ë ¤ì„œ ì„ í˜•ì„±ì„ í™•ì¸í•˜ì—¬ ë³´ì.

``` r
plot(ex19_1a$WingLeingth,ex19_1a$TailLength,xlab = "Wing Length",ylab="Tail Length",main="Correlation",pch=19,col="#8dd3c7")
abline(lm(ex19_1a$TailLength ~ ex19_1a$WingLeingth), col = "#ffffb3", lwd = 4)
text(paste("Correlation:", round(r, 4)), x = 10.4, y = 8)
```

![](/study/img/ì˜í•™í†µê³„ë°©ë²•ë¡ /unnamed-chunk-5-1.png)

``` r
library("GGally")
ggpairs(ex19_1a, colums=1:2)
```

![](/study/img/ì˜í•™í†µê³„ë°©ë²•ë¡ /unnamed-chunk-6-1.png)

### EXAMPLE 19.1b

![](/study/img/ì˜í•™í†µê³„ë°©ë²•ë¡ /ch19/19-1b.png)

- ìƒê´€ê³„ìˆ˜ì— ëŒ€í•œ ê²€ì •ì˜ ê°€ì„¤ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

$$
\begin{aligned}
H_0 &: \rho=0 \\
H_A &: \rho \neq 0
\end{aligned}
$$

- Rì— ë‚´ì¥ëœ í•¨ìˆ˜ cor.test()ë¥¼ ì‚¬ìš©í•˜ì—¬ ì–‘ì¸¡ê²€ì •ì„ ì‹œí–‰í•˜ì—¬ ë³´ê² ë‹¤.
``` r
cor.test(ex19_1a$WingLeingth, ex19_1a$TailLength, alternative='two.sided')
```

    ## 
    ##  Pearson's product-moment correlation
    ## 
    ## data:  ex19_1a$WingLeingth and ex19_1a$TailLength
    ## t = 5.5893, df = 10, p-value = 0.0002311
    ## alternative hypothesis: true correlation is not equal to 0
    ## 95 percent confidence interval:
    ##  0.5923111 0.9631599
    ## sample estimates:
    ##       cor 
    ## 0.8703546

- ë¨¼ì € ê¸°ë³¸ ì˜µì…˜ìœ¼ë¡œ ì œê³µë˜ëŠ” t-testì— ëŒ€í•œ ê²°ê³¼ë¥¼ ë³´ë©´, t-ê°’=5.5893ì´ê³ , p-value=0.0002311ë¡œ ìœ ì˜ìˆ˜ì¤€ 5%í•˜ì— ëŒ€ë¦½ê°€ì„¤ì„ ì±„íƒí•œë‹¤.<br/>
- ë”°ë¼ì„œ ìƒê´€ê³„ìˆ˜ëŠ” 0ì´ ì•„ë‹ˆë‹¤ë¼ê³  ë§í•  ìˆ˜ ìˆë‹¤.<br/><br/>
- p-value=0.002311ì´ ë‚˜ì™”ëŠ”ë° ë¬¸ì œì—ì„œëŠ” p-value=0.00012ë¡œ ë‹¤ë¥¸ ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.<br/>
- ì˜ˆì œì—ì„œëŠ” í‘œë³¸ìƒê´€ê³„ìˆ˜ê°€ ì´ë¯¸ ì–‘ìˆ˜ë¡œ ë‚˜ì™”ê¸° ë•Œë¬¸ì— ìš°ì¸¡ë§Œ ë³´ê³  ì˜ì‚¬ê²°ì •ì„ í•œ ê²½ìš°ì´ë‹¤.<br/>
- ê·¸ë ‡ë‹¤ë©´ ë‹¨ì¸¡ê²€ì •ì„ ì‹œí–‰í•˜ì—¬ì„œ p-valueê°€ ê°™ì€ì§€ í™•ì¸í•˜ì—¬ ë³´ê² ë‹¤.

``` r
cor.test(ex19_1a$WingLeingth, ex19_1a$TailLength, alternative='greater')
```

    ## 
    ##  Pearson's product-moment correlation
    ## 
    ## data:  ex19_1a$WingLeingth and ex19_1a$TailLength
    ## t = 5.5893, df = 10, p-value = 0.0001156
    ## alternative hypothesis: true correlation is greater than 0
    ## 95 percent confidence interval:
    ##  0.6562825 1.0000000
    ## sample estimates:
    ##       cor 
    ## 0.8703546

- p-valueë¥¼ í™•ì¸í•˜ì—¬ ë³´ë©´ ì˜ˆì œì—ì„œ ë‚˜ì˜¨ ê°’ì´ ê°™ì€ ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.<br/>
- Rì—ì„œ ë‚˜ì˜¤ëŠ” ê¸°ë³¸ í•¨ìˆ˜ë¡œëŠ” t-testë¡œ ì§„í–‰í•˜ì§€ë§Œ Fí†µê³„ëŸ‰ìœ¼ë¡œë„ ê°€ì„¤ê²€ì •ì„ ì§„í–‰í•  ìˆ˜ ìˆë‹¤.

``` r
f<-(1+abs(r))/(1-abs(r))
f
```

    ## [1] 14.42669

- F ê°’ì€ 14.4ë¡œì¨ 3.72ë³´ë‹¤ í¬ë¯€ë¡œ ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•  ìˆ˜ ìˆë‹¤.

``` r
pf(f,10,10,lower.tail = F)
```

    ## [1] 0.000115553

- ë‹¨ì¸¡ê°€ì„¤ì˜ ëŒ€í•œ p-value=0.00012ë¡œì¨ ìœ ì˜ìˆ˜ì¤€ 5%í•˜ì— ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•  ì¶©ë¶„í•œ ê·¼ê±°ê°€ ìˆìœ¼ë©°,<br/>
- ì˜ˆì œì—ëŠ” p-valueëŠ” ì–‘ì¸¡ì— ëŒ€í•œ p-valueê°€ êµ¬í•˜ì—¬ì ¸ ìˆê¸° ë•Œë¬¸ì— ì¢Œì¸¡ê°’ ê¸°ì¤€ìœ¼ë¡œ ê³„ì‚°ëœ p-valueë¥¼ ìœ„ì—ì„œ êµ¬í•œ p-valueì— ë”í•´ì£¼ë©´ ì–‘ì¸¡ì— ëŒ€í•œ p-valueê°€ êµ¬í•˜ì—¬ì§ˆ ê²ƒì´ë‹¤.

### EXAMPLE 19.2

![](/study/img/ì˜í•™í†µê³„ë°©ë²•ë¡ /ch19/19-2.png)

- ì´ ì˜ˆì œì—ì„œëŠ” ìƒê´€ê³„ìˆ˜ê°€ 0ì´ ì•„ë‹Œ ìƒìˆ˜ 0.750ì´ ì•„ë‹Œì§€ì— ëŒ€í•œ ê²€ì •ì„ í•˜ê³ ì í•œë‹¤.

$$
\begin{aligned}
H_0 &: \rho=0.750 \\
H_A &: \rho \neq 0.750
\end{aligned}
$$

- ìƒê´€ê³„ìˆ˜ê°€ 0ì´ì™¸ì— ë‹¤ë¥¸ íŠ¹ì • ê°’ì¸ì§€ì— ëŒ€í•´ì„œë„ ê²€ì •ì„ ì§„í–‰í•˜ëŠ” ê²½ìš° tanë³€í™˜ì„ í†µí•´ í†µê³„ëŸ‰ì„ êµ¬í•˜ê³  ê²€ì •ì„ ì§„í–‰í•œë‹¤.

$$
\begin{aligned}
z&=tanh^{-1}(r)=0.5\ ln(\frac{1+r}{1-r})\\
E(z)&=\zeta+\frac{\rho}{2(n-1)}\ \ \ Var(z)=\frac{1}{n-3}\ \ \ where,\ \zeta=tanh^{-1}(\rho)
\end{aligned}
$$

``` r
library("DescTools")
z<-FisherZ(r)
zeta<-FisherZ(0.75)
cat("z=",round(z,3),"zeta=",round(zeta,3))
```

    ## z= 1.335 zeta= 0.973

- Fisherz í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ ìƒê´€ê³„ìˆ˜ì™€ ê²€ì •í•  0.75ë¥¼ ë³€í™˜ì‹œì¼°ìœ¼ë©°, ì´ ë‘ ê°’ìœ¼ë¡œ í†µê³„ëŸ‰ Zê°’ì„ êµ¬í•˜ì—¬ ë³´ì.

``` r
Z<-(z-zeta)/sqrt(1/(n-3)); Z
```

    ## [1] 1.084755

``` r
pnorm(Z,lower.tail = F)*2
```

    ## [1] 0.2780303

- Z=1.08ì´ê³  ì´ë¥¼ ì´ìš©í•´ p-valueë¥¼ êµ¬í•˜ë©´ 0.28ì´ë‹¤. <br/>
- ë”°ë¼ì„œ ìœ ì˜ìˆ˜ì¤€ 0.05 í•˜ì—ì„œ ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•  ìˆ˜ ì—†ê³  ëª¨ìƒê´€ê³„ìˆ˜ê°€ 0.75ê°€ ì•„ë‹ˆë¼ê³  í• ë§Œí•œ ì¶©ë¶„í•œ ê·¼ê±°ê°€ ì—†ë‹¤.
### EXAMPLE 19.3

![](/study/img/ì˜í•™í†µê³„ë°©ë²•ë¡ /ch19/19-3.png)

- ìƒê´€ê³„ìˆ˜ì— ëŒ€í•´ì„œë„ ì‹ ë¢°í•œê³„ë¥¼ êµ¬í•  ìˆ˜ ìˆë‹¤. 

> ì§ì ‘ë§Œë“  í•¨ìˆ˜ë¡œ êµ¬í•˜ì—¬ ë³´ì.

``` r
f<-3.72
L1=((1+f)*r+(1-f))/((1+f)+(1-f)*r)
L2= ((1+f)*r-(1-f))/((1+f)-(1-f)*r)
cat("Confidence Limits for a Correlation Coefficient:",round(c(L1,L2),3))
```

    ## Confidence Limits for a Correlation Coefficient: 0.59 0.963

> cor.test()ë¥¼ ì‚¬ìš©í•˜ì—¬ êµ¬í•˜ì—¬ ë³´ì.

``` r
CI<-cor.test(ex19_1a$WingLeingth, ex19_1a$TailLength, alternative="two.sided", method="pearson")
CI$conf.int
```

    ## [1] 0.5923111 0.9631599
    ## attr(,"conf.level")
    ## [1] 0.95

> ci_cor()ë¥¼ ì‚¬ìš©í•˜ì—¬ êµ¬í•˜ì—¬ ë³´ì.

``` r
library("confintr")
ci_cor(ex19_1a$WingLeingth, ex19_1a$TailLength, method = "pearson",type="normal")
```

    ## 
    ##  Two-sided 95% normal confidence interval for the true Pearson
    ##  correlation coefficient
    ## 
    ## Sample estimate: 0.8703546 
    ## Confidence interval:
    ##      2.5%     97.5% 
    ## 0.5923111 0.9631599

### EXAMPLE 19.4

![](/study/img/ì˜í•™í†µê³„ë°©ë²•ë¡ /ch19/19-4.png)

- ì´ ì˜ˆì œëŠ” ìƒê´€ê³„ìˆ˜ê°€ 0ì¸ì§€ë¥¼ ê²€ì •í•  ë•Œ ê·¸ ê°€ì„¤ì„ ê¸°ê°í•˜ê¸° ìœ„í•œ powerë¥¼ êµ¬í•˜ëŠ” ì˜ˆì œì´ë‹¤. 

$$
\begin{aligned}
L_1=\frac{(1+F_\alpha)r+(1-F_\alpha)}{(1+F_\alpha)+(1-F_\alpha)r}=\frac{4.11-2.72}{4.72-2.37}=0.592\\
L_2=\frac{(1+F_\alpha)r-(1-F_\alpha)}{(1+F_\alpha)-(1-F_\alpha)r}=\frac{4.11+2.72}{4.72+2.37}=0.963
\end{aligned}
$$

- pwr.r.test íŒ¨í‚¤ì§€ í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ ìƒê´€ê³„ìˆ˜ì™€ sample size, ìœ ì˜ìˆ˜ì¤€, ì–‘ì¸¡ê²€ì •ì¸ì§€ ë‹¨ì¸¡ê²€ì •ì¸ì§€ì— ëŒ€í•´ ì…ë ¥í•˜ë©´ powerë¥¼ ê³„ì‚°í•  ìˆ˜ ìˆë‹¤.

``` r
library("pwr")
pw<-pwr.r.test(r, n=length(ex19_1a[,1]), sig.level = 0.05, alternative="two.sided")
cat("The power of the test is 1-Î²=",round(pw$power,2))
```

    ## The power of the test is 1-Î²= 0.98

### EXAMPLE 19.5a

![](/study/img/ì˜í•™í†µê³„ë°©ë²•ë¡ /ch19/19-5a.png)

- ìƒê´€ê³„ìˆ˜ê°€ 0ì¸ì§€ë¥¼ ê²€ì •í•  ë•Œ ê·¸ ê°€ì„¤ì„ ê¸°ê°í•˜ê¸° ìœ„í•œ sample sizeë¥¼ êµ¬í•˜ë©´ ì‹ì€ ë‹¤ìŒê³¼ ê°™ë‹¤. 

$$
n=(\frac{Z_{\beta(1)}+Z_\alpha}{\zeta_0})^2+3
$$

- pwr.r.test íŒ¨í‚¤ì§€ í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ ìƒê´€ê³„ìˆ˜ì™€ power, ìœ ì˜ìˆ˜ì¤€, ì–‘ì¸¡ê²€ì •ì¸ì§€ ë‹¨ì¸¡ê²€ì •ì¸ì§€ì— ëŒ€í•´ ì…ë ¥í•˜ë©´ ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•  ìˆ˜ ìˆëŠ” ìµœì†Œí•œì˜ sample sizeë¥¼ ê³„ì‚°í•  ìˆ˜ ìˆë‹¤.

``` r
ex19_5a<-pwr.r.test(r=0.5, power=0.99, sig.level = 0.05, alternative = "two.sided")
cat("n=",round(ex19_5a$n,1))
```

    ## n= 63.1

- ê³„ì‚° ê²°ê³¼ n=63.1ì´ë¯€ë¡œ ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•˜ê¸° ìœ„í•œ ìµœì†Œí•œì˜ sample sizeëŠ” 64ì´ë‹¤.

### EXAMPLE 19.5b

![](/study/img/ì˜í•™í†µê³„ë°©ë²•ë¡ /ch19/19-5b-1.png)

![](/study/img/ì˜í•™í†µê³„ë°©ë²•ë¡ /ch19/19-5b-2.png)

- pwr.r.testë¥¼ ì´ìš©í•˜ëŠ” ë°©ë²• ì™¸ì—ë„ ì‹ ë¢°êµ¬ê°„ì„ ì´ìš©í•˜ì—¬ ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•˜ê¸° ìœ„í•´ í•„ìš”í•œ ìµœì†Œí•œì˜ sample sizeë¥¼ êµ¬í•  ìˆ˜ ìˆë‹¤.<br/>
- ì˜ˆì œ 19.1a ì—ì„œ ê³„ì‚°ëœ rì´ 0.87ì´ê³  ëª¨ìƒê´€ê³„ìˆ˜ë¥¼ ì¶”ì •í•˜ê¸° ìœ„í•´ 0.3ë³´ë‹¤ í¬ì§€ ì•Šì€ 95% ì‹ ë¢°êµ¬ê°„ì´ í•„ìš”í•œ ê²½ìš° ë‹¤ìŒê³¼ ê°™ì€ í”„ë¡œì„¸ìŠ¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. 

``` r
#a)
e_195_b1<-function(n, alpha){
  v=n-2
  f_aa=round(qf(alpha/2, v, v, lower.tail = FALSE), 2)
  L1=round(((1+f_aa)*r+(1-f_aa))/((1+f_aa)+(1-f_aa)*r), 3)
  L2=round(((1+f_aa)*r-(1-f_aa))/((1+f_aa)-(1-f_aa)*r), 3)
  width_CI=L2-L1
  outcome=data.frame(f_aa, L1, L2, width_CI) %>% kbl(caption = "Ex 19.5 (b)") %>%  
    kable_classic(full_width = F, html_font = "Cambria")
  
  return(outcome)
}
```

``` r
e_195_b1(15, 0.05)
```

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Ex 19.5 (b)
</caption>
<thead>
<tr>
<th style="text-align:right;">
f_aa
</th>
<th style="text-align:right;">
L1
</th>
<th style="text-align:right;">
L2
</th>
<th style="text-align:right;">
width_CI
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
3.12
</td>
<td style="text-align:right;">
0.644
</td>
<td style="text-align:right;">
0.957
</td>
<td style="text-align:right;">
0.313
</td>
</tr>
</tbody>
</table>

- ë¨¼ì € í•„ìš”í•œ sample sizeë¥¼ 15ë¼ê³  ê°€ì •í•˜ê³  ì‹ ë¢°êµ¬ê°„ì„ êµ¬í•œ ê²°ê³¼ ì‹ ë¢°êµ¬ê°„ì˜ ê¸¸ì´ëŠ” 0.312ì´ì—ˆê³ , ì´ëŠ” 0.3ë³´ë‹¤ ì¡°ê¸ˆ í° ìˆ˜ì¹˜ì´ë¯€ë¡œ sample sizeë¥¼ ëŠ˜ë ¤ë³´ì.

``` r
e_195_b1(20, 0.05)
```

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Ex 19.5 (b)
</caption>
<thead>
<tr>
<th style="text-align:right;">
f_aa
</th>
<th style="text-align:right;">
L1
</th>
<th style="text-align:right;">
L2
</th>
<th style="text-align:right;">
width_CI
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
2.6
</td>
<td style="text-align:right;">
0.695
</td>
<td style="text-align:right;">
0.948
</td>
<td style="text-align:right;">
0.253
</td>
</tr>
</tbody>
</table>

- sample sizeë¥¼ 20ìœ¼ë¡œ ê°€ì •í•˜ê³  ì‹ ë¢°êµ¬ê°„ì„ êµ¬í•œ ê²°ê³¼ ê¸¸ì´ëŠ” 0.253ì´ì—ˆê³ , ì´ëŠ” 0.3ë³´ë‹¤ ì‘ì€ ìˆ˜ì¹˜ì´ë¯€ë¡œ sample sizeë¥¼ ì¤„ì—¬ë³´ì.

``` r
e_195_b1(16, 0.05)
```

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Ex 19.5 (b)
</caption>
<thead>
<tr>
<th style="text-align:right;">
f_aa
</th>
<th style="text-align:right;">
L1
</th>
<th style="text-align:right;">
L2
</th>
<th style="text-align:right;">
width_CI
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
2.98
</td>
<td style="text-align:right;">
0.658
</td>
<td style="text-align:right;">
0.955
</td>
<td style="text-align:right;">
0.297
</td>
</tr>
</tbody>
</table>

- ì´ì™€ ê°™ì´ ê³„ì†í•´ì„œ 0.3ì— ê°€ì¥ ê·¼ì‚¬í•˜ëŠ” sample sizeë¥¼ ì°¾ì•„ë‚˜ê°„ ê²°ê³¼ ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•˜ê¸° ìœ„í•´ í•„ìš”í•œ ìµœì†Œí•œì˜ sample sizeëŠ” 16ì´ ë‚˜ì™”ë‹¤.<br/><br/>
- ë‹¤ìŒì€ r=0.87, z=1.3331ë¡œ ê³ ì •ëœ ê²½ìš° êµ¬í•˜ì—¬ ë³´ì.

``` r
#b)
e_195_b2<-function(n, r, z){
  sigma_zz=sqrt(1/(n-3))
  z_crit=qnorm(0.025, lower.tail=FALSE)
  L1_F=z-z_crit*sigma_zz
  L2_F=z+z_crit*sigma_zz
  outcome=data.frame(z_crit, L1_F, L2_F) %>% kbl(caption = "Ex 19.5 (b)") %>%  
    kable_classic(full_width = F, html_font = "Cambria")
  
  return(outcome)
}
```

``` r
e_195_b2(15, 0.870, 1.3331)
```

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Ex 19.5 (b)
</caption>
<thead>
<tr>
<th style="text-align:right;">
z_crit
</th>
<th style="text-align:right;">
L1_F
</th>
<th style="text-align:right;">
L2_F
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1.959964
</td>
<td style="text-align:right;">
0.7673071
</td>
<td style="text-align:right;">
1.898893
</td>
</tr>
</tbody>
</table>


- ë¨¼ì € í•„ìš”í•œ sample sizeë¥¼ 15ë¼ê³  ê°€ì •í•˜ê³  ì‹ ë¢°êµ¬ê°„ì„ êµ¬í•œ ê²°ê³¼ ì‹ ë¢°êµ¬ê°„ì€ (0.7672,1.8990)ì´ì—ˆê³ , ì´ë¥¼ ë‹¤ì‹œ ë³€í™˜í•˜ë©´ (0.645,0.956)ì˜ ê°’ì´ ë‚˜ì™”ë‹¤.

![](/study/img/ì˜í•™í†µê³„ë°©ë²•ë¡ /ch19/19b-1.png)

- ì´ ì‹ ë¢°êµ¬ê°„ì˜ ê¸¸ì´ëŠ” 0.312ì´ì—ˆê³ , ì´ëŠ” 0.3ë³´ë‹¤ ì¡°ê¸ˆ í° ìˆ˜ì¹˜ì´ë¯€ë¡œ sample sizeë¥¼ ëŠ˜ë ¤ë³´ì.

``` r
e_195_b2(16, 0.870, 1.3331)
```

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Ex 19.5 (b)
</caption>
<thead>
<tr>
<th style="text-align:right;">
z_crit
</th>
<th style="text-align:right;">
L1_F
</th>
<th style="text-align:right;">
L2_F
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1.959964
</td>
<td style="text-align:right;">
0.7895038
</td>
<td style="text-align:right;">
1.876696
</td>
</tr>
</tbody>
</table>

- sample sizeë¥¼ 16ë¼ê³  ê°€ì •í•˜ê³  ì‹ ë¢°êµ¬ê°„ì„ êµ¬í•œ ê²°ê³¼ ì‹ ë¢°êµ¬ê°„ì€ (0.7894,1.8768)ì´ì—ˆê³ , ì´ë¥¼ ë‹¤ì‹œ ë³€í™˜í•˜ë©´ (0.658,0.954)ì˜ ê°’ì´ ë‚˜ì™”ë‹¤.

![](/study/img/ì˜í•™í†µê³„ë°©ë²•ë¡ /ch19/19b-2.png)

- ì´ ì‹ ë¢°êµ¬ê°„ì˜ ê¸¸ì´ëŠ” 0.30ì´ë¯€ë¡œ sample sizeëŠ” 16ìœ¼ë¡œ ì •í•œë‹¤.

### EXAMPLE 19.6

![](/study/img/ì˜í•™í†µê³„ë°©ë²•ë¡ /ch19/19-6.png)

- ì´ ì˜ˆì œì—ì„œëŠ” ë…ë¦½ì¸ ì„œë¡œ ë‹¤ë¥¸ ë‘ ì§‘ë‹¨ì˜ ëª¨ìƒê´€ê³„ìˆ˜ê°€ ê°™ì€ì§€ì— ëŒ€í•´ ê²€ì •í•´ë³´ê² ë‹¤.

$$
\begin{aligned}
H_0 &: \rho_1=\rho_2 \\
H_A &: \rho_1 \neq \rho_2
\end{aligned}
$$

> ì§ì ‘ë§Œë“  í•¨ìˆ˜ë¡œ êµ¬í•˜ì—¬ ë³´ì.

``` r
r1= 0.78 ; r2=0.84
z1=1.0454 ; z2=1.2212
n1=98 ; n2=95
Z=(z1-z2)/sqrt((1/(n1-3))+(1/(n2-3)))
p<-round(pnorm(Z)*2,2)
cat("Z=",round(Z,3),"p-value=",round(p,2),"\nTherefore, do not reject H0.")
```

    ## Z= -1.202 p-value= 0.23 
    ## Therefore, do not reject H0.

> diffcor.two()ë¥¼ ì‚¬ìš©í•˜ì—¬ êµ¬í•˜ì—¬ ë³´ì.

``` r
library("diffcor")
diffcor.two(0.78, 0.84, 98, 95, alpha = 0.05, cor.names = NULL,alternative = "two.sided")
```

    ##     r1   r2   LL1   UL1   LL2   UL2      z     p Cohen_q
    ## 1 0.78 0.84 0.688 0.847 0.769 0.891 -1.202 0.229  -0.176

- p-valueëŠ” ëª¨ë‘ ìœ ì˜ìˆ˜ì¤€ 0.05ë³´ë‹¤ í¬ê²Œ ë‚˜íƒ€ë‚¬ê³  ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•  ìˆ˜ ì—†ë‹¤.<br/>
- ë”°ë¼ì„œ ì„œë¡œ ë‹¤ë¥¸ ë…ë¦½ëœ ë‘ ì§‘ë‹¨ì˜ ëª¨ìƒê´€ê³„ìˆ˜ê°€ ë‹¤ë¥´ë‹¤ê³  ë§í• ë§Œí•œ ì¶©ë¶„í•œ ê·¼ê±°ê°€ ì—†ë‹¤. <br/>
- ê·€ë¬´ê°€ì„¤ì´ ì±„íƒë  ê²½ìš° ê³µí†µìƒê´€ê³„ìˆ˜ë¥¼ êµ¬í•  ìˆ˜ ìˆìœ¼ë©° ê³„ì‚°í•˜ë©´ ê³µí†µìƒê´€ê³„ìˆ˜ëŠ” 0.81ì´ë‹¤.

### EXAMPLE 19.7

![](/study/img/ì˜í•™í†µê³„ë°©ë²•ë¡ /ch19/19-7.png)

- ì´ ì˜ˆì œëŠ” ë‘ ìƒê´€ê³„ìˆ˜ë¥¼ ë¹„êµí•  ë•Œì˜ ê²€ì •ë ¥ì„ êµ¬í•˜ëŠ” ë¬¸ì œì´ë‹¤. 

> ì§ì ‘ë§Œë“  í•¨ìˆ˜ë¡œ êµ¬í•˜ì—¬ ë³´ì.

``` r
z1=1.0454 ; z2=1.2212
sigma_12=0.1463
z_a=qnorm(0.025, lower.tail = FALSE)
z_b=round(((abs(z1-z2))/sigma_12)-z_a, 2)
beta=1-pnorm(z_b)
power.method2 = pnorm(z_b)
data.frame(power.method2) %>% kbl(caption = "Ex 19.7:ë°©ë²•1") %>%  
  kable_classic(full_width = F, html_font = "Cambria")
```

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Ex 19.7:ë°©ë²•1
</caption>
<thead>
<tr>
<th style="text-align:right;">
power.method2
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.2236273
</td>
</tr>
</tbody>
</table>

> power.indep.cor()ë¥¼ ì‚¬ìš©í•˜ì—¬ êµ¬í•˜ì—¬ ë³´ì.

``` r
library("remotes")
# remotes::install_github('m-Py/cower')
# install_github("m-Py/cower")
library("cower")
e_197=power.indep.cor(r1=0.78, r2=0.84, n1=98, n2=95, sig.level = 0.05, alternative = "two.sided")
power.method1 = e_197$power
data.frame(power.method1) %>% kbl(caption = "Ex 19.7:ë°©ë²•2") %>%  
    kable_classic(full_width = F, html_font = "Cambria")
```

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Ex 19.7:ë°©ë²•2
</caption>
<thead>
<tr>
<th style="text-align:right;">
power.method1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.2242004
</td>
</tr>
</tbody>
</table>

- ê²€ì •í†µê³„ëŸ‰ ê°’ì€ -0.76ì´ê³  ì´ë¥¼ ì´ìš©í•˜ì—¬ ì •ê·œë¶„í¬í‘œì—ì„œ ê°’ì„ êµ¬í•˜ë©´ 0.78ì´ë‹¤. ë”°ë¼ì„œ ê²€ì •ë ¥ì€ 1-0.78=0.22ê°€ ëœë‹¤.

### EXAMPLE 19.8

![](/study/img/ì˜í•™í†µê³„ë°©ë²•ë¡ /ch19/19-8.png)

- ì´ ì˜ˆì œëŠ” ë‘ ìƒê´€ê³„ìˆ˜ë¥¼ ë¹„êµí•  ë•Œì˜ sample sizeë¥¼ êµ¬í•˜ëŠ” ë¬¸ì œì´ë‹¤. 

``` r
z_alpha= round(qnorm(0.05/2, lower.tail = F), 4)
z_beta=round(qnorm(0.10,lower.tail = F), 4)
n_198=2*(((z_alpha+z_beta)/(0.5000))^2)+3
sample.size = ceiling(n_198)
cbind(z_alpha, z_beta, n_198, sample.size) %>% kbl(caption = "Ex 19.8") %>%  
  kable_classic(full_width = F, html_font = "Cambria")
```

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Ex 19.8
</caption>
<thead>
<tr>
<th style="text-align:right;">
z_alpha
</th>
<th style="text-align:right;">
z_beta
</th>
<th style="text-align:right;">
n_198
</th>
<th style="text-align:right;">
sample.size
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1.96
</td>
<td style="text-align:right;">
1.2816
</td>
<td style="text-align:right;">
87.06376
</td>
<td style="text-align:right;">
88
</td>
</tr>
</tbody>
</table>


- ë‘ ê°’ë“¤ì˜ ì°¨ì´ë¥¼ ì´ìš©í•˜ì—¬ sample sizeë¥¼ êµ¬í–ˆê³ , ê·¸ ê²°ê³¼ ìƒê´€ê³„ìˆ˜ ê°„ 0.5ì˜ ì°¨ì´ë¥¼ ë°œê²¬í•˜ê¸° ìœ„í•´ ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•˜ê¸° ìœ„í•œ ìµœì†Œì˜ í•„ìš”í•œ sample sizeëŠ” 88ì´ë‹¤.

### EXAMPLE 19.9

![](/study/img/ì˜í•™í†µê³„ë°©ë²•ë¡ /ch19/19-9.png)

- ì´ ì˜ˆì œëŠ” ì„¸ ê°œì˜ ìƒê´€ê³„ìˆ˜ë¥¼ ë¹„êµí•˜ëŠ” ë¬¸ì œì´ë‹¤. 

$$
\begin{aligned}
H_0 &: \rho_1=\rho_2=\rho_3\\
H_A &: All \ three \ population \ correlation \ coefficients \ are \ not \ equal.
\end{aligned}
$$

``` r
n=c(24,29,32)
r=c(0.52, 0.56, 0.87)

test.three_sample_corr <- function(n,r) {
  z = round(0.5*log((1+r)/(1-r)), 4)
  z_square = round(z^2, 4)
  n_minus_3 = n-3
  n_3_z = n_minus_3*z
  n_3_z_sqaure = n_minus_3*z_square
  test.stat = round(sum(n_3_z_sqaure) - (sum(n_3_z)^2)/sum(n_minus_3), 3)
  df = length(n)-1
  p.value = round(1 - pchisq(test.stat, df), 4)
  result.df = data.frame(test.stat, df, p.value)
  result.df<-result.df %>% kbl(caption = "Ex 19.9") %>%  
    kable_classic(full_width = F, html_font = "Cambria")
  return(result.df)
}

test.three_sample_corr(n,r)
```

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Ex 19.9
</caption>
<thead>
<tr>
<th style="text-align:right;">
test.stat
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
9.478
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.0087
</td>
</tr>
</tbody>
</table>

- ê²€ì •í†µê³„ëŸ‰ ê°’ì€ 9.478ì´ê³  p-valueëŠ” 0.0087ë¡œ ìœ ì˜ìˆ˜ì¤€ í•˜ì—ì„œ ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•˜ê²Œ ëœë‹¤. <br/>
- ë”°ë¼ì„œ ì ì–´ë„ í•˜ë‚˜ ì´ìƒì˜ ìƒê´€ê³„ìˆ˜ëŠ” ê°™ì§€ ì•Šë‹¤ê³  í•  ìˆ˜ ìˆë‹¤. <br/><br/>
- ê·€ë¬´ê°€ì„¤ì´ ê¸°ê°ë˜ì§€ ì•Šì•˜ë‹¤ë©´, common correlation coefficientë¥¼ ê³„ì‚°í•˜ëŠ” ê²ƒì´ ì ì ˆí–ˆì„ ê²ƒì´ë‹¤.

``` r
common.corr <- function(n,r) {
  z = round(0.5*log((1+r)/(1-r)), 4)
  z_square = round(z^2, 4)
  n_minus_3 = n-3
  n_3_z = n_minus_3*z
  n_3_z_sqaure = n_minus_3*z_square
  z.w = sum(n_3_z)/sum(n_minus_3)
  r.w = round((exp(2*z.w)-1) / (exp(2*z.w)+1), 4)
  r.w <- data.frame(r.w)
  r.w <- r.w %>% kbl(caption = "Ex 19.9") %>%  
    kable_classic(full_width = F, html_font = "Cambria")
  
  return(r.w)
}
common.corr(n,r)
```

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Ex 19.9
</caption>
<thead>
<tr>
<th style="text-align:right;">
r.w
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.7086
</td>
</tr>
</tbody>
</table>

- common correlation coefficientëŠ” 0.7086ìœ¼ë¡œ ê³„ì‚°ë˜ì—ˆë‹¤.

### EXAMPLE 19.10

![](/study/img/ì˜í•™í†µê³„ë°©ë²•ë¡ /ch19/19-10.png)

- ìƒê´€ê³„ìˆ˜ ë³€í™˜ ì‹œ z-ë³€í™˜ì´ í¸í–¥ë˜ëŠ” ì ìœ¼ë¡œ í¸í–¥ ê·¹ë³µì„ ìœ„í•´ ìˆ˜ì •ëœ ê²€ì •í†µê³„ëŸ‰ ê°’ì„ ê³„ì‚°í•˜ì—¬ì•¼ í•œë‹¤.<br/>
- Example 19.9ì™€ ë™ì¼í•œ ê°€ì„¤ì„ correction for biasë¥¼ ì´ìš©í•´ ë‹¤ì‹œ êµ¬í•˜ì—¬ ë³´ê² ë‹¤.

``` r
n=c(24,29,32)
r=c(0.52, 0.56, 0.87)

test.corr_correction <- function(n,r) {
  z = round(0.5*log((1+r)/(1-r)), 4)
  z_square = round(z^2, 4)
  n_minus_3 = n-3
  n_3_z = n_minus_3*z
  n_3_z_sqaure = n_minus_3*z_square
  z.w = sum(n_3_z)/sum(n_minus_3)
  r.w = round((exp(2*z.w)-1) / (exp(2*z.w)+1), 2)

  test.stat = round(sum(n*t((r- r.w)^2) / (1 - r*r.w)^2), 4)
  df = length(n)-1
  p.value = round(1 - pchisq(test.stat, df), 4)
  result.df = data.frame(test.stat, p.value)
  result.df<-result.df %>% kbl(caption = "Ex 19.10") %>%  
    kable_classic(full_width = F, html_font = "Cambria")
  return(result.df)
}

test.corr_correction(n,r)
```

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Ex 19.10
</caption>
<thead>
<tr>
<th style="text-align:right;">
test.stat
</th>
<th style="text-align:right;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
9.5805
</td>
<td style="text-align:right;">
0.0083
</td>
</tr>
</tbody>
</table>

- ê³„ì‚°ëœ ê²€ì •í†µê³„ëŸ‰ì€ 9.5805, p-valueëŠ” 0.0083ìœ¼ë¡œ ìœ ì˜ìˆ˜ì¤€ 0.05ë³´ë‹¤ ì‘ì•˜ë‹¤.<br/>
- ì¦‰, ìœ ì˜ìˆ˜ì¤€ 5%í•˜ì— ì„¸ ê°œì˜ ëª¨ì§‘ë‹¨ ìƒê´€ ê³„ìˆ˜ê°€ ëª¨ë‘ ê°™ì§€ ì•Šë‹¤ê³  ë§í•  ì¶©ë¶„í•œ ì¦ê±°ê°€ ìˆë‹¤.<br/>
- ì´ëŠ” Example 19.9ì˜ ê°€ì„¤ê²€ì • ê²°ê³¼ì™€ ë™ì¼í•˜ë‹¤.

### EXAMPLE 19.11

![](/study/img/ì˜í•™í†µê³„ë°©ë²•ë¡ /ch19/19-11.png)

- ì´ ì˜ˆì œì—ì„œëŠ” ì•ì„  ìƒê´€ê³„ìˆ˜ ê²€ì •ì„ í†µí•´ ê° ìƒê´€ê³„ìˆ˜ë“¤ì´ ëª¨ë‘ ê°™ì§€ ì•ŠìŒì„ í™•ì¸í–ˆìœ¼ë¯€ë¡œ ë‹¤ì¤‘ë¹„êµë¥¼ ì§„í–‰í•œë‹¤.<br/>
-  Z-ë³€í™˜ì„ ì´ìš©í•˜ì—¬ Tukeyì˜ ë‹¤ì¤‘ë¹„êµë¥¼ ì§„í–‰í•˜ì˜€ë‹¤.

``` r
library("gtools")
z = round(0.5*log((1+r)/(1-r)), 4)
comb<-combinations(3, 2, v = 1:3)

comb <- data.frame(comb)
comb<-comb[order(comb$X2, decreasing = T),]

ex19.11_result = vector()
for (k in 1:3) {
  compar_vec = vector()
  i=comb[k,2]
  j=comb[k,1]
  
  compar=paste0(i," vs. ",j)
  compar_vec = c(compar_vec, "Comparison"=compar)
  
  diff= z[i]-z[j]
  compar_vec = c(compar_vec, "Difference"=diff)
  
  SE = round(sqrt(1/2*(1/(n[i]-3) + 1/(n[j]-3))), 3)
  compar_vec = c(compar_vec, "SE"=SE)
  
  q = round((z[i]-z[j]) / round(sqrt(1/2*(1/(n[i]-3) + 1/(n[j]-3))), 3), 3)
  compar_vec = c(compar_vec, "q"=q)
  compar_vec = c(compar_vec, "critical.value"=3.314)
  
  if (q > 3.314) {
    compar_vec = c(compar_vec, "Conclusion"="Reject H0")
  }
  else {
    compar_vec = c(compar_vec, "Conclusion"="Do not reject H0")
  }
  ex19.11_result<- rbind(ex19.11_result, compar_vec)
}

rownames(ex19.11_result) <- c(rep(" ", 3))

ex19.11_result %>% kbl(caption = "Ex 19.11") %>%  
  kable_classic(full_width = F, html_font = "Cambria")
```

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Ex 19.11
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
Comparison
</th>
<th style="text-align:left;">
Difference
</th>
<th style="text-align:left;">
SE
</th>
<th style="text-align:left;">
q
</th>
<th style="text-align:left;">
critical.value
</th>
<th style="text-align:left;">
Conclusion
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
3 vs.Â 1
</td>
<td style="text-align:left;">
0.7568
</td>
<td style="text-align:left;">
0.203
</td>
<td style="text-align:left;">
3.728
</td>
<td style="text-align:left;">
3.314
</td>
<td style="text-align:left;">
Reject H0
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
3 vs.Â 2
</td>
<td style="text-align:left;">
0.7003
</td>
<td style="text-align:left;">
0.191
</td>
<td style="text-align:left;">
3.666
</td>
<td style="text-align:left;">
3.314
</td>
<td style="text-align:left;">
Reject H0
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
2 vs.Â 1
</td>
<td style="text-align:left;">
0.0565
</td>
<td style="text-align:left;">
0.207
</td>
<td style="text-align:left;">
0.273
</td>
<td style="text-align:left;">
3.314
</td>
<td style="text-align:left;">
Do not reject H0
</td>
</tr>
</tbody>
</table>

- ê°ê°ì˜ q í†µê³„ëŸ‰ì„ 3.314ì™€ ë¹„êµí•˜ë©´ ê·¸ë£¹ 3ê³¼ ê·¸ë£¹1,2ëŠ” ìƒê´€ê³„ìˆ˜ê°€ ê°™ë‹¤ëŠ” ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í–ˆì§€ë§Œ, ê·¸ë£¹ 1ê³¼ ê·¸ë£¹2ëŠ” ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•˜ì§€ ëª»í–ˆë‹¤. <br/>
- ë”°ë¼ì„œ ê·¸ë£¹ 1ê³¼ ê·¸ë£¹ 2ì˜ ìƒê´€ê³„ìˆ˜ëŠ” ê°™ìœ¼ë‚˜ ê·¸ë£¹ 3ì˜ ìƒê´€ê³„ìˆ˜ëŠ” ë‹¤ë¥´ë‹¤ê³  í•  ìˆ˜ ìˆë‹¤.

### EXAMPLE 19.12

![](/study/img/ì˜í•™í†µê³„ë°©ë²•ë¡ /ch19/19-12.png)

``` r
#ë°ì´í„°ì…‹
ex19_12 %>%
  kbl(caption = "Dataset",escape=F) %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
Dataset
</caption>
<thead>
<tr>
<th style="text-align:right;">
Student
</th>
<th style="text-align:right;">
X
</th>
<th style="text-align:right;">
Y
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
57
</td>
<td style="text-align:right;">
83
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
37
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
72
</td>
<td style="text-align:right;">
41
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
78
</td>
<td style="text-align:right;">
84
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
53
</td>
<td style="text-align:right;">
56
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
63
</td>
<td style="text-align:right;">
85
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
86
</td>
<td style="text-align:right;">
77
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
98
</td>
<td style="text-align:right;">
87
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
59
</td>
<td style="text-align:right;">
70
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
71
</td>
<td style="text-align:right;">
59
</td>
</tr>
</tbody>
</table>

- nì´ 10 ì´ìƒì´ê³  ìˆœìœ„ìƒê´€ê³„ìˆ˜ê°€ 0.9 ì´í•˜ì´ë©´ Fisherâ€™s z-ë³€í™˜ì€ Spearmanì˜ ìƒê´€ê³„ìˆ˜ì—ë„ ì‚¬ìš©ë  ìˆ˜ ìˆë‹¤. 

``` r
ex19_12.result <-cor.test(ex19_12$X, ex19_12$Y, method="spearman")
ex19_12.result
```

    ## 
    ##  Spearman's rank correlation rho
    ## 
    ## data:  ex19_12$X and ex19_12$Y
    ## S = 72, p-value = 0.09579
    ## alternative hypothesis: true rho is not equal to 0
    ## sample estimates:
    ##       rho 
    ## 0.5636364

``` r
ex19_12.result_table <- cbind("statistic"=ex19_12.result$statistic, "r"=round(ex19_12.result$estimate, 3),
      "p.value"=round(ex19_12.result$p.value, 3))
rownames(ex19_12.result_table)=c(" ")

ex19_12.result_table %>% kbl(caption = "Ex 19.12") %>%  
    kable_classic(full_width = F, html_font = "Cambria")
```

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Ex 19.12
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
r
</th>
<th style="text-align:right;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
72
</td>
<td style="text-align:right;">
0.564
</td>
<td style="text-align:right;">
0.096
</td>
</tr>
</tbody>
</table>

- ê³„ì‚°ëœ ê²€ì •í†µê³„ëŸ‰ ê°’ì€ 0.564, p-valueëŠ” 0.096ìœ¼ë¡œ ìœ ì˜ìˆ˜ì¤€ 0.05ë³´ë‹¤ í¬ë¯€ë¡œ ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•  ìˆ˜ ì—†ë‹¤.<br/>
- ì¦‰, ìˆœìœ„ìƒê´€ê³„ìˆ˜ëŠ” 0ì´ë¼ê³  ë§í•  ìˆ˜ ìˆìœ¼ë©°, ìˆ˜í•™ì‹œí—˜ ì ìˆ˜ì™€ ìƒë¬¼ì‹œí—˜ ì ìˆ˜ ê°„ ìƒê´€ê´€ê³„ê°€ ìˆë‹¤ëŠ” ê·¼ê±°ê°€ ì¶©ë¶„í•˜ì§€ ì•Šë‹¤ê³  ë§í•  ìˆ˜ ìˆë‹¤.

### EXAMPLE 19.13

![](/study/img/ì˜í•™í†µê³„ë°©ë²•ë¡ /ch19/19-13.png)

``` r
#ë°ì´í„°ì…‹
ex19_13 %>%
  kbl(caption = "Dataset",escape=F) %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
Dataset
</caption>
<thead>
<tr>
<th style="text-align:right;">
Student
</th>
<th style="text-align:right;">
X
</th>
<th style="text-align:right;">
Y
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
10.4
</td>
<td style="text-align:right;">
7.4
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
10.8
</td>
<td style="text-align:right;">
7.6
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
11.1
</td>
<td style="text-align:right;">
7.9
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
10.2
</td>
<td style="text-align:right;">
7.2
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
10.3
</td>
<td style="text-align:right;">
7.4
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
10.2
</td>
<td style="text-align:right;">
7.1
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
10.7
</td>
<td style="text-align:right;">
7.4
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
10.5
</td>
<td style="text-align:right;">
7.2
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
10.8
</td>
<td style="text-align:right;">
7.8
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
11.2
</td>
<td style="text-align:right;">
7.7
</td>
</tr>
<tr>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
10.6
</td>
<td style="text-align:right;">
7.8
</td>
</tr>
<tr>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
11.4
</td>
<td style="text-align:right;">
8.3
</td>
</tr>
</tbody>
</table>

- ì´ ì˜ˆì œì—ì„œëŠ” Example 19.1 ë°ì´í„°ë¥¼ ê°€ì§€ê³  íŠ¹ì • ì¢…ì˜ ìƒˆì— ëŒ€í•œ ë‚ ê°œì™€ ê¼¬ë¦¬ ì‚¬ì´ì— ìˆœìœ„ ìƒê´€ì„±ì´ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•´ ê²€ì •í•  ê²ƒì´ë‹¤.

$$
\begin{aligned}
H_0 &: \rho_s=0 \\
H_A &: \rho_s \neq 0
\end{aligned}
$$

``` r
cor.test(ex19_13$X,ex19_13$Y,method = "spearman", exact = F)
```

    ## 
    ##  Spearman's rank correlation rho
    ## 
    ## data:  ex19_13$X and ex19_13$Y
    ## S = 42.59, p-value = 0.0004467
    ## alternative hypothesis: true rho is not equal to 0
    ## sample estimates:
    ##       rho 
    ## 0.8510852

- ë‘˜ ì‚¬ì´ì— ìˆœìœ„ ìƒê´€ê³„ìˆ˜ëŠ” 0.851ì´ë©° test ê²°ê³¼ p-valueê°€ 0.0004ë¡œ ìœ ì˜ìˆ˜ì¤€ 0.05 ë³´ë‹¤ ì‘ê¸° ë•Œë¬¸ì— ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•œë‹¤.<br/>
- ì¦‰, ìƒˆì˜ ë‚ ê°œì™€ ê¼¬ë¦¬ ê°„ì— ìˆœìœ„ ìƒê´€ ê´€ê³„ê°€ ì¡´ì¬í•œë‹¤ê³  í•  ìˆ˜ ìˆë‹¤.

### EXAMPLE 19.14

![](/study/img/ì˜í•™í†µê³„ë°©ë²•ë¡ /ch19/19-14.png)

``` r
#ë°ì´í„°ì…‹
ex19_14 %>%
  kbl(caption = "Dataset",escape=F) %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
Dataset
</caption>
<thead>
<tr>
<th style="text-align:left;">
Factor
</th>
<th style="text-align:right;">
Species1
</th>
<th style="text-align:right;">
Species2
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
C
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
D
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
7
</td>
</tr>
<tr>
<td style="text-align:left;">
E
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
8
</td>
</tr>
<tr>
<td style="text-align:left;">
F
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:left;">
G
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
H
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
4
</td>
</tr>
</tbody>
</table>

$$
\begin{aligned}
H_0 &: The \ same \ ecological \ factors \ are \ most \ important \ to \ both \ species. \\
H_A &: The \ same \ ecological \ factors \ are \ not \ most \ important \ to \ both \ species.
\end{aligned}
$$

- ê°€ì¤‘ ìˆœìœ„ ìƒê´€ê³„ìˆ˜ë¥¼ êµ¬í•˜ê¸° ìœ„í•´ì„  savage scoreì„ ì‚¬ìš©í•œë‹¤.

``` r
j.inverse <- ex19_14$Species1^(-1)
savage.number1 = vector()
savage.number2 = vector()
for (k in 1:8) {
  S1 = round(sum(j.inverse[ex19_14$Species1[k]:8]), 3)
  savage.number1 = c(savage.number1, S1)
  
  S2 = round(sum(j.inverse[ex19_14$Species2[k]:8]), 3)
  savage.number2 = c(savage.number2, S2)
}

ex19_14.result <- cbind(ex19_14, savage.number1, savage.number2,
                        "(S1)(S2)"=round(savage.number1*savage.number2, 3))

ex19_14.result %>% kbl(caption = "Ex 19.14") %>%  
    kable_classic(full_width = F, html_font = "Cambria")
```

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Ex 19.14
</caption>
<thead>
<tr>
<th style="text-align:left;">
Factor
</th>
<th style="text-align:right;">
Species1
</th>
<th style="text-align:right;">
Species2
</th>
<th style="text-align:right;">
savage.number1
</th>
<th style="text-align:right;">
savage.number2
</th>
<th style="text-align:right;">
(S1)(S2)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2.718
</td>
<td style="text-align:right;">
2.718
</td>
<td style="text-align:right;">
7.388
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1.718
</td>
<td style="text-align:right;">
1.718
</td>
<td style="text-align:right;">
2.952
</td>
</tr>
<tr>
<td style="text-align:left;">
C
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1.218
</td>
<td style="text-align:right;">
1.218
</td>
<td style="text-align:right;">
1.484
</td>
</tr>
<tr>
<td style="text-align:left;">
D
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0.885
</td>
<td style="text-align:right;">
0.268
</td>
<td style="text-align:right;">
0.237
</td>
</tr>
<tr>
<td style="text-align:left;">
E
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0.635
</td>
<td style="text-align:right;">
0.125
</td>
<td style="text-align:right;">
0.079
</td>
</tr>
<tr>
<td style="text-align:left;">
F
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0.435
</td>
<td style="text-align:right;">
0.435
</td>
<td style="text-align:right;">
0.189
</td>
</tr>
<tr>
<td style="text-align:left;">
G
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.268
</td>
<td style="text-align:right;">
0.635
</td>
<td style="text-align:right;">
0.170
</td>
</tr>
<tr>
<td style="text-align:left;">
H
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0.125
</td>
<td style="text-align:right;">
0.885
</td>
<td style="text-align:right;">
0.111
</td>
</tr>
</tbody>
</table>

``` r
summation = sum(round(savage.number1*savage.number2, 3))
n = length(ex19_14$Factor)
r.T = round((summation-n) / (n-savage.number1[1]), 3)
cbind(n, r.T) %>% kbl(caption = "Ex 19.14") %>%  
    kable_classic(full_width = F, html_font = "Cambria")
```

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Ex 19.14
</caption>
<thead>
<tr>
<th style="text-align:right;">
n
</th>
<th style="text-align:right;">
r.T
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0.873
</td>
</tr>
</tbody>
</table>

- Top down correlation ë¶„ì„ ê²°ê³¼, ìƒê´€ê³„ìˆ˜ëŠ” 0.873ìœ¼ë¡œ ê³„ì‚°ë˜ì—ˆë‹¤.

``` r
cor.test(savage.number1,savage.number2)
```

    ## 
    ##  Pearson's product-moment correlation
    ## 
    ## data:  savage.number1 and savage.number2
    ## t = 4.3616, df = 6, p-value = 0.004762
    ## alternative hypothesis: true correlation is not equal to 0
    ## 95 percent confidence interval:
    ##  0.4337146 0.9765680
    ## sample estimates:
    ##       cor 
    ## 0.8719087

- ê²€ì • ê²°ê³¼ ìƒê´€ê³„ìˆ˜ëŠ” 0.8719087ì´ë©° ì´ì— ëŒ€í•œ ê²€ì • ê²°ê³¼ p-value=0.004762 ì´ë¯€ë¡œ 0.05ë³´ë‹¤ ì‘ê¸° ë•Œë¬¸ì— ë™ì¼í•œ ìƒíƒœì  ìš”ì¸ì´ ë‘ ì¢… ëª¨ë‘ì—ê²Œ ê°€ì¥ ì¤‘ìš”í•œ ê²ƒì€ ì•„ë‹ˆë¼ëŠ” ê²°ë¡ ì„ ë‚´ë¦´ ìˆ˜ ìˆë‹¤.

### EXAMPLE 19.15

![](/study/img/ì˜í•™í†µê³„ë°©ë²•ë¡ /ch19/19-15.png)

``` r
#ë°ì´í„°ì…‹
ex19_15 %>%
  kbl(caption = "Dataset",escape=F) %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
Dataset
</caption>
<thead>
<tr>
<th style="text-align:right;">
Case
</th>
<th style="text-align:left;">
Disease
</th>
<th style="text-align:right;">
Insect
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">

-   </td>
    <td style="text-align:right;">
    1
    </td>
    </tr>
    <tr>
    <td style="text-align:right;">
    2
    </td>
    <td style="text-align:left;">

    -   </td>
        <td style="text-align:right;">
        1
        </td>
        </tr>
        <tr>
        <td style="text-align:right;">
        3
        </td>
        <td style="text-align:left;">

        -   </td>
            <td style="text-align:right;">
            0
            </td>
            </tr>
            <tr>
            <td style="text-align:right;">
            4
            </td>
            <td style="text-align:left;">

            -   </td>
                <td style="text-align:right;">
                1
                </td>
                </tr>
                <tr>
                <td style="text-align:right;">
                5
                </td>
                <td style="text-align:left;">

                -   </td>
                    <td style="text-align:right;">
                    1
                    </td>
                    </tr>
                    <tr>
                    <td style="text-align:right;">
                    6
                    </td>
                    <td style="text-align:left;">

                    -   </td>
                        <td style="text-align:right;">
                        1
                        </td>
                        </tr>
                        <tr>
                        <td style="text-align:right;">
                        7
                        </td>
                        <td style="text-align:left;">

                        -   </td>
                            <td style="text-align:right;">
                            0
                            </td>
                            </tr>
                            <tr>
                            <td style="text-align:right;">
                            8
                            </td>
                            <td style="text-align:left;">

                            -   </td>
                                <td style="text-align:right;">
                                1
                                </td>
                                </tr>
                                <tr>
                                <td style="text-align:right;">
                                9
                                </td>
                                <td style="text-align:left;">

                                -   </td>
                                    <td style="text-align:right;">
                                    1
                                    </td>
                                    </tr>
                                    <tr>
                                    <td style="text-align:right;">
                                    10
                                    </td>
                                    <td style="text-align:left;">

                                    -   </td>
                                        <td style="text-align:right;">
                                        0
                                        </td>
                                        </tr>
                                        <tr>
                                        <td style="text-align:right;">
                                        11
                                        </td>
                                        <td style="text-align:left;">

                                        -   </td>
                                            <td style="text-align:right;">
                                            1
                                            </td>
                                            </tr>
                                            <tr>
                                            <td style="text-align:right;">
                                            12
                                            </td>
                                            <td style="text-align:left;">

                                            -   </td>
                                                <td style="text-align:right;">
                                                0
                                                </td>
                                                </tr>
                                                <tr>
                                                <td style="text-align:right;">
                                                13
                                                </td>
                                                <td style="text-align:left;">

                                                -   </td>
                                                    <td style="text-align:right;">
                                                    1
                                                    </td>
                                                    </tr>
                                                    <tr>
                                                    <td style="text-align:right;">
                                                    14
                                                    </td>
                                                    <td style="text-align:left;">

                                                    -   </td>
                                                        <td style="text-align:right;">
                                                        1
                                                        </td>
                                                        </tr>
                                                        </tbody>
                                                        </table>

- í•´ë‹¹ ë°ì´í„°ëŠ” ë‘ ê°œì˜ ì´í•­í˜• ë³€ìˆ˜, íŠ¹ì • ê³¤ì¶©ì˜ ìœ ë¬´ì™€ ì‹ë¬¼ ìœ ë³‘ì˜ ìœ ë¬´ì— ëŒ€í•˜ì—¬ ê¸°ë¡í•œ ë°ì´í„°ì´ë‹¤.<br/>
- phi ê³„ìˆ˜, Yuleì˜ ê³„ìˆ˜, ê·¸ë¦¬ê³  Ives and Gibbonsì˜ ê³„ìˆ˜ë¡œ ìƒê´€ê´€ê³„ë¥¼ ì•Œì•„ë³´ê² ë‹¤.

``` r
library("psych")
cross.table<-table(ex19_15$Disease, ex19_15$Insect)

phi.coefficient <- phi(cross.table, digits = 2)
Yule.coefficient <- Yule(cross.table,Y=FALSE)
r.n = round(((cross.table[2,2] + cross.table[1,1]) - (cross.table[1,2] + cross.table[2,1])) / 
  ((cross.table[2,2] + cross.table[1,1]) + (cross.table[1,2] + cross.table[2,1])), 2)

ex19_15.result <- cbind(phi.coefficient, Yule.coefficient, r.n)

ex19_15.result %>% kbl(caption = "Ex 19.15") %>%  
    kable_classic(full_width = F, html_font = "Cambria")
```

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Ex 19.15
</caption>
<thead>
<tr>
<th style="text-align:right;">
phi.coefficient
</th>
<th style="text-align:right;">
Yule.coefficient
</th>
<th style="text-align:right;">
r.n
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.55
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.43
</td>
</tr>
</tbody>
</table>

-  phiì˜ ê³„ìˆ˜ì˜ ê²½ìš° 0.55, Yuleì˜ ê³„ìˆ˜ì˜ ê²½ìš° 0.97 (almost 1), ê·¸ë¦¬ê³  Ives and Gibbonsì˜ ê³„ìˆ˜ì˜ ê²½ìš° ì•½ 0.43ì˜ ê°’ì„ ê°€ì§„ë‹¤.

### EXAMPLE 19.16

![](/study/img/ì˜í•™í†µê³„ë°©ë²•ë¡ /ch19/19-16.png)

``` r
#ë°ì´í„°ì…‹
ex19_16 %>%
  kbl(caption = "Dataset",escape=F) %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
Dataset
</caption>
<thead>
<tr>
<th style="text-align:right;">
X
</th>
<th style="text-align:right;">
Y
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
8.8
</td>
</tr>
<tr>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
8.4
</td>
</tr>
<tr>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
7.9
</td>
</tr>
<tr>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
8.7
</td>
</tr>
<tr>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
9.1
</td>
</tr>
<tr>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
9.6
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
9.9
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
9.0
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
11.1
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
9.6
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
8.7
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
10.4
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
9.5
</td>
</tr>
</tbody>
</table>

- ì˜ˆì œ 8.1ì€ ë³€ìˆ˜ Xê°€ ì•½ì˜ ì¢…ë¥˜ 2ê°€ì§€ë¡œ ì´í•­í˜•ì´ê³ , ë³€ìˆ˜ YëŠ” í”¼ê°€ ì‘ê³ ë˜ëŠ” ì‹œê°„ìœ¼ë¡œ ì—°ì†í˜•ìœ¼ë¡œ í•˜ë‚˜ì˜ ë³€ìˆ˜ê°€ ì´í•­í˜•ì¸ ë°ì´í„°ì´ë‹¤.
- Example 8.1 ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ í”¼ê°€ ì‘ê³ ë˜ëŠ” ì‹œê°„ê³¼ ì•½ì˜ ì¢…ë¥˜ ê°„ì˜ ìƒê´€ì„±ì„ ì•Œì•„ë³´ë„ë¡ í•˜ê² ë‹¤.

$$
\begin{aligned}
H_0 &: \rho_pb=0 \ (There \ is \ no \ correlation \ between \ blood-clotting \ time \ and \ drug.)\\
H_A &: \rho_pb \neq 0 \ (There \ is \ correlation \ between \ blood-clotting \ time \ and \ drug.)
\end{aligned}
$$

``` r
library("ltm")
r.pb = round(biserial.cor(ex19_16$Y,ex19_16$X,level=2), 4)
r.pb_square = round(r.pb^2, 4)

ex19_16.result <- cor.test(ex19_16$Y,ex19_16$X)
ex19_16.result
```

    ## 
    ##  Pearson's product-moment correlation
    ## 
    ## data:  ex19_16$Y and ex19_16$X
    ## t = 2.4765, df = 11, p-value = 0.03076
    ## alternative hypothesis: true correlation is not equal to 0
    ## 95 percent confidence interval:
    ##  0.07058429 0.86434926
    ## sample estimates:
    ##       cor 
    ## 0.5983011

``` r
ex19_16.resultdf <- cbind(r.pb, r.pb_square,
                          "statistic"=round(ex19_16.result$statistic, 3),
                          "p.value"=round(ex19_16.result$p.value, 3)
                          )
rownames(ex19_16.resultdf) = c(" ")
ex19_16.resultdf %>% kbl(caption = "Ex 19.16") %>%  
    kable_classic(full_width = F, html_font = "Cambria")
```

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Ex 19.16
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
r.pb
</th>
<th style="text-align:right;">
r.pb_square
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
0.5983
</td>
<td style="text-align:right;">
0.358
</td>
<td style="text-align:right;">
2.476
</td>
<td style="text-align:right;">
0.031
</td>
</tr>
</tbody>
</table>

- ê³„ì‚°ëœ Point-Biserial ìƒê´€ê³„ìˆ˜ëŠ” 0.5983ì´ë‹¤. <br/>
- ê·¸ë¦¬ê³  ê²€ì •í†µê³„ëŸ‰ì€ 2.476ì´ë©°, p-valueëŠ” 0.031ìœ¼ë¡œ ìœ ì˜ìˆ˜ì¤€ 5%í•˜ì— ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•œë‹¤.<br/>
- ì¦‰, í˜ˆì•¡ ì‘ê³  ì‹œê°„ê³¼ ì•½ë¬¼ ì‚¬ì´ì—ëŠ” ìƒê´€ê´€ê³„ê°€ ì¡´ì¬í•œë‹¤ëŠ” ì¶©ë¶„í•œ ì¦ê±°ê°€ ìˆë‹¤.

### EXAMPLE 19.17

![](/study/img/ì˜í•™í†µê³„ë°©ë²•ë¡ /ch19/19-17.png)

``` r
#ë°ì´í„°ì…‹
ex19_17 %>%
  kbl(caption = "Dataset",escape=F) %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
Dataset
</caption>
<thead>
<tr>
<th style="text-align:right;">
Group
</th>
<th style="text-align:right;">
One
</th>
<th style="text-align:right;">
Other
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
70.4
</td>
<td style="text-align:right;">
71.3
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
68.2
</td>
<td style="text-align:right;">
67.4
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
77.3
</td>
<td style="text-align:right;">
75.2
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
61.2
</td>
<td style="text-align:right;">
66.7
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
72.3
</td>
<td style="text-align:right;">
74.2
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
74.1
</td>
<td style="text-align:right;">
72.9
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
71.1
</td>
<td style="text-align:right;">
69.5
</td>
</tr>
</tbody>
</table>

- í•´ë‹¹ ë°ì´í„°ëŠ” ìŒë‘¥ì´ë“¤ì˜ ì²´ì¤‘ì— ëŒ€í•´ ê¸°ë¡í•œ ë°ì´í„°ì´ë‹¤.<br/>
- ìŒë‘¥ì´ë“¤ì˜ ì²´ì¤‘ ì‚¬ì´ì— ê¸‰ë‚´ ìƒê´€ê³„ìˆ˜ì— ëŒ€í•´ ì•Œì•„ë³´ê³ ì í•œë‹¤.<br/>
- ê¸‰ë‚´ìƒê´€ê³„ìˆ˜ ê³¼ì •ì— ëŒ€í•œ ê°€ì •ìœ¼ë¡œ ì´ë³€ëŸ‰ ì •ê·œ ë¶„í¬ë¡œ ë¶€í„° ëœë¤í•˜ê²Œ ì¶”ì¶œë˜ì–´ì•¼ í•˜ë©°, ëª¨ì§‘ë‹¨ì˜ ë¶„ì‚°ì´ ë™ì¼í•´ì•¼ í•œë‹¤.

> ì •ê·œì„± ê²€ì •

``` r
shapiro.test(ex19_17$One)
```

    ## 
    ##  Shapiro-Wilk normality test
    ## 
    ## data:  ex19_17$One
    ## W = 0.94626, p-value = 0.6956

``` r
shapiro.test(ex19_17$Other)
```

    ## 
    ##  Shapiro-Wilk normality test
    ## 
    ## data:  ex19_17$Other
    ## W = 0.94088, p-value = 0.6466

- ì •ê·œì„± ê²€ì •ê²°ê³¼, p-valueê°€ ê° ê·¸ë£¹ì—ì„œ 0.6956, 0.6466ìœ¼ë¡œ, ë‘ ê·¸ë£¹ëª¨ë‘ ì •ê·œì„± ê°€ì •ì„ ë§Œì¡±í•˜ì˜€ë‹¤.

> ë“±ë¶„ì‚°ì„± ê²€ì •

``` r
bartlett.test(ex19_17[,2:3])
```

    ## 
    ##  Bartlett test of homogeneity of variances
    ## 
    ## data:  ex19_17[, 2:3]
    ## Bartlett's K-squared = 0.99636, df = 1, p-value = 0.3182

- ë¶„ì‚° ê²€ì •ê²°ê³¼ p-valueê°€ 0.3182ìœ¼ë¡œ ìœ ì˜ìˆ˜ì¤€ 0.05ë³´ë‹¤ ì»¸ë‹¤. ê·¸ëŸ¬ë¯€ë¡œ ë“±ë¶„ì‚° ê°€ì •ë„ ë§Œì¡±í•˜ì˜€ë‹¤.

``` r
library("irr")
ex19_17.result <- icc(ex19_17[,2:3], unit="single",r0=0)
ex19_17.resultdf<-cbind("r1"=round(ex19_17.result$value, 3),
                        "F.value"=round(ex19_17.result$Fvalue, 1),
                        "p.value"=round(ex19_17.result$p.value, 4))
ex19_17.resultdf %>% kbl(caption = "Ex 19.17") %>%  
    kable_classic(full_width = F, html_font = "Cambria")
```

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Ex 19.17
</caption>
<thead>
<tr>
<th style="text-align:right;">
r1
</th>
<th style="text-align:right;">
F.value
</th>
<th style="text-align:right;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.827
</td>
<td style="text-align:right;">
10.6
</td>
<td style="text-align:right;">
0.0033
</td>
</tr>
</tbody>
</table>

- ì¼ê³± ìŒë‘¥ì´ ê°„ ì²´ì¤‘ì˜ ê¸‰ë‚´ ìƒê´€ê´€ìˆ˜ëŠ” 0.827ì´ë©°, <br/>
- ê¸‰ë‚´ ìƒê´€ê´€ê³„ë¥¼ í™•ì¸í•˜ê¸° ìœ„í•œ ê²€ì • ê²°ê³¼ Fê°’=10.6, p-value= 0.00325ë¡œ ìœ ì˜ìˆ˜ì¤€ 5%í•˜ì— ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•œë‹¤. <br/>
- ì¦‰, ì¼ê³± ìŒë‘¥ì´ ê°„ ì²´ì¤‘ì— ëŒ€í•´ ê¸‰ë‚´ ìƒê´€ê´€ê³„ê°€ ìˆë‹¤ê³  í•  ìˆ˜ ìˆë‹¤.

### EXAMPLE 19.18

![](/study/img/ì˜í•™í†µê³„ë°©ë²•ë¡ /ch19/19-18-1.png)

``` r
#ë°ì´í„°ì…‹
ex19_18 %>%
  kbl(caption = "Dataset",escape=F) %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
Dataset
</caption>
<thead>
<tr>
<th style="text-align:right;">
Group
</th>
<th style="text-align:right;">
A
</th>
<th style="text-align:right;">
B
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.22
</td>
<td style="text-align:right;">
0.21
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.26
</td>
<td style="text-align:right;">
0.23
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
0.27
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0.33
</td>
<td style="text-align:right;">
0.27
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.36
</td>
<td style="text-align:right;">
0.31
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0.39
</td>
<td style="text-align:right;">
0.33
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0.41
</td>
<td style="text-align:right;">
0.37
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0.44
</td>
<td style="text-align:right;">
0.38
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
0.47
</td>
<td style="text-align:right;">
0.40
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
0.51
</td>
<td style="text-align:right;">
0.43
</td>
</tr>
<tr>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
0.55
</td>
<td style="text-align:right;">
0.47
</td>
</tr>
</tbody>
</table>

- í•´ë‹¹ ë°ì´í„°ëŠ” ë‘ ê°œì˜ ë‹¤ë¥¸ ì›ì í¡ìˆ˜ ë¶„ê´‘ ê´‘ë„ê³„ë¥¼ ì‚¬ìš©í•˜ì—¬ ë‡Œ ì¡°ì§ì˜ ë‚© ë†ë„ ë¶„ì„í•œ ë°ì´í„°ì´ë‹¤.<br/>
- ì´ ì˜ˆì œì˜ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ì¼ì¹˜ ìƒê´€ê³„ìˆ˜ë¥¼ êµ¬í•´ë³´ë„ë¡ í•œë‹¤. <br/>
- ì¼ì¹˜ ìƒê´€ê³„ìˆ˜ëŠ” ë°ì´í„´ì˜ ì¼ì¹˜ë„ í˜¹ì€ ì¬í˜„ì„±ì„ í‰ê°€í•˜ê¸° ìœ„í•œ ì§€í‘œì´ë‹¤.

``` r
n<-length(ex19_18$A)
mean.A <- round(mean(ex19_18$A),3)
mean.B <- round(mean(ex19_18$B),3)
sum.A <- sum(ex19_18$A)
sum.B <- sum(ex19_18$B)
sum.AB <- sum(ex19_18$A*ex19_18$B)
sum.A2 <- sum(ex19_18$A^2)
sum.B2 <- sum(ex19_18$B^2)

ssA <- round(sum((ex19_18$A-mean.A)^2),5)
ssB <- round(sum((ex19_18$B-mean.B)^2),5)
ssAB <- sum((ex19_18$A-mean.A)*(ex19_18$B-mean.B))
r.c <- (2*ssAB) / (ssA+ssB+n*(mean.A-mean.B)^2)
r2.c <- r.c^2
r0 = ssAB / sqrt(ssA*ssB)
r02 = r0^2
U = (sqrt(n)*((mean.A-mean.B)^2)) / sqrt(ssA*ssB)

cbind(r.c, r2.c, r0, U) %>% kbl(caption ="Ex 19.18") %>%  
  kable_classic(full_width = F, html_font = "Cambria")
```

<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Ex 19.18
</caption>
<thead>
<tr>
<th style="text-align:right;">
r.c
</th>
<th style="text-align:right;">
r2.c
</th>
<th style="text-align:right;">
r0
</th>
<th style="text-align:right;">
U
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.8373719
</td>
<td style="text-align:right;">
0.7011917
</td>
<td style="text-align:right;">
0.9937578
</td>
<td style="text-align:right;">
0.0991292
</td>
</tr>
</tbody>
</table>

``` r
CCC(ex19_18$A, ex19_18$B, ci="z-transform", conf.level = 0.95)
```

    ## $rho.c
    ##         est    lwr.ci    upr.ci
    ## 1 0.8337058 0.6470369 0.9260831
    ## 
    ## $s.shift
    ## [1] 0.809665
    ## 
    ## $l.shift
    ## [1] -0.5826083
    ## 
    ## $C.b
    ## [1] 0.8388642
    ## 
    ## $blalt
    ##     mean delta
    ## 1  0.215  0.01
    ## 2  0.245  0.03
    ## 3  0.285  0.03
    ## 4  0.300  0.06
    ## 5  0.335  0.05
    ## 6  0.360  0.06
    ## 7  0.390  0.04
    ## 8  0.410  0.06
    ## 9  0.435  0.07
    ## 10 0.470  0.08
    ## 11 0.510  0.08

- ì¼ì¹˜ ìƒê´€ê³„ìˆ˜ëŠ” ë°ì´í„°ì˜ ì¼ì¹˜ë„ ë˜ëŠ” ì¬í˜„ì„±ì„ í‰ê°€í•˜ê¸° ìœ„í•œ ê³„ìˆ˜ë¡œ -1ì—ì„œ 1ì‚¬ì´ì˜ ê°’ì„ ê°€ì§€ê³  ì ˆëŒ€ê°’ì´ Pearson ìƒê´€ê³„ìˆ˜ë³´ë‹¤ í´ ìˆ˜ ì—†ìœ¼ë©°, Pearson ìƒê´€ê³„ìˆ˜ê°€ 0ì¼ ê²½ìš° ì¼ì¹˜ ìƒê´€ê³„ìˆ˜ ë˜í•œ 0ì´ ë‚˜ì˜¨ë‹¤.<br/>
- ë³€ìˆ˜ Aì™€ Bì— ëŒ€í•œ ìƒê´€ê³„ìˆ˜ëŠ” 0.99ë¡œ 0ì´ ì•„ë‹˜ì„ í™•ì¸í•  ìˆ˜ ìˆê³ , ë‘˜ì˜ ì¼ì¹˜ ìƒê´€ê³„ìˆ˜ëŠ” 0.8337ì´ë‹¤.

</div>
</details>

<br/>

# SAS í”„ë¡œê·¸ë¨ ê²°ê³¼

<details>
<summary>
SAS ì ‘ê¸°/í¼ì¹˜ê¸° ë²„íŠ¼
</summary>
<div markdown="1">

## 19ì¥



</div>
</details>

<br/>

<br/>

<font color='#fb8072'>êµì¬: Biostatistical Analysis (5th Edition) by Jerrold H. Zar</font><br/>

<font color='#fb8072'> **ì´ ê¸€ì€ 22í•™ë…„ë„ 1í•™ê¸° ì˜í•™í†µê³„ë°©ë²•ë¡  ê³¼ì œ ìë£Œë“¤ì„ ì •ë¦¬í•œ ê¸€ ì…ë‹ˆë‹¤.** </font>