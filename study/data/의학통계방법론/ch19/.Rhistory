P_L<-pf(0.05,10,10, lower.tail = T);P_L
P_L+P_U
(1-abs(r))/(1+abs(r))
F_L
0.00006037+0.0001156
F_L<-1-(1-abs(r))/(1+abs(r));F_L
1-(1-abs(r))/(1+abs(r))
F_L<-(1-abs(r))/(1-(1+abs(r)));F_L
0.00014-0.000115
F_L<-(1-abs(r))/(1+abs(r));F_L
pf(0.05,10,10, lower.tail = T)
(1-abs(r))/(1+abs(r))
F_L<-(1-abs(r))/(1+abs(r));F_L
(1+abs(r))/(1-abs(r))
P_U
(1+abs(r))
(1-abs(r))
f<-(1+abs(r))/(1-abs(r))
f
pf(f,10,10,lower.tail = F)
z<-FisherZ(r)
library("DescTools")
z<-FisherZ(r)
zeta<-FisherZ(0.75)
cat("z=",round(z,3),"zeta=",round(zeta,3))
Z<-(z-zeta)/sqrt(1/(n-3));Z
pnorm(Z,lower.tail = F)*2
f<-3.72
L1=((1+f)*r+(1-f))/((1+f)+(1-f)*r)
L2= ((1+f)*r-(1-f))/((1+f)-(1-f)*r)
cat("Confidence Limits for a Correlation Coefficient:",round(c(L1,L2),3))
CI<-cor.test(ex19_1a$WingLeingth, ex19_1a$TailLength, alternative="two.sided", method="pearson")
CI$conf.int
ci_cor(ex19_1a$WingLeingth, ex19_1a$TailLength, method = "pearson",type="normal")
library("confintr")
install.packages("comfitr")
install.packages("confintr")
library("confintr")
ci_cor(ex19_1a$WingLeingth, ex19_1a$TailLength, method = "pearson",type="normal")
CI$conf.int
cat("Confidence Limits for a Correlation Coefficient:",round(c(L1,L2),3))
pw<-pwr.r.test(r, n=12, sig.level = 0.05, alternative="two.sided")
library("pwr")
pw<-pwr.r.test(r, n=12, sig.level = 0.05, alternative="two.sided")
cat("The power of the test is 1-β=",round(pw$power,2))
pw<-pwr.r.test(r, length(ex19_1a), sig.level = 0.05, alternative="two.sided")
pw<-pwr.r.test(r, n=length(ex19_1a), sig.level = 0.05, alternative="two.sided")
length(ex19_1a)
length(ex19_1a[1,])
length(ex19_1a[,])
length(ex19_1a[,1])
pw<-pwr.r.test(r, n=length(ex19_1a[,1]), sig.level = 0.05, alternative="two.sided")
cat("The power of the test is 1-β=",round(pw$power,2))
ex19_5a<-pwr.r.test(r=0.5, power=0.99, sig.level = 0.05, alternative = "two.sided")
cat("n=",round(ex19_5a$n,1))
plot(ex19_1a$WingLeingth,ex19_1a$TailLength,xlab = "Wing Length",ylab="Tail Length",main="Correlation",pch=19,col="#8dd3c7")
abline(lm(ex19_1a$TailLength ~ ex19_1a$WingLeingth), col = "#ffffb3", lwd = 4)
text(paste("Correlation:", round(r, 4)), x = 10.4, y = 8)
View(ex19_1a)
e_195_b1<-function(n, alpha){
v=n-2
f_aa=round(qf(alpha/2, v, v, lower.tail = FALSE), 2)
L1=round(((1+f_aa)*r+(1-f_aa))/((1+f_aa)+(1-f_aa)*r), 3)
L2=round(((1+f_aa)*r-(1-f_aa))/((1+f_aa)-(1-f_aa)*r), 3)
width_CI=L2-L1
outcome=data.frame(f_aa, L1, L2, width_CI) %>% kbl(caption = "Ex 19.5 (b)") %>%
kable_classic(full_width = F, html_font = "Cambria")
return(outcome)
}
e_195_b1(15, 0.05)
#a)
e_195_b1<-function(n, alpha){
v=n-2
f_aa=round(qf(alpha/2, v, v, lower.tail = FALSE), 2)
L1=round(((1+f_aa)*r+(1-f_aa))/((1+f_aa)+(1-f_aa)*r), 3)
L2=round(((1+f_aa)*r-(1-f_aa))/((1+f_aa)-(1-f_aa)*r), 3)
width_CI=L2-L1
outcome=data.frame(f_aa, L1, L2, width_CI) %>%
kbl(caption = "Dataset",escape=F) %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
return(outcome)
}
e_195_b1(15, 0.05)
e_195_b1<-function(n, alpha){
v=n-2
f_aa=round(qf(alpha/2, v, v, lower.tail = FALSE), 2)
L1=round(((1+f_aa)*r+(1-f_aa))/((1+f_aa)+(1-f_aa)*r), 3)
L2=round(((1+f_aa)*r-(1-f_aa))/((1+f_aa)-(1-f_aa)*r), 3)
width_CI=L2-L1
outcome=data.frame(f_aa, L1, L2, width_CI) %>% kbl(caption = "Ex 19.5 (b)") %>%
kable_classic(full_width = F, html_font = "Cambria")
return(outcome)
}
e_195_b1(15, 0.05)
e_195_b1(16, 0.05)
#b)
e_195_b2<-function(n, r, z){
sigma_zz=sqrt(1/(n-3))
z_crit=qnorm(0.025, lower.tail=FALSE)
L1_F=z-z_crit*sigma_zz
L2_F=z+z_crit*sigma_zz
outcome=data.frame(z_crit, L1_F, L2_F) %>% kbl(caption = "Ex 19.5 (b)") %>%
kable_classic(full_width = F, html_font = "Cambria")
return(outcome)
}
e_195_b2(15, 0.870, 1.3331)
e_195_b2(16, 0.870, 1.3331)
r1= 0.78 ; r2=0.84
z1=1.0454 ; z2=1.2212
n1=98 ; n2=95
Z=(z1-z2)/sqrt((1/(n1-3))+(1/(n2-3)))
p<-round(pnorm(Z)*2,2)
cat("Z=",round(Z,3),"p-value=",round(p,2),"\nTherefore, do not reject H0.")
diffcor.two(0.78, 0.84, 98, 95, alpha = 0.05, cor.names = NULL,alternative = "two.sided")
install.packages("diffcor")
library("diffcor")
diffcor.two(0.78, 0.84, 98, 95, alpha = 0.05, cor.names = NULL,alternative = "two.sided")
z1=1.0454 ; z2=1.2212
sigma_12=0.1463
z_a=qnorm(0.025, lower.tail = FALSE)
z_b=round(((abs(z1-z2))/sigma_12)-z_a, 2)
beta=1-pnorm(z_b)
power.method2 = pnorm(z_b)
data.frame(power.method2) %>% kbl(caption = "Ex 19.7:방법1") %>%
kable_classic(full_width = F, html_font = "Cambria")
library("cower")
install.packages("cower")
library("cower")
install.packages("챚ㄷㄱ")
remotes::install_github('m-Py/cower')
remotes::install_github('m-Py/cower')
install.packages("remotes")
library("remotes")
remotes::install_github('m-Py/cower')
install_github("m-Py/cower")
library(cower)
e_197=power.indep.cor(r1=0.78, r2=0.84, n1=98, n2=95, sig.level = 0.05, alternative = "two.sided")
power.method1 = e_197$power
data.frame(power.method1) %>% kbl(caption = "Ex 19.7:방법2") %>%
kable_classic(full_width = F, html_font = "Cambria")
z_alpha= round(qnorm(0.05/2, lower.tail = F), 4)
z_beta=round(qnorm(0.10,lower.tail = F), 4)
n_198=2*(((z_alpha+z_beta)/(0.5000))^2)+3
sample.size = ceiling(n_198)
cbind(z_alpha, z_beta, n_198, sample.size) %>% kbl(caption = "Ex 19.8") %>%
kable_classic(full_width = F, html_font = "Cambria")
n=c(24,29,32)
r=c(0.52, 0.56, 0.87)
test.three_sample_corr <- function(n,r) {
z = round(0.5*log((1+r)/(1-r)), 4)
z_square = round(z^2, 4)
n_minus_3 = n-3
n_3_z = n_minus_3*z
n_3_z_sqaure = n_minus_3*z_square
test.stat = round(sum(n_3_z_sqaure) - (sum(n_3_z)^2)/sum(n_minus_3), 3)
df = length(n)-1
p.value = round(1 - pchisq(test.stat, df), 4)
result.df = data.frame(test.stat, df, p.value)
result.df<-result.df %>% kbl(caption = "Ex 19.9") %>%
kable_classic(full_width = F, html_font = "Cambria")
return(result.df)
}
test.three_sample_corr(n,r)
common.corr <- function(n,r) {
z = round(0.5*log((1+r)/(1-r)), 4)
z_square = round(z^2, 4)
n_minus_3 = n-3
n_3_z = n_minus_3*z
n_3_z_sqaure = n_minus_3*z_square
z.w = sum(n_3_z)/sum(n_minus_3)
r.w = round((exp(2*z.w)-1) / (exp(2*z.w)+1), 4)
r.w <- data.frame(r.w)
r.w <- r.w %>% kbl(caption = "Ex 19.9") %>%
kable_classic(full_width = F, html_font = "Cambria")
return(r.w)
}
common.corr(n,r)
n=c(24,29,32)
r=c(0.52, 0.56, 0.87)
test.corr_correction <- function(n,r) {
z = round(0.5*log((1+r)/(1-r)), 4)
z_square = round(z^2, 4)
n_minus_3 = n-3
n_3_z = n_minus_3*z
n_3_z_sqaure = n_minus_3*z_square
z.w = sum(n_3_z)/sum(n_minus_3)
r.w = round((exp(2*z.w)-1) / (exp(2*z.w)+1), 2)
test.stat = round(sum(n*t((r- r.w)^2) / (1 - r*r.w)^2), 4)
df = length(n)-1
p.value = round(1 - pchisq(test.stat, df), 4)
result.df = data.frame(test.stat, p.value)
result.df<-result.df %>% kbl(caption = "Ex 19.10") %>%
kable_classic(full_width = F, html_font = "Cambria")
return(result.df)
}
test.corr_correction(n,r)
z = round(0.5*log((1+r)/(1-r)), 4)
comb<-combinations(3, 2, v = 1:3)
library("Combinat ")
library("gtools")
z = round(0.5*log((1+r)/(1-r)), 4)
comb<-combinations(3, 2, v = 1:3)
comb <- data.frame(comb)
comb<-comb[order(comb$X2, decreasing = T),]
ex19.11_result = vector()
for (k in 1:3) {
compar_vec = vector()
i=comb[k,2]
j=comb[k,1]
compar=paste0(i," vs. ",j)
compar_vec = c(compar_vec, "Comparison"=compar)
diff= z[i]-z[j]
compar_vec = c(compar_vec, "Difference"=diff)
SE = round(sqrt(1/2*(1/(n[i]-3) + 1/(n[j]-3))), 3)
compar_vec = c(compar_vec, "SE"=SE)
q = round((z[i]-z[j]) / round(sqrt(1/2*(1/(n[i]-3) + 1/(n[j]-3))), 3), 3)
compar_vec = c(compar_vec, "q"=q)
compar_vec = c(compar_vec, "critical.value"=3.314)
if (q > 3.314) {
compar_vec = c(compar_vec, "Conclusion"="Reject H0")
}
else {
compar_vec = c(compar_vec, "Conclusion"="Do not reject H0")
}
ex19.11_result<- rbind(ex19.11_result, compar_vec)
}
rownames(ex19.11_result) <- c(rep(" ", 3))
ex19.11_result %>% kbl(caption = "Ex 19.11") %>%
kable_classic(full_width = F, html_font = "Cambria")
- 각각의 q 통계량을 3.314와 비교하면 그룹 3과 그룹1,2는 상관계수가 같다는 귀무가설을 기각했지만, 그룹 1과 그룹2는 귀무가설을 기각하지 못했다. 따라서 그룹 1과 그룹 2의 상관계수는 같으나 그룹 3의 상관계수는 다르다고 할 수 있다.
ex19_12<- read.spss('Exam 19.12.sav', to.data.frame=T)
ex19_12 %>%
kbl(caption = "Dataset",escape=F) %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
ex19_12.result <-cor.test(ex19_12$X, ex19_12$Y, method="spearman")
ex19_12.result
ex19_12.result_table <- cbind("statistic"=ex19_12.result$statistic, "r"=round(ex19_12.result$estimate, 3),
"p.value"=round(ex19_12.result$p.value, 3))
rownames(ex19_12.result_table)=c(" ")
ex19_12.result_table %>% kbl(caption = "Ex 19.12") %>%
kable_classic(full_width = F, html_font = "Cambria")
cor.test(ex19_13$X,ex19_13$Y,method = "spearman", exact = F)
ex19_13<- read.spss('Exam 19.13.sav', to.data.frame=T)
ex19_3 %>%
kbl(caption = "Dataset",escape=F) %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
ex19_13 %>%
kbl(caption = "Dataset",escape=F) %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
cor.test(ex19_13$X,ex19_13$Y,method = "spearman", exact = F)
ex19_14<- read.spss('Exam 19.14.sav', to.data.frame=T)
j.inverse <- ex19_14$Species1^(-1)
savage.number1 = vector()
savage.number2 = vector()
for (k in 1:8) {
S1 = round(sum(j.inverse[ex19_14$Species1[k]:8]), 3)
savage.number1 = c(savage.number1, S1)
S2 = round(sum(j.inverse[ex19_14$Species2[k]:8]), 3)
savage.number2 = c(savage.number2, S2)
}
ex19_14.result <- cbind(ex19_14, savage.number1, savage.number2,
"(S1)(S2)"=round(savage.number1*savage.number2, 3))
ex19_14.result %>% kbl(caption = "Ex 19.14") %>%
kable_classic(full_width = F, html_font = "Cambria")
summation = sum(round(savage.number1*savage.number2, 3))
n = length(ex19_14$Factor)
r.T = round((summation-n) / (n-savage.number1[1]), 3)
cbind(n, r.T) %>% kbl(caption = "Ex 19.14") %>%
kable_classic(full_width = F, html_font = "Cambria")
savage.number1
cor.test(savage.number1,savage.number2)
ex19_15<- read.spss('Exam 19.15.sav', to.data.frame=T)
ex19_15 %>%
kbl(caption = "Dataset",escape=F) %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
cross.table<-table(ex19_15$Disease, ex19_15$Insect)
phi.coefficient <- phi(cross.table, digits = 2)
Yule.coefficient <- Yule(cross.table,Y=FALSE)
r.n = round(((cross.table[2,2] + cross.table[1,1]) - (cross.table[1,2] + cross.table[2,1])) /
((cross.table[2,2] + cross.table[1,1]) + (cross.table[1,2] + cross.table[2,1])), 2)
ex19_15.result <- cbind(phi.coefficient, Yule.coefficient, r.n)
ex19_15.result %>% kbl(caption = "Ex 19.15") %>%
kable_classic(full_width = F, html_font = "Cambria")
ex19_16<- read.spss('Exam 19.16.sav', to.data.frame=T)
ex19_16 %>%
kbl(caption = "Dataset",escape=F) %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
r.pb = round(biserial.cor(ex19_16$Y,ex19_16$X,level=2), 4)
libra
library("ltm")
install.packages("ltm")
library("ltm")
r.pb = round(biserial.cor(ex19_16$Y,ex19_16$X,level=2), 4)
r.pb_square = round(r.pb^2, 4)
ex19_16.result <- cor.test(ex19_16$Y,ex19_16$X)
ex19_16.result
ex19_16.resultdf <- cbind(r.pb, r.pb_square,
"statistic"=round(ex19_16.result$statistic, 3),
"p.value"=round(ex19_16.result$p.value, 3)
)
rownames(ex19_16.resultdf) = c(" ")
ex19_16.resultdf %>% kbl(caption = "Ex 19.16") %>%
kable_classic(full_width = F, html_font = "Cambria")
ex19_17<- read.spss('Exam 19.17.sav', to.data.frame=T)
ex19_17 %>%
kbl(caption = "Dataset",escape=F) %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
shapiro.test(ex19_17$One)
shapiro.test(ex19_17$Other)
bartlett.test(ex19_17[,2:3])
ex19_17.result <- icc(ex19_17[,2:3], unit="single",r0=0)
library("irr")
install.packages("irr")
ex19_17.result <- icc(ex19_17[,2:3], unit="single",r0=0)
library("irr")
ex19_17.result <- icc(ex19_17[,2:3], unit="single",r0=0)
ex19_17.resultdf<-cbind("r1"=round(ex19_17.result$value, 3),
"F.value"=round(ex19_17.result$Fvalue, 1),
"p.value"=round(ex19_17.result$p.value, 4))
ex19_17.resultdf %>% kbl(caption = "Ex 19.17") %>%
kable_classic(full_width = F, html_font = "Cambria")
ex19_18<- read.spss('Exam 19.18.sav', to.data.frame=T)
ex19_18 %>%
kbl(caption = "Dataset",escape=F) %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
n<-length(ex19_18$A)
mean.A <- mean(ex19_18$A)
mean.B <- mean(ex19_18$B)
sum.A <- sum(ex19_18$A)
sum.B <- sum(ex19_18$B)
sum.AB <- sum(ex19_18$A*ex19_18$B)
sum.A2 <- sum(ex19_18$A^2)
sum.B2 <- sum(ex19_18$B^2)
ssA <- sum((ex19_18$A-mean.A)^2)
ssB <- sum((ex19_18$B-mean.B)^2)
ssAB <- sum((ex19_18$A-mean.A)*(ex19_18$B-mean.B))
r.c <- (2*ssAB) / (ssA+ssB+n*(mean.A-mean.B)^2)
r2.c <- r.c^2
r0 = ssAB / sqrt(ssA*ssB)
r02 = r0^2
U = (sqrt(n)*((mean.A-mean.B)^2)) / sqrt(ssA*ssB)
z.c = round(0.5*log((1+r.c)/(1-r.c)), 4)
sigma_Z = sqrt( (
((1-r02)*r2.c)/((1-r2.c)*r02) +
(2*(r.c^3)*(1-r.c)*U)/(r0*((1-r2.c)^2)) -
((r.c^4)*(U^2))/(2*r02*((1-r2.c)^2))
) / (n-2) )
L1 = z.c - qnorm(1-0.05/2)*sigma_Z
L2 = z.c + qnorm(1-0.05/2)*sigma_Z
cbind(r.c, r2.c, r0, L1, L2) %>% kbl(caption ="Ex 19.18") %>%
kable_classic(full_width = F, html_font = "Cambria")
n<-length(ex19_18$A)
mean.A <- mean(ex19_18$A)
mean.B <- mean(ex19_18$B)
sum.A <- sum(ex19_18$A)
sum.B <- sum(ex19_18$B)
sum.AB <- sum(ex19_18$A*ex19_18$B)
sum.A2 <- sum(ex19_18$A^2)
sum.B2 <- sum(ex19_18$B^2)
ssA <- sum((ex19_18$A-mean.A)^2)
ssB <- sum((ex19_18$B-mean.B)^2)
ssAB <- sum((ex19_18$A-mean.A)*(ex19_18$B-mean.B))
r.c <- (2*ssAB) / (ssA+ssB+n*(mean.A-mean.B)^2)
r2.c <- r.c^2
r0 = ssAB / sqrt(ssA*ssB)
r02 = r0^2
U = (sqrt(n)*((mean.A-mean.B)^2)) / sqrt(ssA*ssB)
z.c = round(0.5*log((1+r.c)/(1-r.c)), 4)
sigma_Z = sqrt( (
((1-r02)*r2.c)/((1-r2.c)*r02) +
(2*(r.c^3)*(1-r.c)*U)/(r0*((1-r2.c)^2)) -
((r.c^4)*(U^2))/(2*r02*((1-r2.c)^2))
) / (n-2) )
L1 = z.c - qnorm(1-0.05/2)*sigma_Z
L2 = z.c + qnorm(1-0.05/2)*sigma_Z
cbind(r.c, r2.c, r0, L1, L2) %>% kbl(caption ="Ex 19.18") %>%
kable_classic(full_width = F, html_font = "Cambria")
ex19_18 %>%
kbl(caption = "Dataset",escape=F) %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
CCC(ex19_18$A, ex19_18$B, ci="z-transform", conf.level = 0.95)
n<-length(ex19_18$A)
mean.A <- mean(ex19_18$A)
mean.B <- mean(ex19_18$B)
sum.A <- sum(ex19_18$A)
sum.B <- sum(ex19_18$B)
sum.AB <- sum(ex19_18$A*ex19_18$B)
sum.A2 <- sum(ex19_18$A^2)
sum.B2 <- sum(ex19_18$B^2)
ssA <- sum((ex19_18$A-mean.A)^2)
ssB <- sum((ex19_18$B-mean.B)^2)
ssAB <- sum((ex19_18$A-mean.A)*(ex19_18$B-mean.B))
r.c <- (2*ssAB) / (ssA+ssB+n*(mean.A-mean.B)^2)
r2.c <- r.c^2
r0 = ssAB / sqrt(ssA*ssB)
r02 = r0^2
U = (sqrt(n)*((mean.A-mean.B)^2)) / sqrt(ssA*ssB)
z.c = round(0.5*log((1+r.c)/(1-r.c)), 4)
sigma_Z = sqrt( (
((1-r02)*r2.c)/((1-r2.c)*r02) +
(2*(r.c^3)*(1-r.c)*U)/(r0*((1-r2.c)^2)) -
((r.c^4)*(U^2))/(2*r02*((1-r2.c)^2))
) / (n-2) )
L1 = z.c - qnorm(1-0.05/2)*sigma_Z
L2 = z.c + qnorm(1-0.05/2)*sigma_Z
cbind(r.c, r2.c, r0, L1, L2) %>% kbl(caption ="Ex 19.18") %>%
kable_classic(full_width = F, html_font = "Cambria")
sum((ex19_18$A-mean.A)^2)
length(ex19_18$A)
mean.A
mean.B
ssAB
n<-length(ex19_18$A)
mean.A <- mean(ex19_18$A)
mean.B <- mean(ex19_18$B)
sum.A <- sum(ex19_18$A)
sum.B <- sum(ex19_18$B)
sum.AB <- sum(ex19_18$A*ex19_18$B)
sum.A2 <- sum(ex19_18$A^2)
sum.B2 <- sum(ex19_18$B^2)
ssA <- sum((ex19_18$A-mean.A)^2)
ssB <- sum((ex19_18$B-mean.B)^2)
ssAB <- sum((ex19_18$A-mean.A)*(ex19_18$B-mean.B))
r.c <- (2*ssAB) / (ssA+ssB+n*(mean.A-mean.B)^2)
r.c
(2*ssAB)
ssA
ssA <- round(sum((ex19_18$A-mean.A)^2),5)
ssA
ssB <- round(sum((ex19_18$B-mean.B)^2),5)
ssB
n<-length(ex19_18$A)
mean.A <- round(mean(ex19_18$A),5)
mean.B <- round(mean(ex19_18$B),5)
sum.A <- sum(ex19_18$A)
sum.B <- sum(ex19_18$B)
sum.AB <- sum(ex19_18$A*ex19_18$B)
sum.A2 <- sum(ex19_18$A^2)
sum.B2 <- sum(ex19_18$B^2)
ssA <- round(sum((ex19_18$A-mean.A)^2),5)
ssB <- round(sum((ex19_18$B-mean.B)^2),5)
ssAB <- sum((ex19_18$A-mean.A)*(ex19_18$B-mean.B))
r.c <- (2*ssAB) / (ssA+ssB+n*(mean.A-mean.B)^2)
r.c
ssAB
(2*ssAB)
(ssA+ssB+n*(mean.A-mean.B)^2)
mean.B
n<-length(ex19_18$A)
mean.A <- round(mean(ex19_18$A),3)
mean.B <- round(mean(ex19_18$B),3)
sum.A <- sum(ex19_18$A)
sum.B <- sum(ex19_18$B)
sum.AB <- sum(ex19_18$A*ex19_18$B)
sum.A2 <- sum(ex19_18$A^2)
sum.B2 <- sum(ex19_18$B^2)
ssA <- round(sum((ex19_18$A-mean.A)^2),5)
ssB <- round(sum((ex19_18$B-mean.B)^2),5)
ssAB <- sum((ex19_18$A-mean.A)*(ex19_18$B-mean.B))
r.c <- (2*ssAB) / (ssA+ssB+n*(mean.A-mean.B)^2)
r.c
(ssA+ssB+n*(mean.A-mean.B)^2)
mean.A
n
ssB
ssA
r.c
r2.c <- r.c^2
r2.c
r0 = ssAB / sqrt(ssA*ssB)
r0
r02 = r0^2
r02
U = (sqrt(n)*((mean.A-mean.B)^2)) / sqrt(ssA*ssB)
U
z.c = round(0.5*log((1+r.c)/(1-r.c)), 4)
sigma_Z = sqrt( (
((1-r02)*r2.c)/((1-r2.c)*r02) +
(2*(r.c^3)*(1-r.c)*U)/(r0*((1-r2.c)^2)) -
((r.c^4)*(U^2))/(2*r02*((1-r2.c)^2))
) / (n-2) )
L1 = z.c - qnorm(1-0.05/2)*sigma_Z
L2 = z.c + qnorm(1-0.05/2)*sigma_Z
cbind(r.c, r2.c, r0, L1, L2) %>% kbl(caption ="Ex 19.18") %>%
kable_classic(full_width = F, html_font = "Cambria")
z.c
qnorm(1-0.05/2)
sigma_Z
sigma_Z
((1-r02)*r2.c)/((1-r2.c)*r02)
(2*(r.c^3)*(1-r.c)*U)/(r0*((1-r2.c)^2))
((r.c^4)*(U^2))/(2*r02*((1-r2.c)^2))
(n-2)
(2*(r.c^3)*(1-r.c)*U)/(r0*((1-r2.c)^2))
0.2133617/9
r.c
U
r0
r02
r2.c
cbind(r.c, r2.c, r0, U) %>% kbl(caption ="Ex 19.18") %>%
kable_classic(full_width = F, html_font = "Cambria")
CCC(ex19_18$A, ex19_18$B, ci="z-transform", conf.level = 0.95)
cross.table<-table(ex19_15$Disease, ex19_15$Insect)
phi.coefficient <- phi(cross.table, digits = 2)
Yule.coefficient <- Yule(cross.table,Y=FALSE)
r.n = round(((cross.table[2,2] + cross.table[1,1]) - (cross.table[1,2] + cross.table[2,1])) /
((cross.table[2,2] + cross.table[1,1]) + (cross.table[1,2] + cross.table[2,1])), 2)
ex19_15.result <- cbind(phi.coefficient, Yule.coefficient, r.n)
ex19_15.result %>% kbl(caption = "Ex 19.15") %>%
kable_classic(full_width = F, html_font = "Cambria")
library("psych")
