if(!tibble) x <- lapply(x, as.data.frame)
names(x) <- sheets
x
}
#data_chap07에 연습문제 7장 모든 문제 저장
data_chap07 <- read_excel_allsheets("data_chap07.xls")
#연습문제 각각 데이터 생성
for (x in 1:length(data_chap07)){
assign(paste0('ex7_',c(1:4,13))[x],data_chap07[x])
}
#연습문제 데이터 형식을 리스트에서 데이터프레임으로 변환
for (x in 1:length(data_chap07)){
assign(paste0('ex7_',c(1:4,13))[x],data.frame(data_chap07[x]))
}
View(ex7_1)
ex7_1
ex7_1$Temperature[2:26]
f7_1 <- function(x,mu){
n <- length(x)
mu <- mu
xbar <- round(mean(x),2)
s2 <- round(var(x),2)
se <- round(sqrt(s2/n),2)
original_t <- ((mean(x)-mu)/sqrt(var(x)/n))
t <- round((xbar-mu)/se,3)
df <- n-1
alpha <- 0.05
value <- round(qt(1-(alpha/2),df),3)
if(t>0){pvalue=2*pt(t,df,lower.tail=F)}
else{pvalue=2*pt(t,df,lower.tail=T)}
out <- data.frame(n=n,alpha=alpha,mu=mu,mean=xbar,var=s2,std_err=se,t_statistic=t,original_t=round(original_t,4),df=df,value=value,p_value=round(pvalue,3))
return(out)
}
f7_1(x=dat7_1$Temperature,mu=24.3)
f7_1(x=ex7_1$Temperature,mu=24.3)
ex7_1$Temperature
ex7_1 <- ex7_1$Temperature[2:26]
f7_1 <- function(x,mu){
n <- length(x)
mu <- mu
xbar <- round(mean(x),2)
s2 <- round(var(x),2)
se <- round(sqrt(s2/n),2)
original_t <- ((mean(x)-mu)/sqrt(var(x)/n))
t <- round((xbar-mu)/se,3)
df <- n-1
alpha <- 0.05
value <- round(qt(1-(alpha/2),df),3)
if(t>0){pvalue=2*pt(t,df,lower.tail=F)}
else{pvalue=2*pt(t,df,lower.tail=T)}
out <- data.frame(n=n,alpha=alpha,mu=mu,mean=xbar,var=s2,std_err=se,t_statistic=t,original_t=round(original_t,4),df=df,value=value,p_value=round(pvalue,3))
return(out)
}
f7_1(x=ex7_1$Temperature,mu=24.3)
ex7_1
f7_1(x=ex7_1,mu=24.3)
mean(ex7_1)
((mean(ex7_1)-24.3)/sqrt(var(ex7_1)/length(ex7_1)))
t <- seq(-4, 4,0.01)
v1 <- 2
v2 <- 4
v3 <- 50
y1 <-(1/sqrt(pi*v1))*(factorial((v1+1)/2-1)/factorial(v1/2-1))*(1+t^2/v1)^(-(v1+1)/2)
y2 <-(1/sqrt(pi*v2))*(factorial((v2+1)/2-1)/factorial(v2/2-1))*(1+t^2/v2)^(-(v2+1)/2)
y3 <-(1/sqrt(pi*v3))*(factorial((v3+1)/2-1)/factorial(v3/2-1))*(1+t^2/v3)^(-(v3+1)/2)
plot(t, y1, type = 'l', col = 'red',xlab = "t",ylab = "Density", yaxt='n',ylim=c(0,0.4))
lines(t, y2, type = 'l', lty=2, col = 'blue')
lines(t, y3, type = 'l', lty=2, col = 'darkgreen')
legend("topright",legend=c("ν=1","ν=2","ν=50"),fil=c("red","blue","darkgreen"))
plot(x, dnorm(x), type='l', xlab="", ylab="Density", yaxt="n")
polygon(xp,yp, col="coral", density=50)
##normal-distribution
x=seq(-3,3,0.01)
arx=seq(-3,-2.064,0.01)
xp=c(arx, rev(arx))
plot(x, dnorm(x), type='l', xlab="", ylab="Density", yaxt="n")
f7_1(ex7_1,mu=24.3)$value
f7_1(x=ex7_1,mu=24.3)
t <- f7_1(ex7_1,mu=24.3)$value
curve(dt(x,24),-3,3,xlab="t",ylab="Density",yaxt='n',main="Hypothesis in Example 7.1 (df=24)")
#모든 시트를 하나의 리스트로 불러오는 함수
read_excel_allsheets <- function(file, tibble = FALSE) {
sheets <- readxl::excel_sheets(file)
x <- lapply(sheets, function(X) readxl::read_excel(file, sheet = X))
if(!tibble) x <- lapply(x, as.data.frame)
names(x) <- sheets
x
}
#data_chap07에 연습문제 7장 모든 문제 저장
data_chap07 <- read_excel_allsheets("data_chap07.xls")
#연습문제 각각 데이터 생성
for (x in 1:length(data_chap07)){
assign(paste0('ex7_',c(1:4,13))[x],data_chap07[x])
}
#연습문제 데이터 형식을 리스트에서 데이터프레임으로 변환
for (x in 1:length(data_chap07)){
assign(paste0('ex7_',c(1:4,13))[x],data.frame(data_chap07[x]))
}
ex7_1 <- ex7_1$Temperature[2:26]
f7_1 <- function(x,mu){
n <- length(x)
mu <- mu
xbar <- round(mean(x),2)
s2 <- round(var(x),2)
se <- round(sqrt(s2/n),2)
original_t <- ((mean(x)-mu)/sqrt(var(x)/n))
t <- round((xbar-mu)/se,3)
df <- n-1
alpha <- 0.05
value <- round(qt(1-(alpha/2),df),3)
if(t>0){pvalue=2*pt(t,df,lower.tail=F)}
else{pvalue=2*pt(t,df,lower.tail=T)}
out <- data.frame(n=n,alpha=alpha,mu=mu,mean=xbar,var=s2,std_err=se,t_statistic=t,original_t=round(original_t,4),df=df,value=value,p_value=round(pvalue,3))
return(out)
}
f7_1(x=ex7_1,mu=24.3)
t <- f7_1(ex7_1,mu=24.3)$value
curve(dt(x,24),-3,3,xlab="t",ylab="Density",yaxt='n',main="Hypothesis in Example 7.1 (df=24)")
dt(x,24)
x
#모든 시트를 하나의 리스트로 불러오는 함수
read_excel_allsheets <- function(file, tibble = FALSE) {
sheets <- readxl::excel_sheets(file)
x <- lapply(sheets, function(X) readxl::read_excel(file, sheet = X))
if(!tibble) x <- lapply(x, as.data.frame)
names(x) <- sheets
x
}
#data_chap07에 연습문제 7장 모든 문제 저장
data_chap07 <- read_excel_allsheets("data_chap07.xls")
#연습문제 각각 데이터 생성
for (x in 1:length(data_chap07)){
assign(paste0('ex7_',c(1:4,13))[x],data_chap07[x])
}
#연습문제 데이터 형식을 리스트에서 데이터프레임으로 변환
for (x in 1:length(data_chap07)){
assign(paste0('ex7_',c(1:4,13))[x],data.frame(data_chap07[x]))
}
x
ex7_1 <- ex7_1$Temperature[2:26]
f7_1 <- function(x,mu){
n <- length(x)
mu <- mu
xbar <- round(mean(x),2)
s2 <- round(var(x),2)
se <- round(sqrt(s2/n),2)
original_t <- ((mean(x)-mu)/sqrt(var(x)/n))
t <- round((xbar-mu)/se,3)
df <- n-1
alpha <- 0.05
value <- round(qt(1-(alpha/2),df),3)
if(t>0){pvalue=2*pt(t,df,lower.tail=F)}
else{pvalue=2*pt(t,df,lower.tail=T)}
out <- data.frame(n=n,alpha=alpha,mu=mu,mean=xbar,var=s2,std_err=se,t_statistic=t,original_t=round(original_t,4),df=df,value=value,p_value=round(pvalue,3))
return(out)
}
f7_1(x=ex7_1,mu=24.3)
t <- f7_1(ex7_1,mu=24.3)$value
curve(dt(x,24),-3,3,xlab="t",ylab="Density",yaxt='n',main="Hypothesis in Example 7.1 (df=24)")
polygon(c(t,seq(t,3,0.001),t),
c(dt(-3,24),dt(seq(t,3,0.001),24),dt(-3,24)),col="deeppink",density=30)
polygon(c(-3,seq(-3,-t,0.001),-t),
c(dt(-3,24),dt(seq(-3,-t,0.001),24),dt(-3,24)),col="deeppink",density = 30)
text(x=-2,y=0.1,labels = "-2.064")
text(x=2,y=0.1,labels = "2.064")
x
dt(x,24)
curve(dt(ex7_1,24),-3,3,xlab="t",ylab="Density",yaxt='n',main="Hypothesis in Example 7.1 (df=24)")
dt(ex7_1,24)
curve(dt(ex7_1,24),-3,3,xlab="t",ylab="Density",yaxt='n',main="Hypothesis in Example 7.1 (df=24)")
curve(dt(t,24),-3,3,xlab="t",ylab="Density",yaxt='n',main="Hypothesis in Example 7.1 (df=24)")
curve(dt(x,24),-3,3,xlab="t",ylab="Density",yaxt='n',main="Hypothesis in Example 7.1 (df=24)")
del(x)
drop(x)
remove(x)
curve(dt(x,24),-3,3,xlab="t",ylab="Density",yaxt='n',main="Hypothesis in Example 7.1 (df=24)")
polygon(c(t,seq(t,3,0.001),t),
c(dt(-3,24),dt(seq(t,3,0.001),24),dt(-3,24)),col="deeppink",density=30)
polygon(c(-3,seq(-3,-t,0.001),-t),
c(dt(-3,24),dt(seq(-3,-t,0.001),24),dt(-3,24)),col="deeppink",density = 30)
t <- f7_1(ex7_1,mu=24.3)$value
curve(dt(x,24),-3,3,xlab="t",ylab="Density",yaxt='n',main="Hypothesis in Example 7.1 (df=24)")
polygon(c(t,seq(t,3,0.001),t),
c(dt(-3,24),dt(seq(t,3,0.001),24),dt(-3,24)),col="#007266",density=30)
polygon(c(-3,seq(-3,-t,0.001),-t),
c(dt(-3,24),dt(seq(-3,-t,0.001),24),dt(-3,24)),col="#007266",density = 30)
text(x=-2,y=0.1,labels = "-2.064")
text(x=2,y=0.1,labels = "2.064")
t <- f7_1(ex7_1,mu=24.3)$value
curve(dt(x,24),-3,3,xlab="t",ylab="Density",yaxt='n',main="Hypothesis in Example 7.1 (df=24)")
polygon(c(t,seq(t,3,0.001),t),
c(dt(-3,24),dt(seq(t,3,0.001),24),dt(-3,24)),col="#007266",density=30)
polygon(c(-3,seq(-3,-t,0.001),-t),
c(dt(-3,24),dt(seq(-3,-t,0.001),24),dt(-3,24)),col="#007266",density = 30)
text(x=-2,y=0.1,labels = "-2.064")
text(x=2,y=0.1,labels = "2.064")
t <- f7_1(ex7_1,mu=24.3)$value
curve(dt(x,24),-3,3,xlab="t",ylab="Density",yaxt='n',main="Hypothesis in Example 7.1 (df=24)")
polygon(c(t,seq(t,3,0.001),t),
c(dt(-3,24),dt(seq(t,3,0.001),24),dt(-3,24)),col="#007266",density=30)
polygon(c(-3,seq(-3,-t,0.001),-t),
c(dt(-3,24),dt(seq(-3,-t,0.001),24),dt(-3,24)),col="#007266",density = 30)
text(x=-2.064,y=0.1,labels = "-2.064")
text(x=2.064,y=0.1,labels = "2.064")
ex7_2
t.test(ex7_2$weightchange,mu=0,alternative = "two.sided")
f7_1(ex7_2$weightchange,mu=0)
t <- f7_1(dat7_2$weightchange,mu=0)$value
t <- f7_1(ex7_2$weightchange,mu=0)$value
curve(dt(x,11),-3,3,xlab="t",ylab="Density",yaxt='n',main="Hypothesis in Example 7.2 (df=11)")
polygon(c(t,seq(t,3,0.001),t),
c(dt(-3,11),dt(seq(t,3,0.001),11),dt(-3,11)),col="#007266",density=30)
polygon(c(-3,seq(-3,-t,0.001),-t),
c(dt(-3,11),dt(seq(-3,-t,0.001),11),dt(-3,11)),col="#007266",density = 30)
text(x=-2.2,y=0.1,labels = "-2.201")
text(x=2.2,y=0.1,labels = "2.201")
t <- f7_1(ex7_2$weightchange,mu=0)$value
curve(dt(x,11),-3,3,xlab="t",ylab="Density",yaxt='n',main="Hypothesis in Example 7.2 (df=11)")
polygon(c(t,seq(t,3,0.001),t),
c(dt(-3,11),dt(seq(t,3,0.001),11),dt(-3,11)),col="#007266",density=30)
polygon(c(-3,seq(-3,-t,0.001),-t),
c(dt(-3,11),dt(seq(-3,-t,0.001),11),dt(-3,11)),col="#007266",density = 30)
text(x=-2.201,y=0.1,labels = "-2.201")
text(x=2.201,y=0.1,labels = "2.201")
ex7_3
t.test(ex7_3$weightchange,mu=0,alternative = "less")
t.test(ex7_3$weightchange,mu=0,alternative = "two.sided")
t.test(ex7_3$weightchange,mu=0,alternative = "two.sided")
t.test(ex7_3$weightchange,mu=0,alternative = "less")
t.test(ex7_3$weightchange,mu=24.3,alternative = "two.sided")
t.test(ex7_3$weightchange,mu=24.3,alternative = "")
t.test(ex7_3$weightchange,mu=24.3,alternative = "two.sided")
t.test(ex7_3$weightchange,mu=24.3,alternative = "less")
t.test(ex7_3$weightchange,mu=24.3,alternative = "less")
f7_3 <- function(x,mu){
n <- length(x)
mu <- mu
xbar <- round(mean(x),2)
s2 <- round(var(x),2)
se <- round(sqrt(s2/n),2)
original_t <- ((mean(x)-mu)/sqrt(var(x)/n))
t <- round((xbar-mu)/se,3)
df <- n-1
alpha <- 0.05
value <- round(qt(1-(alpha),df),3)
if(t>0){pvalue=pt(t,df,lower.tail=F)}
else{pvalue=pt(t,df,lower.tail=T)}
out <- data.frame(n=n,alpha=alpha,mu=mu,mean=xbar,var=s2,std_err=se,t_statistic=t,original_t=round(original_t,4),df=df,value=value,p_value=round(pvalue,3))
return(out)
}
f7_3(ex7_3$weightchange,mu=0)
t <- f7_3(ex7_3$weightchange,mu=0)$value
curve(dt(x,11),-3,3,xlab="t",ylab="Density",yaxt='n',main="Hypothesis in Example 7.3 (df=11)")
polygon(c(-3,seq(-3,-t,0.001),-t),
c(dt(-3,11),dt(seq(-3,-t,0.001),11),dt(-3,11)),col="blueviolet",density = 30)
text(x=-2,y=0.12,labels = "-1.796")
t <- f7_3(ex7_3$weightchange,mu=0)$value
curve(dt(x,11),-3,3,xlab="t",ylab="Density",yaxt='n',main="Hypothesis in Example 7.3 (df=11)")
polygon(c(-3,seq(-3,-t,0.001),-t),
c(dt(-3,11),dt(seq(-3,-t,0.001),11),dt(-3,11)),col="#007266",density = 30)
text(x=-1.796,y=0.12,labels = "-1.796")
ex7_4$gastricjuice
t <- f7_3(ex7_4$gastricjuice,mu=45)$value
curve(dt(x,7),-3,3,xlab="t",ylab="Density",yaxt='n',main="Hypothesis in Example 7.4 (df=7)")
polygon(c(t,seq(t,3,0.001),t),
c(dt(-3,7),dt(seq(t,3,0.001),7),dt(-3,7)),col="#007266",density=30)
text(x=2.201,y=0.12,labels = "2.201")
t <- f7_3(ex7_4$gastricjuice,mu=45)$value
curve(dt(x,7),-3,3,xlab="t",ylab="Density",yaxt='n',main="Hypothesis in Example 7.4 (df=7)")
polygon(c(t,seq(t,3,0.001),t),
c(dt(-3,7),dt(seq(t,3,0.001),7),dt(-3,7)),col="#007266",density=30)
text(x=1.895,y=0.12,labels = "1.895")
n <- length(ex7_6$Temperature)
M <- mean(ex7_6$Temperature)
n <- length(ex7_1$Temperature)
M <- mean(ex7_1$Temperature)
n <- length(ex7_1)
M <- mean(ex7_1)
V <- var(ex7_1)
SR <- sqrt((V/8)+(V/25))
a = 1-(0.05/2)
L <- M-(qt(a, df=n-1)*SR)
R <- M+(qt(a, df=n-1)*SR)
cat(" Mean = ",M,"℃","\n","Std.Err = ",SR,"℃","\n", "df = ",n-1,"\n","95% confidence interval = [",round(L,2),",",round(R,2),"]")
n <- length(ex7_1)
M <- mean(ex7_1)
V <- var(ex7_1)
SR <- sqrt((V/8)+(V/25))
a = 1-(0.05/2)
L <- M-(qt(a, df=n-1)*SR)
R <- M+(qt(a, df=n-1)*SR)
cat(" Mean = ",M,"℃","\n","Std.Err = ",SR,"℃","\n", "df = ",n-1,"\n","95% confidence interval = [",round(L,2),",",round(R,2),"]")
cat(" Mean = ",M,"℃","\n","Std.Err = ",SR,"℃","\n", "df = ",n-1,"\n","95% confidence interval = [",round(L,3),",",round(R,2),"]")
cat(" Mean = ",M,"℃","\n","Std.Err = ",SR,"℃","\n", "df = ",n-1,"\n","95% confidence interval = [",round(L,2),",",round(R,2),"]")
length(ex7_1)
mean(ex7_1)
var(ex7_1)
round(mean(ex7_1),3)
M <- round(mean(ex7_1),2)
V <- var(ex7_1)
SR <- sqrt((V/8)+(V/25))
a = 1-(0.05/2)
L <- M-(qt(a, df=n-1)*SR)
R <- M+(qt(a, df=n-1)*SR)
cat(" Mean = ",M,"℃","\n","Std.Err = ",SR,"℃","\n", "df = ",n-1,"\n","95% confidence interval = [",round(L,2),",",round(R,2),"]")
n <- length(ex7_1)
M <- mean(ex7_1)
V <- var(ex7_1)
SR <- sqrt((V/8)+(V/25))
a = 1-(0.05/2)
L <- M-(qt(a, df=n-1)*SR)
R <- M+(qt(a, df=n-1)*SR)
cat(" Mean = ",M,"℃","\n","Std.Err = ",SR,"℃","\n", "df = ",n-1,"\n","95% confidence interval = [",round(L,2),",",round(R,2),"]")
n <- length(ex7_1)
M <- mean(ex7_1)
V <- var(ex7_1)
SR <- sqrt((V/8)+(V/25))
a = 1-(0.05/2)
L <- M-(qt(a, df=n-1)*SR)
R <- M+(qt(a, df=n-1)*SR)
cat(" Mean = ",M,"℃","\n","Std.Err = ",SR,"℃","\n", "df = ",n-1,"\n","95% confidence interval = [",round(L,2),",",round(R,2),"]")
n <- length(ex7_1)
M <- mean(ex7_1)
V <- var(ex7_1)
SR <- sqrt((V/1)+(V/25))
a = 1-(0.05/2)
L <- M-(qt(a, df=n-1)*SR)
R <- M+(qt(a, df=n-1)*SR)
cat(" Mean = ",M,"℃","\n","Std.Err = ",SR,"℃","\n", "df = ",n-1,"\n","95% confidence interval = [",round(L,2),",",round(R,2),"]")
cat(" Mean = ",M,"℃","\n","Std.Err = ",SR,"℃","\n", "df = ",n-1,"\n","95% confidence interval = [",round(L,2),",",round(R,2),"]")
d=0.25
a = 1-(0.05/2)
n1 <- ceiling((var(ex7_3$weightchange)*(qt(0.975, df=40-1))^2)/d^2) # n=40
n2 <- ceiling((var(ex7_3$weightchange)*(qt(0.975, df=27-1))^2)/d^2) # n=27
cat(" nessesary sample size = 40, n = ",n1,"\n","nessesary sample size = 27, n = ",n2)
cat(" nessesary sample size = 40, n = ",n1)
cat("nessesary sample size = 27, n = ",n2)
ex7_2
d<-1.0
var<-round(var(ex7_2$weightchange),4)
t005<-round(qt(0.025, df=19, lower.tail=F),3)
t01<-round(qt(0.1, df=19, lower.tail=F),3)
n1 <- round((var/(d)^2)*(t005+t01)^2,1)
n1
d<-1.0
var<-round(var(ex7_2$weightchange),4)
t005<-round(qt(0.025, df=18, lower.tail=F),3)
t01<-round(qt(0.1, df=18, lower.tail=F),3)
n2 <- round((var/(d)^2)*(t005+t01)^2,1)
n2
cat(" sample size가 20 일때 필요한 최소 표본수 =",ceiling(n1),"\n","sample size가 19 일때 필요한 최소 표본수 =", ceiling(n2))
library(pwr)
install.packages("pwr")
library(pwr)
dd <- 1/sqrt(var(ex7_2$weightchange)) #effect size
pwr.t.test(n=,d=dd, sig.level=0.05, power=0.90, type="one.sample")
p<-pwr.t.test(n=25, sig.level = 0.05, power=0.90, type="one.sample", alternative="two.sided")
(p$d)*sd(ex7_2$weightchange)
n <- 15
var <- round(var(ex7_2$weightchange),4)
t005 <- round(qt(0.025, df=14, lower.tail=F),3)
beta<-round(1.0/(sqrt(var/n))-t005,3)
beta
length(ex7_2)
ex7_2
n <- 15
var <- round(var(ex7_2$weightchange),4)
t005 <- round(qt(0.025, df=14, lower.tail=F),3)
beta<-round(1.0/(sqrt(var/n))-t005,3)
beta
pwr.t.test(n=15, d=1, sig.level = 0.05, power=, type="one.sample")
d <- 1/sqrt(var(ex7_2$weightchange)) #exact effect size
pwr.t.test(n=15,d=d, sig.level=0.05, power=, type="one.sample", alternative="two.sided")
one_tailed_chi2_test <- function(x,sig,up_or_down){
n <- length(x)
sig <- sig
df <- n-1
ss <- round(var(x)*df,4)
s2 <- round(var(x),4)
chis <- round(ss/sig,3)
df <- n-1
alpha <- 0.05
if (up_or_down == "up"){chi2 = round(qchisq((1-alpha),df),3) }
else { chi2 = round(qchisq((alpha),df),3)}
if(chis < chi2){decision="Not reject H0"}
else{decision="Reject H0"}
out <- data.frame(SS=ss,df,s2,chis,chi2,decision)
return(out)
}
ex7_4
one_tailed_chi2_test(ex7_4$gastricjuice,1.5,up_or_down = "up")%>%
kbl(caption = "Result of Hypothesis") %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
one_tailed_chi2_test <- function(x,sig,up_or_down){
n <- length(x)
sig <- sig
df <- n-1
ss <- round(var(x)*df,4)
s2 <- round(var(x),4)
chis <- round(ss/sig,3)
df <- n-1
alpha <- 0.05
if (up_or_down == "up"){chi2 = round(qchisq((1-alpha),df),3) }
else { chi2 = round(qchisq((alpha),df),3)}
if(chis < chi2){decision="Not reject H0"}
else{decision="Reject H0"}
out <- data.frame(SS=ss,df,s2,chis,chi2,decision)
return(out)
}
one_tailed_chi2_test(ex7_4$gastricjuice,1.5,up_or_down = "up")%>%
kbl(caption = "Result of Hypothesis") %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
library(dplyr)
one_tailed_chi2_test(ex7_4$gastricjuice,1.5,up_or_down = "up")%>%
kbl(caption = "Result of Hypothesis") %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
library(kableExtra)
one_tailed_chi2_test(ex7_4$gastricjuice,1.5,up_or_down = "up")%>%
kbl(caption = "Result of Hypothesis") %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
library(PairedData)
install.packages("PaireData")
library(PairedData)
Var.test(dat7_11$gastricjuice,ratio=1.5,alternative = "greater")
library(PairedData)
install.packages("PairedData")
library(PairedData)
Var.test(dat7_11$gastricjuice,ratio=1.5,alternative = "greater")
Var.test(ex7_4$gastricjuice,ratio=1.5,alternative = "greater")
c <- one_tailed_chi2_test(ex7_4$gastricjuice,1.5,up_or_down = "up")$chi2
cc <- one_tailed_chi2_test(ex7_4$gastricjuice,1.5,up_or_down = "up")$chis
curve(dchisq(x,7),0,25,xlab=expression(chi^2),ylab="",yaxt='n',main="Hypothesis in Example 7.11 (df=7)")
polygon(c(cc,seq(cc,25,0.001),cc), #기각역
c(dchisq(0,7),dchisq(seq(cc,25,0.001),7),dchisq(0,25)),col="gray",density=30)
polygon(c(c,seq(c,25,0.001),c),
c(dchisq(0,7),dchisq(seq(c,25,0.001),7),dchisq(0,25)),col="deeppink",density=30)
# polygon(c(-3,seq(-3,-t,0.001),-t),
#         c(dt(-3,24),dt(seq(-3,-t,0.001),24),dt(-3,24)),col="deeppink",density = 30)
text(x=14.067,y=0.025,labels = "14.067")
text(x=12.552,y=0.036,labels = "12.552")
text(x=20, y=0.1, expression(chi^2 == paste(frac(SS, sigma[0]^2), " ",)), cex = 1.5)
c <- one_tailed_chi2_test(ex7_4$gastricjuice,1.5,up_or_down = "up")$chi2
cc <- one_tailed_chi2_test(ex7_4$gastricjuice,1.5,up_or_down = "up")$chis
curve(dchisq(x,7),0,25,xlab=expression(chi^2),ylab="",yaxt='n',main="Hypothesis in Example 7.11 (df=7)")
polygon(c(cc,seq(cc,25,0.001),cc), #기각역
c(dchisq(0,7),dchisq(seq(cc,25,0.001),7),dchisq(0,25)),col="#007266",density=30)
polygon(c(c,seq(c,25,0.001),c),
c(dchisq(0,7),dchisq(seq(c,25,0.001),7),dchisq(0,25)),col="#8dd3c7",density=30)
# polygon(c(-3,seq(-3,-t,0.001),-t),
#         c(dt(-3,24),dt(seq(-3,-t,0.001),24),dt(-3,24)),col="deeppink",density = 30)
text(x=14.067,y=0.025,labels = "14.067")
text(x=12.552,y=0.036,labels = "12.552")
text(x=20, y=0.1, expression(chi^2 == paste(frac(SS, sigma[0]^2), " ",)), cex = 1.5)
c <- one_tailed_chi2_test(ex7_4$gastricjuice,1.5,up_or_down = "up")$chi2
cc <- one_tailed_chi2_test(ex7_4$gastricjuice,1.5,up_or_down = "up")$chis
curve(dchisq(x,7),0,25,xlab=expression(chi^2),ylab="",yaxt='n',main="Hypothesis in Example 7.11 (df=7)")
polygon(c(cc,seq(cc,25,0.001),cc), #기각역
c(dchisq(0,7),dchisq(seq(cc,25,0.001),7),dchisq(0,25)),col="#007266",density=30)
polygon(c(c,seq(c,25,0.001),c),
c(dchisq(0,7),dchisq(seq(c,25,0.001),7),dchisq(0,25)),col="#ffffb3",density=30)
# polygon(c(-3,seq(-3,-t,0.001),-t),
#         c(dt(-3,24),dt(seq(-3,-t,0.001),24),dt(-3,24)),col="deeppink",density = 30)
text(x=14.067,y=0.025,labels = "14.067")
text(x=12.552,y=0.036,labels = "12.552")
text(x=20, y=0.1, expression(chi^2 == paste(frac(SS, sigma[0]^2), " ",)), cex = 1.5)
var.sample<- function(alpha, beta){
for(i in 2:100){
df=i-1
L=round(qchisq((beta),(df)),3)
U=round(qchisq((1-alpha),(df)),3)
ratio= round(L/U,3)
if(ratio > 0.558){
out1 <- data.frame(Low_CI = L, Upper_CI=U, ratio,Required_Sample_Size=df)
break
}else if(ratio < 0.558){
out2 <- data.frame(Low_CI = L, Upper_CI=U, ratio,Required_Sample_Size=df)
}
else{}
}
return(rbind(out1,out2))
}
var.sample(0.05,0.10)%>%
kbl(caption = "Result of Hypothesis") %>%
kable_styling(bootstrap_options = "striped", full_width = F)
alpha<-0.05
beta<-0.1
n1<-30
chi_1<-round(qchisq((beta),(n1-1)),3)
chi_2<-round(qchisq((1-alpha),(n1-1)),3)
cat("If n=30, ratio =",ratio<-round(chi_1/chi_2,3))
wilcox.test(data,mu=70.5, paired=FALSE, alt="two.sided")
ex6_7 <- read_excel("C:/Biostat/data_chap06.xls",sheet="exam6_7")
ex6_7 <- read_excel("C:/git_blog/study/img/ch7/data_chap06.xls",sheet="exam6_7")
library(xlsx)
ex6_7 <- read_excel("C:/git_blog/study/img/ch7/data_chap06.xls",sheet="exam6_7")
library('readxl')
ex6_7 <- read_excel("C:/git_blog/study/img/ch7/data_chap06.xls",sheet="exam6_7")
#중위수 확인
data = ex7_13[rep(1:nrow(ex7_13), times=ex7_13$exam7_13.Freq),0:1]
data2=as.numeric(data)
median(data) #중위수
wilcox.test(data,mu=70.5, paired=FALSE, alt="two.sided")
shapiro.test(ex6_7)
ex6_7
height = seq(63,76,1)
freq = c(2,2,3,5,4,6,5,8,7,7,10,6,3,2)
ex7_13 = rep(height, freq)
shapiro.test(ex7_13)
ex7_13
data = ex7_13[rep(1:nrow(ex7_13), times=ex7_13$exam7_13.Freq),0:1]
data = ex7_13[rep(1:nrow(ex7_13), times=ex7_13$exam7_13.Freq),0:1]
wilcox.test(ex7_13, mu=70.5, paired=F, alternative="two.sided", conf.level=0.95, correct=T)
